;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="e5ea1398-f7fb-3bdc-0663-8d4eaf0f8d8f")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,649347,(e,t,r)=>{!function(i,n){"use strict";var o={encode:function(e){var t,r=new ArrayBuffer(256),i=new DataView(r),n=0;function o(e){for(var o=r.byteLength,s=n+e;o<s;)o*=2;if(o!==r.byteLength){var a=i;i=new DataView(r=new ArrayBuffer(o));for(var l=n+3>>2,c=0;c<l;++c)i.setUint32(4*c,a.getUint32(4*c))}return t=e,i}function s(e){o(1).setUint8(n,e),n+=t}function a(e){for(var r=o(e.length),i=0;i<e.length;++i)r.setUint8(n+i,e[i]);n+=t}function l(e,r){var i,a;r<24?s(e<<5|r):r<256?(s(e<<5|24),s(r)):(r<65536?(s(e<<5|25),o(2).setUint16(n,r)):r<0x100000000?(s(e<<5|26),o(4).setUint32(n,r)):(s(e<<5|27),i=r%0x100000000,(a=o(8)).setUint32(n,(r-i)/0x100000000),a.setUint32(n+4,i)),n+=t)}if(!function e(r){if(!1===r)return s(244);if(!0===r)return s(245);if(null===r)return s(246);if(void 0===r)return s(247);switch(typeof r){case"number":if(Math.floor(r)===r){if(0<=r&&r<=0x20000000000000)return l(0,r);if(-0x20000000000000<=r&&r<0)return l(1,-(r+1))}return s(251),void(o(8).setFloat64(n,r),n+=t);case"string":var i,c,u=[];for(i=0;i<r.length;++i){var f=r.charCodeAt(i);f<128?u.push(f):(f<2048?u.push(192|f>>6):(f<55296?u.push(224|f>>12):(f=((1023&f)<<10|1023&r.charCodeAt(++i))+65536,u.push(240|f>>18),u.push(128|f>>12&63)),u.push(128|f>>6&63)),u.push(128|63&f))}return l(3,u.length),a(u);default:if(Array.isArray(r))for(l(4,c=r.length),i=0;i<c;++i)e(r[i]);else if(r instanceof Uint8Array)l(2,r.length),a(r);else{var h=Object.keys(r);for(l(5,c=h.length),i=0;i<c;++i){var p=h[i];e(p),e(r[p])}}}}(e),"slice"in r)return r.slice(0,n);for(var c=new ArrayBuffer(n),u=new DataView(c),f=0;f<n;++f)u.setUint8(f,i.getUint8(f));return c},decode:function(e,t,r){var i=new DataView(e),n=0;function o(t){var r;return r=new Uint8Array(e,n,t),n+=t,r}function s(){var e;return e=i.getUint8(n),n+=1,e}function a(){var e;return e=i.getUint16(n),n+=2,e}function l(){var e;return e=i.getUint32(n),n+=4,e}function c(){return 255===i.getUint8(n)&&(n+=1,!0)}function u(e){if(e<24)return e;if(24===e)return s();if(25===e)return a();if(26===e)return l();if(27===e)return 0x100000000*l()+l();if(31===e)return -1;throw"Invalid length encoding"}function f(e){var t=s();if(255===t)return -1;var r=u(31&t);if(r<0||t>>5!==e)throw"Invalid indefinite length element";return r}function h(e,t){for(var r=0;r<t;++r){var i=s();128&i&&(i<224?(i=(31&i)<<6|63&s(),t-=1):i<240?(i=(15&i)<<12|(63&s())<<6|63&s(),t-=2):(i=(15&i)<<18|(63&s())<<12|(63&s())<<6|63&s(),t-=3)),i<65536?e.push(i):(i-=65536,e.push(55296|i>>10),e.push(56320|1023&i))}}"function"!=typeof t&&(t=function(e){return e}),"function"!=typeof r&&(r=function(){});var p=function e(){var l,p,d,y,g,v=s(),m=v>>5,b=31&v;if(7===m)switch(b){case 25:var w=new DataView(new ArrayBuffer(4)),A=a(),S=31744&A,x=1023&A;if(31744===S)S=261120;else if(0!==S)S+=114688;else if(0!==x)return 5960464477539063e-23*x;return w.setUint32(0,(32768&A)<<16|S<<13|x<<13),w.getFloat32(0);case 26:return l=i.getFloat32(n),n+=4,l;case 27:return p=i.getFloat64(n),n+=8,p}if((y=u(b))<0&&(m<2||6<m))throw"Invalid length";switch(m){case 0:return y;case 1:return -1-y;case 2:if(y<0){for(var B=[],E=0;(y=f(m))>=0;)E+=y,B.push(o(y));var k=new Uint8Array(E),C=0;for(d=0;d<B.length;++d)k.set(B[d],C),C+=B[d].length;return k}return o(y);case 3:var O=[];if(y<0)for(;(y=f(m))>=0;)h(O,y);else h(O,y);return String.fromCharCode.apply(null,O);case 4:if(y<0)for(g=[];!c();)g.push(e());else for(d=0,g=Array(y);d<y;++d)g[d]=e();return g;case 5:var I={};for(d=0;d<y||y<0&&!c();++d)I[e()]=e();return I;case 6:return t(e(),y);case 7:switch(y){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:return r(y)}}}();if(n!==e.byteLength)throw"Remaining bytes";return p}};"function"==typeof define&&define.amd?((i,n="function"!=typeof i?i:i(e.r,r,t))=>void 0!==n&&e.v(n))(o):t.exports?t.exports=o:i.CBOR||(i.CBOR=o)}(e.e)},964495,(e,t,r)=>{var i,n;n=i||(i={}),function(t){var r="object"==typeof globalThis?globalThis:e.g,i=o(n);function o(e,t){return function(r,i){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0!==r.Reflect&&(i=o(r.Reflect,i)),t(i,r),void 0===r.Reflect&&(r.Reflect=n)}(function(e,t){var r,i=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,o=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,l=({__proto__:[]})instanceof Array,c=!a&&!l,u={create:a?function(){return L(Object.create(null))}:l?function(){return L({__proto__:null})}:function(){return L({})},has:c?function(e,t){return i.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return i.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},f=Object.getPrototypeOf(Function),h="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();function i(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(i.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),i.prototype.has=function(e){return this._find(e,!1)>=0},i.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},i.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},i.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,N(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},i.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},i.prototype.keys=function(){return new r(this._keys,this._values,n)},i.prototype.values=function(){return new r(this._keys,this._values,o)},i.prototype.entries=function(){return new r(this._keys,this._values,a)},i.prototype["@@iterator"]=function(){return this.entries()},i.prototype[s]=function(){return this.entries()},i.prototype._find=function(e,t){if(!N(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(N(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},i;function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}(),p="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}(),d="function"==typeof WeakMap?WeakMap:function(){var e=u.create(),t=n();function r(){this._key=n()}return r.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&u.has(t,this._key)},r.prototype.get=function(e){var t=o(e,!1);return void 0!==t?u.get(t,this._key):void 0},r.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},r.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},r.prototype.clear=function(){this._key=n()},r;function n(){var t;do t="@@WeakMap@@"+function(){var e=function(e){if("function"==typeof Uint8Array){var t=new Uint8Array(16);return"undefined"!=typeof crypto?crypto.getRandomValues(t):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(t):s(t,16),t}return s(Array(16),16)}(0);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var t="",r=0;r<16;++r){var i=e[r];(4===r||6===r||8===r)&&(t+="-"),i<16&&(t+="0"),t+=i.toString(16).toLowerCase()}return t}();while(u.has(e,t))return e[t]=!0,t}function o(e,r){if(!i.call(e,t)){if(!r)return;Object.defineProperty(e,t,{value:u.create()})}return e[t]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}}(),y=n?Symbol.for("@reflect-metadata:registry"):void 0,g=(!x(y)&&E(t.Reflect)&&Object.isExtensible(t.Reflect)&&(r=t.Reflect[y]),x(r)&&(r=function(){x(y)||void 0===t.Reflect||y in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(r=(e=t.Reflect).defineMetadata,i=e.hasOwnMetadata,n=e.getOwnMetadata,o=e.getOwnMetadataKeys,s=e.deleteMetadata,a=new d,l={isProviderFor:function(e,t){var r=a.get(e);return!!(!x(r)&&r.has(t))||!!o(e,t).length&&(x(r)&&(r=new p,a.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:o,OrdinaryDeleteMetadata:s});var e,r,i,n,o,s,a,l,c,u,f,g=new d,v={registerProvider:function(e){if(!Object.isExtensible(v))throw Error("Cannot add provider to a frozen registry.");switch(!0){case l===e:break;case x(c):c=e;break;case c===e:break;case x(u):u=e;break;case u===e:break;default:void 0===f&&(f=new p),f.add(e)}},getProvider:m,setProvider:function(e,t,r){if(!function(e){if(x(e))throw TypeError();return c===e||u===e||!x(f)&&f.has(e)}(r))throw Error("Metadata provider not registered.");var i=m(e,t);if(i!==r){if(!x(i))return!1;var n=g.get(e);x(n)&&(n=new h,g.set(e,n)),n.set(t,r)}return!0}};return v;function m(e,t){var r,i=g.get(e);return x(i)||(r=i.get(t)),x(r)&&(r=function(e,t){if(!x(c)){if(c.isProviderFor(e,t))return c;if(!x(u)){if(u.isProviderFor(e,t))return c;if(!x(f))for(var r=U(f);;){var i=j(r);if(!i)return;var n=i.value;if(n.isProviderFor(e,t))return R(r),n}}}if(!x(l)&&l.isProviderFor(e,t))return l}(e,t),x(r)||(x(i)&&(i=new h,g.set(e,i)),i.set(t,r))),r}}()),!x(y)&&E(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:r}),r),v=function(e){var t=new d,r={isProviderFor:function(e,r){var i=t.get(e);return!x(i)&&i.has(r)},OrdinaryDefineOwnMetadata:function(e,t,r,n){i(r,n,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,r){var n=i(t,r,!1);return!x(n)&&!!n.has(e)},OrdinaryGetOwnMetadata:function(e,t,r){var n=i(t,r,!1);if(!x(n))return n.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var r=[],n=i(e,t,!1);if(x(n))return r;for(var o=U(n.keys()),s=0;;){var a=j(o);if(!a)return r.length=s,r;var l=a.value;try{r[s]=l}catch(e){try{R(o)}finally{throw e}}s++}},OrdinaryDeleteMetadata:function(e,r,n){var o=i(r,n,!1);if(x(o)||!o.delete(e))return!1;if(0===o.size){var s=t.get(r);x(s)||(s.delete(n),0===s.size&&t.delete(s))}return!0}};return g.registerProvider(r),r;function i(i,n,o){var s=t.get(i),a=!1;if(x(s)){if(!o)return;s=new h,t.set(i,s),a=!0}var l=s.get(n);if(x(l)){if(!o)return;if(l=new h,s.set(n,l),!e.setProvider(i,n,r))throw s.delete(n),a&&t.delete(i),Error("Wrong provider for target.")}return l}}(g);function m(e,t,r){var i=D(t,r,!1);return!x(i)&&!!i.OrdinaryHasOwnMetadata(e,t,r)}function b(e,t,r){var i=D(t,r,!1);if(!x(i))return i.OrdinaryGetOwnMetadata(e,t,r)}function w(e,t,r,i){D(r,i,!0).OrdinaryDefineOwnMetadata(e,t,r,i)}function A(e,t){var r=D(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function S(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function x(e){return void 0===e}function B(e){return null===e}function E(e){return"object"==typeof e?null!==e:"function"==typeof e}e("decorate",function(e,t,r,i){if(x(r)){if(!C(e)||!I(t))throw TypeError();for(var n=e,o=t,s=n.length-1;s>=0;--s){var a=(0,n[s])(o);if(!x(a)&&!B(a)){if(!I(a))throw TypeError();o=a}}return o}if(!C(e)||!E(t)||!E(i)&&!x(i)&&!B(i))throw TypeError();return B(i)&&(i=void 0),function(e,t,r,i){for(var n=e.length-1;n>=0;--n){var o=(0,e[n])(t,r,i);if(!x(o)&&!B(o)){if(!E(o))throw TypeError();i=o}}return i}(e,t,r=k(r),i)}),e("metadata",function(e,t){return function(r,i){if(!E(r)||!x(i)&&!function(e){switch(S(e)){case 3:case 4:return!0;default:return!1}}(i))throw TypeError();w(e,t,r,i)}}),e("defineMetadata",function(e,t,r,i){if(!E(r))throw TypeError();return x(i)||(i=k(i)),w(e,t,r,i)}),e("hasMetadata",function(e,t,r){if(!E(t))throw TypeError();return x(r)||(r=k(r)),function e(t,r,i){if(m(t,r,i))return!0;var n=P(r);return!B(n)&&e(t,n,i)}(e,t,r)}),e("hasOwnMetadata",function(e,t,r){if(!E(t))throw TypeError();return x(r)||(r=k(r)),m(e,t,r)}),e("getMetadata",function(e,t,r){if(!E(t))throw TypeError();return x(r)||(r=k(r)),function e(t,r,i){if(m(t,r,i))return b(t,r,i);var n=P(r);if(!B(n))return e(t,n,i)}(e,t,r)}),e("getOwnMetadata",function(e,t,r){if(!E(t))throw TypeError();return x(r)||(r=k(r)),b(e,t,r)}),e("getMetadataKeys",function(e,t){if(!E(e))throw TypeError();return x(t)||(t=k(t)),function e(t,r){var i=A(t,r),n=P(t);if(null===n)return i;var o=e(n,r);if(o.length<=0)return i;if(i.length<=0)return o;for(var s=new p,a=[],l=0;l<i.length;l++){var c=i[l],u=s.has(c);u||(s.add(c),a.push(c))}for(var f=0;f<o.length;f++){var c=o[f],u=s.has(c);u||(s.add(c),a.push(c))}return a}(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!E(e))throw TypeError();return x(t)||(t=k(t)),A(e,t)}),e("deleteMetadata",function(e,t,r){if(!E(t)||(x(r)||(r=k(r)),!E(t)))throw TypeError();x(r)||(r=k(r));var i=D(t,r,!1);return!x(i)&&i.OrdinaryDeleteMetadata(e,t,r)});function k(e){var t=function(e,t){switch(S(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r="string",i=T(e,o);if(void 0!==i){var n=i.call(e,r);if(E(n))throw TypeError();return n}return function(e,t){if("string"===t){var r=e.toString;if(O(r)){var i=r.call(e);if(!E(i))return i}var n=e.valueOf;if(O(n)){var i=n.call(e);if(!E(i))return i}}else{var n=e.valueOf;if(O(n)){var i=n.call(e);if(!E(i))return i}var o=e.toString;if(O(o)){var i=o.call(e);if(!E(i))return i}}throw TypeError()}(e,r)}(e,0);return"symbol"==typeof t?t:""+t}function C(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function O(e){return"function"==typeof e}function I(e){return"function"==typeof e}function N(e,t){return e===t||e!=e&&t!=t}function T(e,t){var r=e[t];if(null!=r){if(!O(r))throw TypeError();return r}}function U(e){var t=T(e,s);if(!O(t))throw TypeError();var r=t.call(e);if(!E(r))throw TypeError();return r}function j(e){var t=e.next();return!t.done&&t}function R(e){var t=e.return;t&&t.call(e)}function P(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===f||t!==f)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var n=i.constructor;return"function"!=typeof n||n===e?t:n}function D(e,t,r){var i=g.getProvider(e,t);if(!x(i))return i;if(r){if(g.setProvider(e,t,v))return v;throw Error("Illegal state.")}}function L(e){return e.__=void 0,delete e.__,e}})},630376,(e,t,r)=>{"use strict";var i=e.i(467034);class n{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){let r=n.toUint8Array(e),i=n.toUint8Array(t);if(r.length!==i.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(let e of t)r+=e.byteLength;let i=new Uint8Array(r),n=0;for(let e of t){let t=this.toUint8Array(e);i.set(t,n),n+=t.length}return e[e.length-1]instanceof Function?this.toView(i,e[e.length-1]):i.buffer}}let o="string",s=/^[0-9a-f\s]+$/i,a=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,l=/^[a-zA-Z0-9-_]+$/;class c{static fromString(e){let t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){let t=n.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class u{static toString(e,t=!1){let r=n.toArrayBuffer(e),i=new DataView(r),o="";for(let e=0;e<r.byteLength;e+=2)o+=String.fromCharCode(i.getUint16(e,t));return o}static fromString(e,t=!1){let r=new ArrayBuffer(2*e.length),i=new DataView(r);for(let r=0;r<e.length;r++)i.setUint16(2*r,e.charCodeAt(r),t);return r}}class f{static isHex(e){return typeof e===o&&s.test(e)}static isBase64(e){return typeof e===o&&a.test(e)}static isBase64Url(e){return typeof e===o&&l.test(e)}static ToString(e,t="utf8"){let r=n.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return u.toString(r,!0);case"utf16":case"utf16be":return u.toString(r);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return u.fromString(e,!0);case"utf16":case"utf16be":return u.fromString(e);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){let t=n.toUint8Array(e);return"undefined"!=typeof btoa?btoa(this.ToString(t,"binary")):i.Buffer.from(t).toString("base64")}static FromBase64(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!f.isBase64(t))throw TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(i.Buffer.from(t,"base64")).buffer}static FromBase64Url(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!f.isBase64Url(t))throw TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=f.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return c.fromString(e);case"utf16":case"utf16be":return u.fromString(e);case"utf16le":case"usc2":return u.fromString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=f.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return c.toString(e);case"utf16":case"utf16be":return u.toString(e);case"utf16le":case"usc2":return u.toString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){let t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}static ToBinary(e){let t=n.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){let t=n.toUint8Array(e),r="",i=t.length;for(let e=0;e<i;e++){let i=t[e];i<16&&(r+="0"),r+=i.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!f.isHex(t))throw TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){let i=t.slice(e,e+2);r[e/2]=parseInt(i,16)}return r.buffer}static ToUtf16String(e,t=!1){return u.toString(e,t)}static FromUtf16String(e,t=!1){return u.fromString(e,t)}static Base64Padding(e){let t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}f.DEFAULT_UTF8_ENCODING="utf8",r.BufferSourceConverter=n,r.Convert=f,r.assign=function(e){let t=arguments[0];for(let e=1;e<arguments.length;e++){let r=arguments[e];for(let e in r)t[e]=r[e]}return t},r.combine=function(...e){let t=new Uint8Array(e.map(e=>e.byteLength).reduce((e,t)=>e+t)),r=0;return e.map(e=>new Uint8Array(e)).forEach(e=>{for(let i of e)t[r++]=i}),t.buffer},r.isEqual=function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}},284795,356026,784503,64043,e=>{"use strict";let t="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function r(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function i(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function n(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");r(e.outputLen),r(e.blockLen)}function o(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function s(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function a(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function l(e,t){return e<<32-t|e>>>t}function c(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e)),i(e),e}class u{}function f(e){let t=t=>e().update(c(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function h(e=32){if(t&&"function"==typeof t.getRandomValues)return t.getRandomValues(new Uint8Array(e));if(t&&"function"==typeof t.randomBytes)return Uint8Array.from(t.randomBytes(e));throw Error("crypto.getRandomValues must be defined")}class p extends u{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=a(this.buffer)}update(e){o(this),i(e=c(e));let{view:t,buffer:r,blockLen:n}=this,s=e.length;for(let i=0;i<s;){let o=Math.min(n-this.pos,s-i);if(o===n){let t=a(e);for(;n<=s-i;i+=n)this.process(t,i);continue}r.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){o(this);i(e);let t=this.outputLen;if(e.length<t)throw Error("digestInto() expects output buffer of length at least "+t);this.finished=!0;let{buffer:r,view:n,blockLen:l,isLE:c}=this,{pos:u}=this;r[u++]=128,s(this.buffer.subarray(u)),this.padOffset>l-u&&(this.process(n,0),u=0);for(let e=u;e<l;e++)r[e]=0;!function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>n&o),a=Number(r&o),l=4*!!i,c=4*!i;e.setUint32(t+l,s,i),e.setUint32(t+c,a,i)}(n,l-8,BigInt(8*this.length),c),this.process(n,0);let f=a(e),h=this.outputLen;if(h%4)throw Error("_sha2: outputLen should be aligned to 32bit");let p=h/4,d=this.get();if(p>d.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<p;e++)f.setUint32(4*e,d[e],c)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:n,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=n,e.length=i,e.pos=s,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}let d=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),y=Uint32Array.from([0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]),g=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),v=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),m=BigInt(0x100000000-1),b=BigInt(32),w=(e,t,r)=>e>>>r,A=(e,t,r)=>e<<32-r|t>>>r,S=(e,t,r)=>e>>>r|t<<32-r,x=(e,t,r)=>e<<32-r|t>>>r,B=(e,t,r)=>e<<64-r|t>>>r-32,E=(e,t,r)=>e>>>r-32|t<<64-r;function k(e,t,r,i){let n=(t>>>0)+(i>>>0);return{h:e+r+(n/0x100000000|0)|0,l:0|n}}let C=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),O=(e,t,r,i)=>t+r+i+(e/0x100000000|0)|0,I=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),N=(e,t,r,i,n)=>t+r+i+n+(e/0x100000000|0)|0,T=(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0),U=(e,t,r,i,n,o)=>t+r+i+n+o+(e/0x100000000|0)|0,j=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),R=new Uint32Array(64);class P extends p{constructor(e=32){super(64,e,8,!1),this.A=0|d[0],this.B=0|d[1],this.C=0|d[2],this.D=0|d[3],this.E=0|d[4],this.F=0|d[5],this.G=0|d[6],this.H=0|d[7]}get(){let{A:e,B:t,C:r,D:i,E:n,F:o,G:s,H:a}=this;return[e,t,r,i,n,o,s,a]}set(e,t,r,i,n,o,s,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)R[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=R[e-15],r=R[e-2],i=l(t,7)^l(t,18)^t>>>3,n=l(r,17)^l(r,19)^r>>>10;R[e]=n+R[e-7]+i+R[e-16]|0}let{A:r,B:i,C:n,D:o,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){var f,h,p,d;let t=u+(l(s,6)^l(s,11)^l(s,25))+((f=s)&a^~f&c)+j[e]+R[e]|0,y=(l(r,2)^l(r,13)^l(r,22))+((h=r)&(p=i)^h&(d=n)^p&d)|0;u=c,c=a,a=s,s=o+t|0,o=n,n=i,i=r,r=t+y|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,i,n,o,s,a,c,u)}roundClean(){s(R)}destroy(){this.set(0,0,0,0,0,0,0,0),s(this.buffer)}}let D=function(e,t=!1){let r=e.length,i=new Uint32Array(r),n=new Uint32Array(r);for(let o=0;o<r;o++){let{h:r,l:s}=function(e,t=!1){return t?{h:Number(e&m),l:Number(e>>b&m)}:{h:0|Number(e>>b&m),l:0|Number(e&m)}}(e[o],t);[i[o],n[o]]=[r,s]}return[i,n]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),L=D[0],_=D[1],H=new Uint32Array(80),V=new Uint32Array(80);class M extends p{constructor(e=64){super(128,e,16,!1),this.Ah=0|v[0],this.Al=0|v[1],this.Bh=0|v[2],this.Bl=0|v[3],this.Ch=0|v[4],this.Cl=0|v[5],this.Dh=0|v[6],this.Dl=0|v[7],this.Eh=0|v[8],this.El=0|v[9],this.Fh=0|v[10],this.Fl=0|v[11],this.Gh=0|v[12],this.Gl=0|v[13],this.Hh=0|v[14],this.Hl=0|v[15]}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:n,Cl:o,Dh:s,Dl:a,Eh:l,El:c,Fh:u,Fl:f,Gh:h,Gl:p,Hh:d,Hl:y}=this;return[e,t,r,i,n,o,s,a,l,c,u,f,h,p,d,y]}set(e,t,r,i,n,o,s,a,l,c,u,f,h,p,d,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|l,this.El=0|c,this.Fh=0|u,this.Fl=0|f,this.Gh=0|h,this.Gl=0|p,this.Hh=0|d,this.Hl=0|y}process(e,t){for(let r=0;r<16;r++,t+=4)H[r]=e.getUint32(t),V[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|H[e-15],r=0|V[e-15],i=S(t,r,1)^S(t,r,8)^w(t,r,7),n=x(t,r,1)^x(t,r,8)^A(t,r,7),o=0|H[e-2],s=0|V[e-2],a=S(o,s,19)^B(o,s,61)^w(o,s,6),l=I(n,x(o,s,19)^E(o,s,61)^A(o,s,6),V[e-7],V[e-16]),c=N(l,i,a,H[e-7],H[e-16]);H[e]=0|c,V[e]=0|l}let{Ah:r,Al:i,Bh:n,Bl:o,Ch:s,Cl:a,Dh:l,Dl:c,Eh:u,El:f,Fh:h,Fl:p,Gh:d,Gl:y,Hh:g,Hl:v}=this;for(let e=0;e<80;e++){let t=S(u,f,14)^S(u,f,18)^B(u,f,41),m=x(u,f,14)^x(u,f,18)^E(u,f,41),b=u&h^~u&d,w=T(v,m,f&p^~f&y,_[e],V[e]),A=U(w,g,t,b,L[e],H[e]),I=0|w,N=S(r,i,28)^B(r,i,34)^B(r,i,39),j=x(r,i,28)^E(r,i,34)^E(r,i,39),R=r&n^r&s^n&s,P=i&o^i&a^o&a;g=0|d,v=0|y,d=0|h,y=0|p,h=0|u,p=0|f,({h:u,l:f}=k(0|l,0|c,0|A,0|I)),l=0|s,c=0|a,s=0|n,a=0|o,n=0|r,o=0|i;let D=C(I,j,P);r=O(D,A,N,R),i=0|D}({h:r,l:i}=k(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:o}=k(0|this.Bh,0|this.Bl,0|n,0|o)),({h:s,l:a}=k(0|this.Ch,0|this.Cl,0|s,0|a)),({h:l,l:c}=k(0|this.Dh,0|this.Dl,0|l,0|c)),({h:u,l:f}=k(0|this.Eh,0|this.El,0|u,0|f)),({h:h,l:p}=k(0|this.Fh,0|this.Fl,0|h,0|p)),({h:d,l:y}=k(0|this.Gh,0|this.Gl,0|d,0|y)),({h:g,l:v}=k(0|this.Hh,0|this.Hl,0|g,0|v)),this.set(r,i,n,o,s,a,l,c,u,f,h,p,d,y,g,v)}roundClean(){s(H,V)}destroy(){s(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class $ extends M{constructor(){super(48),this.Ah=0|g[0],this.Al=0|g[1],this.Bh=0|g[2],this.Bl=0|g[3],this.Ch=0|g[4],this.Cl=0|g[5],this.Dh=0|g[6],this.Dl=0|g[7],this.Eh=0|g[8],this.El=0|g[9],this.Fh=0|g[10],this.Fl=0|g[11],this.Gh=0|g[12],this.Gl=0|g[13],this.Hh=0|g[14],this.Hl=0|g[15]}}let F=f(()=>new P),z=f(()=>new M),q=f(()=>new $);class K extends u{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,n(e);const r=c(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,o=new Uint8Array(i);o.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<o.length;e++)o[e]^=54;this.iHash.update(o),this.oHash=e.create();for(let e=0;e<o.length;e++)o[e]^=106;this.oHash.update(o),s(o)}update(e){return o(this),this.iHash.update(e),this}digestInto(e){o(this),i(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:o,outputLen:s}=this;return e.finished=i,e.destroyed=n,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let W=(e,t,r)=>new K(e,t).update(r).digest();W.create=(e,t)=>new K(e,t);let G=BigInt(0),Z=BigInt(1);function J(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Y(e){if(!J(e))throw Error("Uint8Array expected")}function Q(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}function X(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function ee(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?G:BigInt("0x"+e)}let et="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,er=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ei(e){if(Y(e),et)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=er[e[r]];return t}function en(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function eo(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(et)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=en(e.charCodeAt(n)),o=en(e.charCodeAt(n+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+o}return i}function es(e){return ee(ei(e))}function ea(e){return Y(e),ee(ei(Uint8Array.from(e).reverse()))}function el(e,t){return eo(e.toString(16).padStart(2*t,"0"))}function ec(e,t){return el(e,t).reverse()}function eu(e,t,r){let i;if("string"==typeof t)try{i=eo(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(J(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}function ef(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];Y(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}function eh(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}let ep=e=>"bigint"==typeof e&&G<=e;function ed(e,t,r){return ep(e)&&ep(t)&&ep(r)&&t<=e&&e<r}function ey(e,t,r,i){if(!ed(t,r,i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}let eg=e=>(Z<<BigInt(e))-Z,ev=e=>new Uint8Array(e),em={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||J(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function eb(e,t,r={}){let i=(t,r,i)=>{let n=em[r];if("function"!=typeof n)throw Error("invalid validator function");let o=e[t];if((!i||void 0!==o)&&!n(o,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}function ew(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let o=e(r,...i);return t.set(r,o),o}}let eA=BigInt(0),eS=BigInt(1),ex=BigInt(2),eB=BigInt(3),eE=BigInt(4),ek=BigInt(5),eC=BigInt(8);function eO(e,t){let r=e%t;return r>=eA?r:t+r}function eI(e,t,r){let i=e;for(;t-- >eA;)i*=i,i%=r;return i}function eN(e,t){if(e===eA)throw Error("invert: expected non-zero number");if(t<=eA)throw Error("invert: expected positive modulus, got "+t);let r=eO(e,t),i=t,n=eA,o=eS,s=eS,a=eA;for(;r!==eA;){let e=i/r,t=i%r,l=n-s*e,c=o-a*e;i=r,r=t,n=s,o=a,s=l,a=c}if(i!==eS)throw Error("invert: does not exist");return eO(n,t)}let eT=(e,t)=>(eO(e,t)&eS)===eS,eU=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ej(e){return eb(e,eU.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function eR(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),o=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),o),i}function eP(e,t){let r=function(e,t){let r=(e.ORDER-eS)/ex,i=e.pow(t,r),n=e.eql(i,e.ONE),o=e.eql(i,e.ZERO),s=e.eql(i,e.neg(e.ONE));if(!n&&!o&&!s)throw Error("Cannot find square root: probably non-prime P");return n?1:o?0:-1}(e,t);return 0===r||1===r}function eD(e,t){void 0!==t&&r(t);let i=void 0!==t?t:e.toString(2).length,n=Math.ceil(i/8);return{nBitLength:i,nByteLength:n}}function eL(e,t,r=!1,i={}){let n;if(e<=eA)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:o,nByteLength:s}=eD(e,t);if(s>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let a=Object.freeze({ORDER:e,isLE:r,BITS:o,BYTES:s,MASK:eg(o),ZERO:eA,ONE:eS,create:t=>eO(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return eA<=t&&t<e},is0:e=>e===eA,isOdd:e=>(e&eS)===eS,neg:t=>eO(-t,e),eql:(e,t)=>e===t,sqr:t=>eO(t*t,e),add:(t,r)=>eO(t+r,e),sub:(t,r)=>eO(t-r,e),mul:(t,r)=>eO(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<eA)throw Error("invalid exponent, negatives unsupported");if(r===eA)return e.ONE;if(r===eS)return t;let i=e.ONE,n=t;for(;r>eA;)r&eS&&(i=e.mul(i,n)),n=e.sqr(n),r>>=eS;return i})(a,e,t),div:(t,r)=>eO(t*eN(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>eN(t,e),sqrt:i.sqrt||(t=>(n||(n=e%eE===eB?function(t,r){let i=t.pow(r,(e+eS)/eE);if(!t.eql(t.sqr(i),r))throw Error("Cannot find square root");return i}:e%eC===ek?function(t,r){let i=t.mul(r,ex),n=t.pow(i,(e-ek)/eC),o=t.mul(r,n),s=t.mul(t.mul(o,ex),n),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),r))throw Error("Cannot find square root");return a}:function(e){let t=e-eS,r=0;for(;t%ex===eA;)t/=ex,r++;let i=ex,n=eL(e);for(;i<e&&eP(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r){let t=(e+eS)/eE;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}let o=(t+eS)/ex;return function(e,n){if(!eP(e,n))throw Error("Cannot find square root");let s=r,a=e.pow(e.mul(e.ONE,i),t),l=e.pow(n,o),c=e.pow(n,t);for(;!e.eql(c,e.ONE);){if(e.eql(c,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(c);t<s&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(a,eS<<BigInt(s-t-1));a=e.sqr(r),l=e.mul(l,r),c=e.mul(c,a),s=t}return l}}(e)),n(a,t))),toBytes:e=>r?ec(e,s):el(e,s),fromBytes:e=>{if(e.length!==s)throw Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return r?ea(e):es(e)},invertBatch:e=>eR(a,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(a)}function e_(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function eH(e){let t=e_(e);return t+Math.ceil(t/2)}let eV=BigInt(0),eM=BigInt(1);function e$(e,t){let r=t.negate();return e?r:t}function eF(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function ez(e,t){eF(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),n=2**e;return{windows:r,windowSize:i,mask:eg(e),maxNumber:n,shiftBy:BigInt(e)}}function eq(e,t,r){let{windowSize:i,mask:n,maxNumber:o,shiftBy:s}=r,a=Number(e&n),l=e>>s;a>i&&(a-=o,l+=eM);let c=t*i,u=c+Math.abs(a)-1,f=0===a;return{nextN:l,offset:u,isZero:f,isNeg:a<0,isNegF:t%2!=0,offsetF:c}}let eK=new WeakMap,eW=new WeakMap;function eG(e){return eW.get(e)||1}function eZ(e,t){return{constTimeNegate:e$,hasPrecomputes:e=>1!==eG(e),unsafeLadder(t,r,i=e.ZERO){let n=t;for(;r>eV;)r&eM&&(i=i.add(n)),n=n.double(),r>>=eM;return i},precomputeWindow(e,r){let{windows:i,windowSize:n}=ez(r,t),o=[],s=e,a=s;for(let e=0;e<i;e++){a=s,o.push(a);for(let e=1;e<n;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,i,n){let o=e.ZERO,s=e.BASE,a=ez(r,t);for(let e=0;e<a.windows;e++){let{nextN:t,offset:r,isZero:l,isNeg:c,isNegF:u,offsetF:f}=eq(n,e,a);n=t,l?s=s.add(e$(u,i[f])):o=o.add(e$(c,i[r]))}return{p:o,f:s}},wNAFUnsafe(r,i,n,o=e.ZERO){let s=ez(r,t);for(let e=0;e<s.windows&&n!==eV;e++){let{nextN:t,offset:r,isZero:a,isNeg:l}=eq(n,e,s);if(n=t,!a){let e=i[r];o=o.add(l?e.negate():e)}}return o},getPrecomputes(e,t,r){let i=eK.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&eK.set(t,r(i))),i},wNAFCached(e,t,r){let i=eG(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let n=eG(e);return 1===n?this.unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)},setWindowSize(e,r){eF(r,t),eW.set(e,r),eK.delete(e)}}}function eJ(e,t,r,i){if(!Array.isArray(r))throw Error("array expected");r.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)});if(!Array.isArray(i))throw Error("array of scalars expected");if(i.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)}),r.length!==i.length)throw Error("arrays of points and scalars must have equal length");let n=e.ZERO,o=function(e){let t;for(t=0;e>G;e>>=Z,t+=1);return t}(BigInt(r.length)),s=o>12?o-3:o>4?o-2:o?2:1,a=eg(s),l=Array(Number(a)+1).fill(n),c=Math.floor((t.BITS-1)/s)*s,u=n;for(let e=c;e>=0;e-=s){l.fill(n);for(let t=0;t<i.length;t++){let n=Number(i[t]>>BigInt(e)&a);l[n]=l[n].add(r[t])}let t=n;for(let e=l.length-1,r=n;e>0;e--)r=r.add(l[e]),t=t.add(r);if(u=u.add(t),0!==e)for(let e=0;e<s;e++)u=u.double()}return u}function eY(e){return ej(e.Fp),eb(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...eD(e.n,e.nBitLength),...e,...{p:e.Fp.ORDER}})}function eQ(e){void 0!==e.lowS&&Q("lowS",e.lowS),void 0!==e.prehash&&Q("prehash",e.prehash)}let eX={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=eX;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,n=X(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let o=i>127?X(n.length/2|128):"";return X(e)+o+n+t},decode(e,t){let{Err:r}=eX,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[i++],o=0;if(128&n){let e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let s=t.subarray(i,i+e);if(s.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of s)o=o<<8|e;if(i+=e,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=n;let s=t.subarray(i,i+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(i+o)}}},_int:{encode(e){let{Err:t}=eX;if(e<e0)throw new t("integer: negative integers are not allowed");let r=X(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=eX;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return es(e)}},toSig(e){let{Err:t,_int:r,_tlv:i}=eX,n=eu("signature",e),{v:o,l:s}=i.decode(48,n);if(s.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:l}=i.decode(2,o),{v:c,l:u}=i.decode(2,l);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(c)}},hexFromSig(e){let{_tlv:t,_int:r}=eX,i=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s));return t.encode(48,i+n)}},e0=BigInt(0),e1=BigInt(1),e2=BigInt(2),e8=BigInt(3),e3=BigInt(4);function e6(e,t){if(ej(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let r=function(e,t){let r=e.ORDER,i=e0;for(let e=r-e1;e%e2===e0;e/=e2)i+=e1;let n=i,o=e2<<n-e1-e1,s=o*e2,a=(r-e1)/s,l=(a-e1)/e2,c=s-e1,u=e.pow(t,a),f=e.pow(t,(a+e1)/e2),h=(t,r)=>{let i=u,s=e.pow(r,c),a=e.sqr(s);a=e.mul(a,r);let h=e.mul(t,a);h=e.pow(h,l),h=e.mul(h,s),s=e.mul(h,r),a=e.mul(h,t);let p=e.mul(a,s);h=e.pow(p,o);let d=e.eql(h,e.ONE);s=e.mul(a,f),h=e.mul(p,i),a=e.cmov(s,a,d),p=e.cmov(h,p,d);for(let t=n;t>e1;t--){let r=t-e2;r=e2<<r-e1;let n=e.pow(p,r),o=e.eql(n,e.ONE);s=e.mul(a,i),i=e.mul(i,i),n=e.mul(p,i),a=e.cmov(s,a,o),p=e.cmov(n,p,o)}return{isValid:d,value:a}};if(e.ORDER%e3===e8){let r=(e.ORDER-e8)/e3,i=e.sqrt(e.neg(t));h=(t,n)=>{let o=e.sqr(n),s=e.mul(t,n);o=e.mul(o,s);let a=e.pow(o,r);a=e.mul(a,s);let l=e.mul(a,i),c=e.mul(e.sqr(a),n),u=e.eql(c,t),f=e.cmov(l,a,u);return{isValid:u,value:f}}}return h}(e,t.Z);if(!e.isOdd)throw Error("Fp.isOdd is not implemented!");return i=>{let n,o,s,a,l,c,u,f;n=e.sqr(i),n=e.mul(n,t.Z),o=e.sqr(n),o=e.add(o,n),s=e.add(o,e.ONE),s=e.mul(s,t.B),a=e.cmov(t.Z,e.neg(o),!e.eql(o,e.ZERO)),a=e.mul(a,t.A),o=e.sqr(s),c=e.sqr(a),l=e.mul(c,t.A),o=e.add(o,l),o=e.mul(o,s),c=e.mul(c,a),l=e.mul(c,t.B),o=e.add(o,l),u=e.mul(n,s);let{isValid:h,value:p}=r(o,c);f=e.mul(n,i),f=e.mul(f,p),u=e.cmov(u,s,h),f=e.cmov(f,p,h);let d=e.isOdd(i)===e.isOdd(f);f=e.cmov(e.neg(f),f,d);let y=eR(e,[a],!0)[0];return{x:u=e.mul(u,y),y:f}}}function e4(e,t){let r=t=>(function(e){let t,r=(eb(t=eY(e),{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})),{Fp:i,n:n}=r,o=i.BYTES+1,s=2*i.BYTES+1;function a(e){return eO(e,n)}let{ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:u,isWithinCurveOrder:f}=function(e){let t=function(e){let t=eY(e);eb(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:i,a:n}=t;if(r){if(!i.eql(n,i.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:r}=t,i=eL(t.n,t.nBitLength),n=t.toBytes||((e,t,i)=>{let n=t.toAffine();return ef(Uint8Array.from([4]),r.toBytes(n.x),r.toBytes(n.y))}),o=t.fromBytes||(e=>{let t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function s(e){let{a:i,b:n}=t,o=r.sqr(e),s=r.mul(o,e);return r.add(r.add(s,r.mul(e,i)),n)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw Error("bad generator point: equation left != right");function a(e){let r,{allowedPrivateKeyLengths:i,nByteLength:n,wrapPrivateKey:o,n:s}=t;if(i&&"bigint"!=typeof e){if(J(e)&&(e=ei(e)),"string"!=typeof e||!i.includes(e.length))throw Error("invalid private key");e=e.padStart(2*n,"0")}try{r="bigint"==typeof e?e:es(eu("private key",e,n))}catch(t){throw Error("invalid private key, expected hex or "+n+" bytes, got "+typeof e)}return o&&(r=eO(r,s)),ey("private key",r,e1,s),r}function l(e){if(!(e instanceof f))throw Error("ProjectivePoint expected")}let c=ew((e,t)=>{let{px:i,py:n,pz:o}=e;if(r.eql(o,r.ONE))return{x:i,y:n};let s=e.is0();null==t&&(t=s?r.ONE:r.inv(o));let a=r.mul(i,t),l=r.mul(n,t),c=r.mul(o,t);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(c,r.ONE))throw Error("invZ was invalid");return{x:a,y:l}}),u=ew(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw Error("bad point: ZERO")}let{x:i,y:n}=e.toAffine();if(!r.isValid(i)||!r.isValid(n))throw Error("bad point: x or y not FE");let o=r.sqr(n),a=s(i);if(!r.eql(o,a))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class f{constructor(e,t,i){if(null==e||!r.isValid(e))throw Error("x required");if(null==t||!r.isValid(t)||r.is0(t))throw Error("y required");if(null==i||!r.isValid(i))throw Error("z required");this.px=e,this.py=t,this.pz=i,Object.freeze(this)}static fromAffine(e){let{x:t,y:i}=e||{};if(!e||!r.isValid(t)||!r.isValid(i))throw Error("invalid affine point");if(e instanceof f)throw Error("projective point not allowed");let n=e=>r.eql(e,r.ZERO);return n(t)&&n(i)?f.ZERO:new f(t,i,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=eR(r,e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(f.fromAffine)}static fromHex(e){let t=f.fromAffine(o(eu("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return f.BASE.multiply(a(e))}static msm(e,t){return eJ(f,i,e,t)}_setWindowSize(e){p.setWindowSize(this,e)}assertValidity(){u(this)}hasEvenY(){let{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){l(e);let{px:t,py:i,pz:n}=this,{px:o,py:s,pz:a}=e,c=r.eql(r.mul(t,a),r.mul(o,n)),u=r.eql(r.mul(i,a),r.mul(s,n));return c&&u}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){let{a:e,b:i}=t,n=r.mul(i,e8),{px:o,py:s,pz:a}=this,l=r.ZERO,c=r.ZERO,u=r.ZERO,h=r.mul(o,o),p=r.mul(s,s),d=r.mul(a,a),y=r.mul(o,s);return y=r.add(y,y),u=r.mul(o,a),u=r.add(u,u),l=r.mul(e,u),c=r.mul(n,d),c=r.add(l,c),l=r.sub(p,c),c=r.add(p,c),c=r.mul(l,c),l=r.mul(y,l),u=r.mul(n,u),d=r.mul(e,d),y=r.sub(h,d),y=r.mul(e,y),y=r.add(y,u),u=r.add(h,h),h=r.add(u,h),h=r.add(h,d),h=r.mul(h,y),c=r.add(c,h),d=r.mul(s,a),d=r.add(d,d),h=r.mul(d,y),l=r.sub(l,h),u=r.mul(d,p),u=r.add(u,u),new f(l,c,u=r.add(u,u))}add(e){l(e);let{px:i,py:n,pz:o}=this,{px:s,py:a,pz:c}=e,u=r.ZERO,h=r.ZERO,p=r.ZERO,d=t.a,y=r.mul(t.b,e8),g=r.mul(i,s),v=r.mul(n,a),m=r.mul(o,c),b=r.add(i,n),w=r.add(s,a);b=r.mul(b,w),w=r.add(g,v),b=r.sub(b,w),w=r.add(i,o);let A=r.add(s,c);return w=r.mul(w,A),A=r.add(g,m),w=r.sub(w,A),A=r.add(n,o),u=r.add(a,c),A=r.mul(A,u),u=r.add(v,m),A=r.sub(A,u),p=r.mul(d,w),u=r.mul(y,m),p=r.add(u,p),u=r.sub(v,p),p=r.add(v,p),h=r.mul(u,p),v=r.add(g,g),v=r.add(v,g),m=r.mul(d,m),w=r.mul(y,w),v=r.add(v,m),m=r.sub(g,m),m=r.mul(d,m),w=r.add(w,m),g=r.mul(v,w),h=r.add(h,g),g=r.mul(A,w),u=r.mul(b,u),u=r.sub(u,g),g=r.mul(b,v),p=r.mul(A,p),new f(u,h,p=r.add(p,g))}subtract(e){return this.add(e.negate())}is0(){return this.equals(f.ZERO)}wNAF(e){return p.wNAFCached(this,e,f.normalizeZ)}multiplyUnsafe(e){let{endo:i,n:n}=t;ey("scalar",e,e0,n);let o=f.ZERO;if(e===e0)return o;if(this.is0()||e===e1)return this;if(!i||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,e,f.normalizeZ);let{k1neg:s,k1:a,k2neg:l,k2:c}=i.splitScalar(e),u=o,h=o,d=this;for(;a>e0||c>e0;)a&e1&&(u=u.add(d)),c&e1&&(h=h.add(d)),d=d.double(),a>>=e1,c>>=e1;return s&&(u=u.negate()),l&&(h=h.negate()),h=new f(r.mul(h.px,i.beta),h.py,h.pz),u.add(h)}multiply(e){let i,n,{endo:o,n:s}=t;if(ey("scalar",e,e1,s),o){let{k1neg:t,k1:s,k2neg:a,k2:l}=o.splitScalar(e),{p:c,f:u}=this.wNAF(s),{p:h,f:d}=this.wNAF(l);c=p.constTimeNegate(t,c),h=p.constTimeNegate(a,h),h=new f(r.mul(h.px,o.beta),h.py,h.pz),i=c.add(h),n=u.add(d)}else{let{p:t,f:r}=this.wNAF(e);i=t,n=r}return f.normalizeZ([i,n])[0]}multiplyAndAddUnsafe(e,t,r){let i=f.BASE,n=(e,t)=>t!==e0&&t!==e1&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),o=n(this,t).add(n(e,r));return o.is0()?void 0:o}toAffine(e){return c(this,e)}isTorsionFree(){let{h:e,isTorsionFree:r}=t;if(e===e1)return!0;if(r)return r(f,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:e,clearCofactor:r}=t;return e===e1?this:r?r(f,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return Q("isCompressed",e),this.assertValidity(),n(f,this,e)}toHex(e=!0){return Q("isCompressed",e),ei(this.toRawBytes(e))}}f.BASE=new f(t.Gx,t.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);let h=t.nBitLength,p=eZ(f,t.endo?Math.ceil(h/2):h);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:function(e){return ed(e,e1,t.n)}}}({...r,toBytes(e,t,r){let n=t.toAffine(),o=i.toBytes(n.x);return(Q("isCompressed",r),r)?ef(Uint8Array.from([t.hasEvenY()?2:3]),o):ef(Uint8Array.from([4]),o,i.toBytes(n.y))},fromBytes(e){let t=e.length,r=e[0],n=e.subarray(1);if(t===o&&(2===r||3===r)){let e,t=es(n);if(!ed(t,e1,i.ORDER))throw Error("Point is not on curve");let o=u(t);try{e=i.sqrt(o)}catch(e){throw Error("Point is not on curve"+(e instanceof Error?": "+e.message:""))}return(1&r)==1!=((e&e1)===e1)&&(e=i.neg(e)),{x:t,y:e}}if(t===s&&4===r)return{x:i.fromBytes(n.subarray(0,i.BYTES)),y:i.fromBytes(n.subarray(i.BYTES,2*i.BYTES))};throw Error("invalid Point, expected length of "+o+", or uncompressed "+s+", got "+t)}}),h=e=>ei(el(e,r.nByteLength)),p=(e,t,r)=>es(e.slice(t,r));class d{constructor(e,t,r){ey("r",e,e1,n),ey("s",t,e1,n),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){let t=r.nByteLength;return new d(p(e=eu("compactSignature",e,2*t),0,t),p(e,t,2*t))}static fromDER(e){let{r:t,s:r}=eX.toSig(eu("DER",e));return new d(t,r)}assertValidity(){}addRecoveryBit(e){return new d(this.r,this.s,e)}recoverPublicKey(e){let{r:t,s:o,recovery:s}=this,c=v(eu("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let u=2===s||3===s?t+r.n:t;if(u>=i.ORDER)throw Error("recovery id 2 or 3 invalid");let f=(1&s)==0?"02":"03",p=l.fromHex(f+h(u)),d=eN(u,n),y=a(-c*d),g=a(o*d),m=l.BASE.multiplyAndAddUnsafe(p,y,g);if(!m)throw Error("point at infinify");return m.assertValidity(),m}hasHighS(){return this.s>n>>e1}normalizeS(){return this.hasHighS()?new d(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return eo(this.toDERHex())}toDERHex(){return eX.hexFromSig(this)}toCompactRawBytes(){return eo(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}function y(e){let t=J(e),r="string"==typeof e,i=(t||r)&&e.length;return t?i===o||i===s:r?i===2*o||i===2*s:e instanceof l}let g=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=es(e),i=8*e.length-r.nBitLength;return i>0?t>>BigInt(i):t},v=r.bits2int_modN||function(e){return a(g(e))},m=eg(r.nBitLength);function b(e){return ey("num < 2^"+r.nBitLength,e,e0,m),el(e,r.nByteLength)}let w={lowS:r.lowS,prehash:!1},A={lowS:r.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(e,t=!0){return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(y(e))throw Error("first arg must be private key");if(!y(t))throw Error("second arg must be public key");return l.fromHex(t).multiply(c(e)).toRawBytes(r)},sign:function(e,t,o=w){let{seed:s,k2sig:u}=function(e,t,o=w){if(["recovered","canonical"].some(e=>e in o))throw Error("sign() legacy options not supported");let{hash:s,randomBytes:u}=r,{lowS:h,prehash:p,extraEntropy:y}=o;null==h&&(h=!0),e=eu("msgHash",e),eQ(o),p&&(e=eu("prehashed msgHash",s(e)));let m=v(e),A=c(t),S=[b(A),b(m)];if(null!=y&&!1!==y){let e=!0===y?u(i.BYTES):y;S.push(eu("extraEntropy",e))}return{seed:ef(...S),k2sig:function(e){var t;let r=g(e);if(!f(r))return;let i=eN(r,n),o=l.BASE.multiply(r).toAffine(),s=a(o.x);if(s===e0)return;let c=a(i*a(m+s*A));if(c===e0)return;let u=2*(o.x!==s)|Number(o.y&e1),p=c;return h&&c>n>>e1&&(p=(t=c)>n>>e1?a(-t):t,u^=1),new d(s,p,u)}}}(e,t,o);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=ev(e),n=ev(e),o=0,s=()=>{i.fill(1),n.fill(0),o=0},a=(...e)=>r(n,i,...e),l=(e=ev(0))=>{let t;if(n=a((t=[0],Uint8Array.from(t)),e),i=a(),0!==e.length){let t;n=a((t=[1],Uint8Array.from(t)),e),i=a()}},c=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(i=a()).slice();r.push(t),e+=i.length}return ef(...r)};return(e,t)=>{let r;for(s(),l(e);!(r=t(c()));)l();return s(),r}})(r.hash.outputLen,r.nByteLength,r.hmac)(s,u)},verify:function(e,t,i,o=A){let s,c;t=eu("msgHash",t),i=eu("publicKey",i);let{lowS:u,prehash:f,format:h}=o;if(eQ(o),"strict"in o)throw Error("options.strict was renamed to lowS");if(void 0!==h&&"compact"!==h&&"der"!==h)throw Error("format must be compact or der");let p="string"==typeof e||J(e),y=!p&&!h&&"object"==typeof e&&null!==e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!p&&!y)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(y&&(c=new d(e.r,e.s)),p){try{"compact"!==h&&(c=d.fromDER(e))}catch(e){if(!(e instanceof eX.Err))throw e}c||"der"===h||(c=d.fromCompact(e))}s=l.fromHex(i)}catch(e){return!1}if(!c||u&&c.hasHighS())return!1;f&&(t=r.hash(t));let{r:g,s:m}=c,b=v(t),w=eN(m,n),S=a(b*w),x=a(g*w),B=l.BASE.multiplyAndAddUnsafe(s,S,x)?.toAffine();return!!B&&a(B.x)===g},ProjectivePoint:l,Signature:d,utils:{isValidPrivateKey(e){try{return c(e),!0}catch(e){return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{let e=eH(r.n);return function(e,t,r=!1){let i=e.length,n=e_(t),o=eH(t);if(i<16||i<o||i>1024)throw Error("expected "+o+"-1024 bytes of input, got "+i);let s=eO(r?ea(e):es(e),t-eS)+eS;return r?ec(s,n):el(s,n)}(r.randomBytes(e),r.n)},precompute:(e=8,t=l.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}})({...e,hash:t,hmac:(e,...r)=>W(t,e,function(...e){let t=0;for(let r=0;r<e.length;r++){let n=e[r];i(n),t+=n.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}(...r)),randomBytes:h});return{...r(t),create:r}}function e5(e,t){if(e9(e),e9(t),e<0||e>=1<<8*t)throw Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let i=t-1;i>=0;i--)r[i]=255&e,e>>>=8;return new Uint8Array(r)}function e9(e){if(!Number.isSafeInteger(e))throw Error("number expected")}function e7(e,t,r){let i;eb(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:o,m:s,hash:a,expand:l,DST:c}=r;Y(e),e9(t);let u="string"==typeof c?eh(c):c,f=Math.ceil((n.toString(2).length+o)/8),h=t*s*f;if("xmd"===l)i=function(e,t,r,i){Y(e),Y(t),e9(r),t.length>255&&(t=i(ef(eh("H2C-OVERSIZE-DST-"),t)));let{outputLen:n,blockLen:o}=i,s=Math.ceil(r/n);if(r>65535||s>255)throw Error("expand_message_xmd: invalid lenInBytes");let a=ef(t,e5(t.length,1)),l=e5(0,o),c=e5(r,2),u=Array(s),f=i(ef(l,e,c,e5(0,1),a));u[0]=i(ef(f,e5(1,1),a));for(let e=1;e<=s;e++){let t=[function(e,t){let r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e[i]^t[i];return r}(f,u[e-1]),e5(e+1,1),a];u[e]=i(ef(...t))}return ef(...u).slice(0,r)}(e,u,h,a);else if("xof"===l)i=function(e,t,r,i,n){if(Y(e),Y(t),e9(r),t.length>255){let e=Math.ceil(2*i/8);t=n.create({dkLen:e}).update(eh("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw Error("expand_message_xof: invalid lenInBytes");return n.create({dkLen:r}).update(e).update(e5(r,2)).update(t).update(e5(t.length,1)).digest()}(e,u,h,o,a);else if("_internal_pass"===l)i=e;else throw Error('expand must be "xmd" or "xof"');let p=Array(t);for(let e=0;e<t;e++){let t=Array(s);for(let r=0;r<s;r++){let o=f*(r+e*s),a=i.subarray(o,o+f);t[r]=eO(es(a),n)}p[e]=t}return p}function te(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined");function i(r){return e.fromAffine(t(r))}function n(t){let r=t.clearCofactor();return r.equals(e.ZERO)?e.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(e,t){let o=e7(e,2,{...r,DST:r.DST,...t}),s=i(o[0]),a=i(o[1]);return n(s.add(a))},encodeToCurve:(e,t)=>n(i(e7(e,1,{...r,DST:r.encodeDST,...t})[0])),mapToCurve(e){if(!Array.isArray(e))throw Error("expected array of bigints");for(let t of e)if("bigint"!=typeof t)throw Error("expected array of bigints");return n(i(e))}}}let tt=eL(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),tr=tt.create(BigInt("-3")),ti=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),tn=e4({a:tr,b:ti,Fp:tt,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},F),to=e6(tt,{A:tr,B:ti,Z:tt.create(BigInt("-10"))});te(tn.ProjectivePoint,e=>to(e[0]),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:tt.ORDER,m:1,k:128,expand:"xmd",hash:F});let ts=eL(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),ta=ts.create(BigInt("-3")),tl=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef");e4({a:ta,b:tl,Fp:ts,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},q),e6(ts,{A:ta,B:tl,Z:ts.create(BigInt("-12"))});let tc=eL(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),tu=tc.create(BigInt("-3")),tf=BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00");e4({a:tu,b:tf,Fp:tc,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1),lowS:!1,allowedPrivateKeyLengths:[130,131,132]},z),e6(tc,{A:tu,B:tf,Z:tc.create(BigInt("-4"))});let th=Uint8Array.from([0]),tp=Uint8Array.of();function td(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function ty(e,...t){if(!td(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function tg(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function tv(e,t){ty(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function tm(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function tb(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function tw(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}let tA=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function tS(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(td(e))e=tE(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function tx(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>n&o),a=Number(r&o),l=4*!!i,c=4*!i;e.setUint32(t+l,s,i),e.setUint32(t+c,a,i)}function tB(e){return e.byteOffset%4==0}function tE(e){return Uint8Array.from(e)}let tk=new Uint8Array(16),tC=tm(tk),tO=(e,t,r,i)=>({s3:r<<31|i>>>1,s2:t<<31|r>>>1,s1:e<<31|t>>>1,s0:e>>>1^-0x1f000000&-(1&i&1)}),tI=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;class tN{constructor(e,t){this.blockLen=16,this.outputLen=16,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,ty(e=tS(e),16);const r=tw(e);let i=r.getUint32(0,!1),n=r.getUint32(4,!1),o=r.getUint32(8,!1),s=r.getUint32(12,!1);const a=[];for(let e=0;e<128;e++)a.push({s0:tI(i),s1:tI(n),s2:tI(o),s3:tI(s)}),{s0:i,s1:n,s2:o,s3:s}=tO(i,n,o,s);const l=(e=>e>65536?8:e>1024?4:2)(t||1024);if(![1,2,4,8].includes(l))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=l;const c=128/l,u=this.windowSize=2**l,f=[];for(let e=0;e<c;e++)for(let t=0;t<u;t++){let r=0,i=0,n=0,o=0;for(let s=0;s<l;s++){if(!(t>>>l-s-1&1))continue;const{s0:c,s1:u,s2:f,s3:h}=a[l*e+s];r^=c,i^=u,n^=f,o^=h}f.push({s0:r,s1:i,s2:n,s3:o})}this.t=f}_updateBlock(e,t,r,i){e^=this.s0,t^=this.s1,r^=this.s2,i^=this.s3;let{W:n,t:o,windowSize:s}=this,a=0,l=0,c=0,u=0,f=(1<<n)-1,h=0;for(let p of[e,t,r,i])for(let e=0;e<4;e++){let t=p>>>8*e&255;for(let e=8/n-1;e>=0;e--){let{s0:r,s1:i,s2:p,s3:d}=o[h*s+(t>>>n*e&f)];a^=r,l^=i,c^=p,u^=d,h+=1}}this.s0=a,this.s1=l,this.s2=c,this.s3=u}update(e){tg(this),ty(e=tS(e));let t=tm(e),r=Math.floor(e.length/16),i=e.length%16;for(let e=0;e<r;e++)this._updateBlock(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]);return i&&(tk.set(e.subarray(16*r)),this._updateBlock(tC[0],tC[1],tC[2],tC[3]),tb(tC)),this}destroy(){let{t:e}=this;for(let t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){tg(this),tv(e,this),this.finished=!0;let{s0:t,s1:r,s2:i,s3:n}=this,o=tm(e);return o[0]=t,o[1]=r,o[2]=i,o[3]=n,e}digest(){let e=new Uint8Array(16);return this.digestInto(e),this.destroy(),e}}class tT extends tN{constructor(e,t){ty(e=tS(e));const r=function(e){e.reverse();let t=1&e[15],r=0;for(let t=0;t<e.length;t++){let i=e[t];e[t]=i>>>1|r,r=(1&i)<<7}return e[0]^=225&-t,e}(tE(e));super(r,t),tb(r)}update(e){e=tS(e),tg(this);let t=tm(e),r=e.length%16,i=Math.floor(e.length/16);for(let e=0;e<i;e++)this._updateBlock(tI(t[4*e+3]),tI(t[4*e+2]),tI(t[4*e+1]),tI(t[4*e+0]));return r&&(tk.set(e.subarray(16*i)),this._updateBlock(tI(tC[3]),tI(tC[2]),tI(tC[1]),tI(tC[0])),tb(tC)),this}digestInto(e){tg(this),tv(e,this),this.finished=!0;let{s0:t,s1:r,s2:i,s3:n}=this,o=tm(e);return o[0]=t,o[1]=r,o[2]=i,o[3]=n,e.reverse()}}function tU(e){let t=(t,r)=>e(r,t.length).update(tS(t)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(t,r)=>e(t,r),t}let tj=tU((e,t)=>new tN(e,t));tU((e,t)=>new tT(e,t));let tR=new Uint8Array(16);function tP(e){return e<<1^283&-(e>>7)}function tD(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(1&t),e=tP(e);return r}let tL=(()=>{let e=new Uint8Array(256);for(let t=0,r=1;t<256;t++,r^=tP(r))e[t]=r;let t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let i=e[255-r];i|=i<<8,t[e[r]]=(i^i>>4^i>>5^i>>6^i>>7^99)&255}return tb(e),t})(),t_=tL.map((e,t)=>tL.indexOf(t)),tH=e=>e<<24|e>>>8,tV=e=>e<<8|e>>>24;function tM(e,t){if(256!==e.length)throw Error("Wrong sbox length");let r=new Uint32Array(256).map((r,i)=>t(e[i])),i=r.map(tV),n=i.map(tV),o=n.map(tV),s=new Uint32Array(65536),a=new Uint32Array(65536),l=new Uint16Array(65536);for(let t=0;t<256;t++)for(let c=0;c<256;c++){let u=256*t+c;s[u]=r[t]^i[c],a[u]=n[t]^o[c],l[u]=e[t]<<8|e[c]}return{sbox:e,sbox2:l,T0:r,T1:i,T2:n,T3:o,T01:s,T23:a}}let t$=tM(tL,e=>tD(e,3)<<24|e<<16|e<<8|tD(e,2)),tF=tM(t_,e=>tD(e,11)<<24|tD(e,13)<<16|tD(e,9)<<8|tD(e,14)),tz=(()=>{let e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=tP(r))e[t]=r;return e})();function tq(e){ty(e);let t=e.length;if(![16,24,32].includes(t))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+t);let{sbox2:r}=t$,i=[];tB(e)||i.push(e=tE(e));let n=tm(e),o=n.length,s=e=>tW(r,e,e,e,e),a=new Uint32Array(t+28);a.set(n);for(let e=o;e<a.length;e++){let t=a[e-1];e%o==0?t=s(tH(t))^tz[e/o-1]:o>6&&e%o==4&&(t=s(t)),a[e]=a[e-o]^t}return tb(...i),a}function tK(e,t,r,i,n,o){return e[r<<8&65280|i>>>8&255]^t[n>>>8&65280|o>>>24&255]}function tW(e,t,r,i,n){return e[255&t|65280&r]|e[i>>>16&255|n>>>16&65280]<<16}function tG(e,t,r,i,n){let{sbox2:o,T01:s,T23:a}=t$,l=0;t^=e[l++],r^=e[l++],i^=e[l++],n^=e[l++];let c=e.length/4-2;for(let o=0;o<c;o++){let o=e[l++]^tK(s,a,t,r,i,n),c=e[l++]^tK(s,a,r,i,n,t),u=e[l++]^tK(s,a,i,n,t,r),f=e[l++]^tK(s,a,n,t,r,i);t=o,r=c,i=u,n=f}return{s0:e[l++]^tW(o,t,r,i,n),s1:e[l++]^tW(o,r,i,n,t),s2:e[l++]^tW(o,i,n,t,r),s3:e[l++]^tW(o,n,t,r,i)}}function tZ(e,t,r,i,n){ty(r,16),ty(i),n=function(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!tB(t))throw Error("invalid output, must be aligned");return t}(i.length,n);let o=tm(r),s=tw(r),a=tm(i),l=tm(n),c=12*!t,u=i.length,f=s.getUint32(c,t),{s0:h,s1:p,s2:d,s3:y}=tG(e,o[0],o[1],o[2],o[3]);for(let r=0;r+4<=a.length;r+=4)l[r+0]=a[r+0]^h,l[r+1]=a[r+1]^p,l[r+2]=a[r+2]^d,l[r+3]=a[r+3]^y,f=f+1>>>0,s.setUint32(c,f,t),{s0:h,s1:p,s2:d,s3:y}=tG(e,o[0],o[1],o[2],o[3]);let g=16*Math.floor(a.length/4);if(g<u){var v;let e=new Uint32Array([h,p,d,y]),t=new Uint8Array((v=e).buffer,v.byteOffset,v.byteLength);for(let e=g,r=0;e<u;e++,r++)n[e]=i[e]^t[r];tb(e)}return n}let tJ=((e,t)=>{function r(i,...n){if(ty(i),!tA)throw Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){let t=n[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?ty(t):ty(t,e.nonceLength)}let o=e.tagLength;o&&void 0!==n[1]&&ty(n[1]);let s=t(i,...n),a=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");ty(t)}},l=!1;return{encrypt(e,t){if(l)throw Error("cannot encrypt() twice with same key + nonce");return l=!0,ty(e),a(s.encrypt.length,t),s.encrypt(e,t)},decrypt(e,t){if(ty(e),o&&e.length<o)throw Error("invalid ciphertext length: smaller than tagLength="+o);return a(s.decrypt.length,t),s.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,t,r){if(t.length<8)throw Error("aes/gcm: invalid nonce length");function i(e,t,i){let n,o,s,a,l=(n=r?r.length:0,o=tj.create(e,i.length+n),r&&o.update(r),s=function(e,t,r){if("boolean"!=typeof r)throw Error(`boolean expected, not ${r}`);let i=new Uint8Array(16),n=tw(i);return tx(n,0,BigInt(t),r),tx(n,8,BigInt(e),r),i}(8*i.length,8*n,!1),o.update(i),o.update(s),a=o.digest(),tb(s),a);for(let e=0;e<t.length;e++)l[e]^=t[e];return l}function n(){let r=tq(e),i=tR.slice(),n=tR.slice();if(tZ(r,!1,n,n,i),12===t.length)n.set(t);else{let e=tR.slice();tx(tw(e),8,BigInt(8*t.length),!1);let r=tj.create(i).update(t).update(e);r.digestInto(n),r.destroy()}let o=tZ(r,!1,n,tR);return{xk:r,authKey:i,counter:n,tagMask:o}}return{encrypt(e){let{xk:t,authKey:r,counter:o,tagMask:s}=n(),a=new Uint8Array(e.length+16),l=[t,r,o,s];tB(e)||l.push(e=tE(e)),tZ(t,!1,o,e,a.subarray(0,e.length));let c=i(r,s,a.subarray(0,a.length-16));return l.push(c),a.set(c,e.length),tb(...l),a},decrypt(e){let{xk:t,authKey:r,counter:o,tagMask:s}=n(),a=[t,r,s,o];tB(e)||a.push(e=tE(e));let l=e.subarray(0,-16),c=e.subarray(-16),u=i(r,s,l);if(a.push(u),!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(u,c))throw Error("aes/gcm: invalid ghash tag");let f=tZ(t,!1,o,l);return tb(...a),f}}});var tY,tQ,tX,t0,t1,t2,t8,t3,t6,t4,t5,t9,t7,re,rt,rr,ri,rn,ro,rs,ra,rl,rc,ru,rf,rh,rp,rd,ry,rg,rv,rm,rb,rw,rA,rS,rx,rB,rE,rk,rC,rO,rI,rN,rT,rU,rj,rR,rP,rD,rL,r_,rH,rV,rM,r$,rF,rz,rq,rK,rW,rG,rZ,rJ,rY,rQ,rX,r0,r1,r2,r8,r3,r6,r4,r5,r9,r7,ie,it=["u8","u16","u32","u64","u128","i8","i16","i32","i64","i128","f32","f64"],ir=function(){function e(){this.offset=0,this.buffer_size=256,this.buffer=new ArrayBuffer(this.buffer_size),this.view=new DataView(this.buffer)}return e.prototype.resize_if_necessary=function(e){if(this.buffer_size-this.offset<e){this.buffer_size=Math.max(2*this.buffer_size,this.buffer_size+e);var t=new ArrayBuffer(this.buffer_size);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t,this.view=new DataView(t)}},e.prototype.get_used_buffer=function(){return new Uint8Array(this.buffer).slice(0,this.offset)},e.prototype.store_value=function(e,t){var r=t.substring(1),i=parseInt(r)/8;this.resize_if_necessary(i);var n="f"===t[0]?"setFloat".concat(r):"i"===t[0]?"setInt".concat(r):"setUint".concat(r);this.view[n](this.offset,e,!0),this.offset+=i},e.prototype.store_bytes=function(e){this.resize_if_necessary(e.length),new Uint8Array(this.buffer).set(new Uint8Array(e),this.offset),this.offset+=e.length},e}(),ii=function(){function e(e){this.offset=0,this.buffer_size=e.length,this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e),this.view=new DataView(this.buffer)}return e.prototype.assert_enough_buffer=function(e){if(this.offset+e>this.buffer.byteLength)throw Error("Error in schema, the buffer is smaller than expected")},e.prototype.consume_value=function(e){var t=e.substring(1),r=parseInt(t)/8;this.assert_enough_buffer(r);var i="f"===e[0]?"getFloat".concat(t):"i"===e[0]?"getInt".concat(t):"getUint".concat(t),n=this.view[i](this.offset,!0);return this.offset+=r,n},e.prototype.consume_bytes=function(e){this.assert_enough_buffer(e);var t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},e}(),io=(tY=function(e,t){return(tY=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}tY(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function is(e,t,r){if(typeof e!==t)throw Error("Expected ".concat(t," not ").concat(typeof e,"(").concat(e,") at ").concat(r.join(".")))}function ia(e,t,r){if(e!==t)throw Error("Array length ".concat(e," does not match schema length ").concat(t," at ").concat(r.join(".")))}var il=it.concat(["bool","string"]),ic=["option","enum","array","set","map","struct"],iu=function(e){function t(t,r){var i="Invalid schema: ".concat(JSON.stringify(t)," expected ").concat(r);return e.call(this,i)||this}return io(t,e),t}(Error),ih=function(){function e(e){this.encoded=new ir,this.fieldPath=["value"],this.checkTypes=e}return e.prototype.encode=function(e,t){return this.encode_value(e,t),this.encoded.get_used_buffer()},e.prototype.encode_value=function(e,t){if("string"==typeof t){if(it.includes(t))return this.encode_integer(e,t);if("string"===t)return this.encode_string(e);if("bool"===t)return this.encode_boolean(e)}if("object"==typeof t){if("option"in t)return this.encode_option(e,t);if("enum"in t)return this.encode_enum(e,t);if("array"in t)return this.encode_array(e,t);if("set"in t)return this.encode_set(e,t);if("map"in t)return this.encode_map(e,t);if("struct"in t)return this.encode_struct(e,t)}},e.prototype.encode_integer=function(e,t){var r=parseInt(t.substring(1));r<=32||"f64"==t?(this.checkTypes&&is(e,"number",this.fieldPath),this.encoded.store_value(e,t)):(this.checkTypes&&function(e,t){var r=["number","string","bigint","boolean"].includes(typeof e),i="object"==typeof e&&null!==e&&"toString"in e;if(!r&&!i)throw Error("Expected bigint, number, boolean or string not ".concat(typeof e,"(").concat(e,") at ").concat(t.join(".")))}(e,this.fieldPath),this.encode_bigint(BigInt(e),r))},e.prototype.encode_bigint=function(e,t){for(var r=t/8,i=new Uint8Array(r),n=0;n<r;n++)i[n]=Number(e&BigInt(255)),e>>=BigInt(8);this.encoded.store_bytes(new Uint8Array(i))},e.prototype.encode_string=function(e){this.checkTypes&&is(e,"string",this.fieldPath);for(var t=[],r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(r++,i=65536+((1023&i)<<10|1023&e.charCodeAt(r)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}this.encoded.store_value(t.length,"u32"),this.encoded.store_bytes(new Uint8Array(t))},e.prototype.encode_boolean=function(e){this.checkTypes&&is(e,"boolean",this.fieldPath),this.encoded.store_value(+!!e,"u8")},e.prototype.encode_option=function(e,t){null==e?this.encoded.store_value(0,"u8"):(this.encoded.store_value(1,"u8"),this.encode_value(e,t.option))},e.prototype.encode_enum=function(e,t){this.checkTypes&&function(e,t){if("object"!=typeof e||null===e)throw Error("Expected object not ".concat(typeof e,"(").concat(e,") at ").concat(t.join(".")))}(e,this.fieldPath);for(var r=Object.keys(e)[0],i=0;i<t.enum.length;i++){var n=t.enum[i];if(r===Object.keys(n.struct)[0])return this.encoded.store_value(i,"u8"),this.encode_struct(e,n)}throw Error("Enum key (".concat(r,") not found in enum schema: ").concat(JSON.stringify(t)," at ").concat(this.fieldPath.join(".")))},e.prototype.encode_array=function(e,t){if(Array.isArray(e)||e&&"object"==typeof e&&"length"in e&&"number"==typeof e.length&&(0===e.length||e.length>0&&e.length-1 in e))return this.encode_arraylike(e,t);if(e instanceof ArrayBuffer)return this.encode_buffer(e,t);throw Error("Expected Array-like not ".concat(typeof e,"(").concat(e,") at ").concat(this.fieldPath.join(".")))},e.prototype.encode_arraylike=function(e,t){t.array.len?ia(e.length,t.array.len,this.fieldPath):this.encoded.store_value(e.length,"u32");for(var r=0;r<e.length;r++)this.encode_value(e[r],t.array.type)},e.prototype.encode_buffer=function(e,t){t.array.len?ia(e.byteLength,t.array.len,this.fieldPath):this.encoded.store_value(e.byteLength,"u32"),this.encoded.store_bytes(new Uint8Array(e))},e.prototype.encode_set=function(e,t){this.checkTypes&&is(e,"object",this.fieldPath);var r=e instanceof Set?Array.from(e.values()):Object.values(e);this.encoded.store_value(r.length,"u32");for(var i=0;i<r.length;i++){var n=r[i];this.encode_value(n,t.set)}},e.prototype.encode_map=function(e,t){this.checkTypes&&is(e,"object",this.fieldPath);var r=e instanceof Map,i=r?Array.from(e.keys()):Object.keys(e);this.encoded.store_value(i.length,"u32");for(var n=0;n<i.length;n++){var o=i[n];this.encode_value(o,t.map.key),this.encode_value(r?e.get(o):e[o],t.map.value)}},e.prototype.encode_struct=function(e,t){this.checkTypes&&is(e,"object",this.fieldPath);for(var r=0,i=Object.keys(t.struct);r<i.length;r++){var n=i[r];this.fieldPath.push(n),this.encode_value(e[n],t.struct[n]),this.fieldPath.pop()}},e}();function ip(e){this.buffer=new ii(e)}function id(e){return e.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"")}ip.prototype.decode=function(e){return this.decode_value(e)},ip.prototype.decode_value=function(e){if("string"==typeof e){if(it.includes(e))return this.decode_integer(e);if("string"===e)return this.decode_string();if("bool"===e)return this.decode_boolean()}if("object"==typeof e){if("option"in e)return this.decode_option(e);if("enum"in e)return this.decode_enum(e);if("array"in e)return this.decode_array(e);if("set"in e)return this.decode_set(e);if("map"in e)return this.decode_map(e);if("struct"in e)return this.decode_struct(e)}throw Error("Unsupported type: ".concat(e))},ip.prototype.decode_integer=function(e){var t=parseInt(e.substring(1));return t<=32||"f64"==e?this.buffer.consume_value(e):this.decode_bigint(t,e.startsWith("i"))},ip.prototype.decode_bigint=function(e,t){void 0===t&&(t=!1);var r=e/8,i=new Uint8Array(this.buffer.consume_bytes(r)),n=i.reduceRight(function(e,t){return e+t.toString(16).padStart(2,"0")},"");return t&&i[r-1]?BigInt.asIntN(e,BigInt("0x".concat(n))):BigInt("0x".concat(n))},ip.prototype.decode_string=function(){for(var e=this.decode_integer("u32"),t=new Uint8Array(this.buffer.consume_bytes(e)),r=[],i=0;i<e;++i){var n=t[i];if(n<128)r.push(n);else if(n<224)r.push((31&n)<<6|63&t[++i]);else if(n<240)r.push((15&n)<<12|(63&t[++i])<<6|63&t[++i]);else{var o=(7&n)<<18|(63&t[++i])<<12|(63&t[++i])<<6|63&t[++i];r.push(o)}}return String.fromCodePoint.apply(String,r)},ip.prototype.decode_boolean=function(){return this.buffer.consume_value("u8")>0},ip.prototype.decode_option=function(e){var t=this.buffer.consume_value("u8");if(1===t)return this.decode_value(e.option);if(0!==t)throw Error("Invalid option ".concat(t));return null},ip.prototype.decode_enum=function(e){var t,r=this.buffer.consume_value("u8");if(r>e.enum.length)throw Error("Enum option ".concat(r," is not available"));var i=e.enum[r].struct,n=Object.keys(i)[0];return(t={})[n]=this.decode_value(i[n]),t},ip.prototype.decode_array=function(e){for(var t=[],r=e.array.len?e.array.len:this.decode_integer("u32"),i=0;i<r;++i)t.push(this.decode_value(e.array.type));return t},ip.prototype.decode_set=function(e){for(var t=this.decode_integer("u32"),r=new Set,i=0;i<t;++i)r.add(this.decode_value(e.set));return r},ip.prototype.decode_map=function(e){for(var t=this.decode_integer("u32"),r=new Map,i=0;i<t;++i){var n=this.decode_value(e.map.key),o=this.decode_value(e.map.value);r.set(n,o)}return r},ip.prototype.decode_struct=function(e){var t={};for(var r in e.struct)t[r]=this.decode_value(e.struct[r]);return t};let iy=(e,t)=>{if(!e||e.length%2!=0||!/^[0-9A-Fa-f]+$/.test(e))throw Error(`cannot create uint8array from invalid hex string: "${e}"`);let r=new Uint8Array(e.match(/../g).map(e=>parseInt(e,16)));if(!t)return r;if(e.length/2>t)throw Error("hex value cannot fit in a buffer of "+t+" byte(s)");let i=new Uint8Array(t);return i.set(r,t-r.length),i},ig=(e,t)=>{let r=t-e.length;if(r>0){let t=new Uint8Array(r).fill(0);return new Uint8Array([...t,...e])}if(r<0){let i=-1*r,n=0;for(let t=0;t<i&&t<e.length;t++)0===e[t]&&n++;if(n!==i)throw Error(`invalid number of starting zeroes. Expected number of zeroes: ${i}. Found: ${n}.`);return e.slice(i,i+t)}return e},iv=function(e){let t=e;for(;t&&!(t.encode&&t.decode&&t.decodeUnsafe)&&t.default;)t=t.default;return t}(e.i(103476)),im=function(e){let t=e;for(;t&&!(t.encode&&t.decode&&t.decodeUnsafe)&&t.default;)t=t.default;return t}(e.i(392576)),ib=(e,t)=>(e&BigInt(1)<<BigInt(t))!==BigInt(0),iw=new Uint8Array([75,69,77,0,16]),iA=new Uint8Array([72,80,75,69,0,16,0,1,0,2]),iS=new Uint8Array([72,80,75,69,45,118,49]),ix=new Uint8Array([115,101,99,114,101,116]),iB=new Uint8Array([101,97,101,95,112,114,107]),iE=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),ik=new Uint8Array([0,32,72,80,75,69,45,118,49,72,80,75,69,0,16,0,1,0,2,107,101,121,0,143,195,174,184,50,73,10,75,90,179,228,32,35,40,125,178,154,31,75,199,194,34,192,223,34,135,39,183,10,64,33,18,47,63,4,233,32,108,209,36,19,80,53,41,180,122,198,166,48,185,46,196,207,125,35,69,8,208,175,151,113,201,158,80]),iC=new Uint8Array([0,12,72,80,75,69,45,118,49,72,80,75,69,0,16,0,1,0,2,98,97,115,101,95,110,111,110,99,101,0,143,195,174,184,50,73,10,75,90,179,228,32,35,40,125,178,154,31,75,199,194,34,192,223,34,135,39,183,10,64,33,18,47,63,4,233,32,108,209,36,19,80,53,41,180,122,198,166,48,185,46,196,207,125,35,69,8,208,175,151,113,201,158,80]),iO=new TextEncoder().encode("qos_encryption_hmac_message"),iI="04cf288fe433cc4e1aa0ce1632feac4ea26bf2f5a09dcfe5a42c398e06898710330f0572882f4dbdf0f5304b8fc8703acd69adca9a4bbf7f5d00d20a5e364b2569",iN=`-----BEGIN CERTIFICATE-----
MIICETCCAZagAwIBAgIRAPkxdWgbkK/hHUbMtOTn+FYwCgYIKoZIzj0EAwMwSTEL
MAkGA1UEBhMCVVMxDzANBgNVBAoMBkFtYXpvbjEMMAoGA1UECwwDQVdTMRswGQYD
VQQDDBJhd3Mubml0cm8tZW5jbGF2ZXMwHhcNMTkxMDI4MTMyODA1WhcNNDkxMDI4
MTQyODA1WjBJMQswCQYDVQQGEwJVUzEPMA0GA1UECgwGQW1hem9uMQwwCgYDVQQL
DANBV1MxGzAZBgNVBAMMEmF3cy5uaXRyby1lbmNsYXZlczB2MBAGByqGSM49AgEG
BSuBBAAiA2IABPwCVOumCMHzaHDimtqQvkY4MpJzbolL//Zy2YlES1BR5TSksfbb
48C8WBoyt7F2Bw7eEtaaP+ohG2bnUs990d0JX28TcPQXCEPZ3BABIeTPYwEoCWZE
h8l5YoQwTcU/9KNCMEAwDwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUkCW1DdkF
R+eWw5b6cp3PmanfS5YwDgYDVR0PAQH/BAQDAgGGMAoGCCqGSM49BAMDA2kAMGYC
MQCjfy+Rocm9Xue4YnwWmNJVA44fA0P5W2OpYow9OYCVRaEevL8uO1XYru5xtMPW
rfMCMQCi85sWBbJwKKXdS6BptQFuZbT73o/gBh1qUxl/nNr12UO8Yfwr6wPLb+6N
IwLz3/Y=
-----END CERTIFICATE-----`,iT="641A0321A3E244EFE456463195D606317ED7CDCC3C1756E09893F3C68F79BB5B",iU={struct:{nonce:{array:{type:"u8",len:12}},ephemeralSenderPublic:{array:{type:"u8",len:65}},encryptedMessage:{array:{type:"u8"}}}},ij=(e,t=!0)=>tn.getPublicKey(e,t),iR=({plainTextBuf:e,targetKeyBuf:t})=>{try{let r=iH(),i=iy(r.privateKey),n=iy(r.publicKeyUncompressed),o=iV(n,t),s=iW(t,id(i)),a=iJ(n,id(t)),l=iz(iB,s,iw),c=iq(iE,a,iw,32),u=iK(new Uint8Array([]),l,c,32);l=iz(ix,new Uint8Array([]),iA),c=ik;let f=iK(u,l,c,32);c=iC;let h=iK(u,l,c,12),p=iG(e,f,h,o),d=i$(n),y=new Uint8Array(d.length+p.length);return y.set(d,0),y.set(p,d.length),y}catch(e){throw Error(`Unable to perform hpkeEncrypt: ${e}`)}},iP=({plainTextBuf:e,targetKeyBuf:t,senderPriv:r})=>{try{let i=iy(r),n=ij(r,!1),o=iV(n,t),s=iW(t,id(i)),a=iJ(n,id(t)),l=iz(iB,s,iw),c=iq(iE,a,iw,32),u=iK(new Uint8Array([]),l,c,32);l=iz(ix,new Uint8Array([]),iA),c=ik;let f=iK(u,l,c,32);c=iC;let h=iK(u,l,c,12),p=iG(e,f,h,o),d=i$(n),y=new Uint8Array(d.length+p.length);return y.set(d,0),y.set(p,d.length),y}catch(e){throw Error(`Unable to perform hpkeEncrypt: ${e}`)}},iD=async(e,t)=>{var r;let i=iH(),n=i.publicKeyUncompressed,o=await i0(iy(n),iy(i.privateKey),e),s=new Uint8Array(12);crypto.getRandomValues(s);let a=function(e,t){let r=e.length,i=t.length;if(r>255||i>255)throw Error("AAD len fields are 1 byte");let n=new Uint8Array(r+1+i+1),o=0;return n.set(e,o),o+=r,n[o++]=r,n.set(t,o),o+=i,n[o++]=i,n}(iy(n),e),l=await crypto.subtle.encrypt({name:"AES-GCM",iv:s,tagLength:128,additionalData:a},o,t),c={nonce:s,ephemeralSenderPublic:iy(n),encryptedMessage:new Uint8Array(l)};return void 0===r&&(r=!0),r&&function e(t){if(!("string"==typeof t&&il.includes(t))){if(t&&"object"==typeof t){var r=Object.keys(t);if(1===r.length&&ic.includes(r[0])){var i=r[0];if("option"===i)return e(t[i]);if("enum"===i){var n=t[i];if(!Array.isArray(n))throw new iu(n,"Array");for(var o=0;o<n.length;o++){var s=n[o];if("object"!=typeof s||!("struct"in s))throw Error('Missing "struct" key in enum schema');if("object"!=typeof s.struct||1!==Object.keys(s.struct).length)throw Error('The "struct" in each enum must have a single key');e({struct:s.struct})}return}if("array"===i){var a=t[i];if("object"!=typeof a)throw new iu(a,"{ type, len? }");if(a.len&&"number"!=typeof a.len)throw Error("Invalid schema: ".concat(a));if("type"in a)return e(a.type);throw new iu(a,"{ type, len? }")}if("set"===i)return e(t[i]);if("map"===i){var l=t[i];if("object"==typeof l&&"key"in l&&"value"in l)e(l.key),e(l.value);else throw new iu(l,"{ key, value }");return}if("struct"===i){var c=t[i];if("object"!=typeof c)throw new iu(c,"object");for(var u in c)e(c[u]);return}}}throw new iu(t,ic.join(", ")+" or "+il.join(", "))}}(iU),new ih(r).encode(c,iU)},iL=e=>{let t=e.slice(0,33),r=e.slice(33);return JSON.stringify({encappedPublic:id(iF(t)),ciphertext:id(r)})},i_=({ciphertextBuf:e,encappedKeyBuf:t,receiverPriv:r})=>{try{let i,n,o=ij(iy(r),!1),s=iV(t,o),a=iW(t,r),l=iJ(t,id(o));i=iz(iB,a,iw),n=iq(iE,l,iw,32);let c=iK(new Uint8Array([]),i,n,32);i=iz(ix,new Uint8Array([]),iA),n=ik;let u=iK(c,i,n,32);n=iC;let f=iK(c,i,n,12);return iZ(e,u,f,s)}catch(e){throw Error(`Unable to perform hpkeDecrypt: ${e} `)}},iH=()=>{let e=h(32),t=ij(e,!0),r=id(iF(t));return{privateKey:id(e),publicKey:id(t),publicKeyUncompressed:r}},iV=(e,t)=>new Uint8Array([...Array.from(e),...Array.from(t)]),iM=e=>e.slice(36,68),i$=e=>{let t=e.byteLength;var r=e.slice(0,1+t>>>1);return r[0]=2|1&e[t-1],r},iF=(e,t="CURVE_P256")=>{let r,i,n;if(33!==e.length)throw Error("failed to uncompress raw public key: invalid length");if(2!==e[0]&&3!==e[0])throw Error("failed to uncompress raw public key: invalid prefix");let o=3===e[0],s=BigInt("0x"+id(e.subarray(1)));"CURVE_P256"===t?(r=BigInt("115792089210356248762697446949407573530086143415290314195533631308867097853951"),n=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),i=r-BigInt(3)):(r=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),i=BigInt(0),n=BigInt(7));let a=((e,t)=>{if(t<=BigInt(0))throw Error("p must be positive");let r=e%t;if(ib(t,0)&&ib(t,1)){let e=((e,t,r)=>{if(t===BigInt(0))return BigInt(1);let i=e%r,n=t.toString(2);for(let t=1;t<n.length;++t)i=i*i%r,"1"===n[t]&&(i=i*e%r);return i})(r,t+BigInt(1)>>BigInt(2),t);if(e*e%t!==r)throw Error("could not find a modular square root");return e}throw Error("unsupported modulus value")})(((s*s+i)*s+n)%r,r);if(o!==ib(a,0)&&(a=(r-a)%r),s<BigInt(0)||s>=r)throw Error("x is out of range");if(a<BigInt(0)||a>=r)throw Error("y is out of range");return iy("04"+iY(s,64)+iY(a,64))},iz=(e,t,r)=>{let i=new Uint8Array(iS.length+r.length+e.length+t.length),n=0;return i.set(iS,n),n+=iS.length,i.set(r,n),n+=r.length,i.set(e,n),n+=e.length,i.set(t,n),i},iq=(e,t,r,i)=>{let n=new Uint8Array(9+r.byteLength+e.byteLength+t.byteLength);return n.set(new Uint8Array([0,i]),0),n.set(iS,2),n.set(r,9),n.set(e,9+r.byteLength),n.set(t,9+r.byteLength+e.byteLength),n},iK=(e,t,i,o)=>{var a;let l=(a=e,n(F),void 0===a&&(a=new Uint8Array(F.outputLen)),W(F,c(a),c(t))),u=function(e,t,i,o=32){n(e),r(o);let a=e.outputLen;if(o>255*a)throw Error("Length should be <= 255*HashLen");let l=Math.ceil(o/a);void 0===i&&(i=tp);let c=new Uint8Array(l*a),u=W.create(e,t),f=u._cloneInto(),h=new Uint8Array(u.outputLen);for(let e=0;e<l;e++)th[0]=e+1,f.update(0===e?tp:h).update(i).update(th).digestInto(h),c.set(h,a*e),u._cloneInto(f);return u.destroy(),f.destroy(),s(h,th),c.slice(0,o)}(F,l,i,o);return new Uint8Array(u)},iW=(e,t)=>tn.getSharedSecret(iy(t),e).slice(1),iG=(e,t,r,i)=>tJ(t,r,i).encrypt(e),iZ=(e,t,r,i)=>tJ(t,r,i).decrypt(e),iJ=(e,t)=>{let r=new Uint8Array(e),i=iy(t),n=new Uint8Array(r.length+i.length);return n.set(r),n.set(i,r.length),n},iY=(e,t)=>{let r=e.toString(16);if(r.length>t)throw Error(`number cannot fit in a hex string of ${t} characters`);return r.padStart(t,"0")},iQ=e=>{let t=iy(e);if(t.length<2)throw Error("failed to convert DER-encoded signature: insufficient length");if(48!==t[0])throw Error("failed to convert DER-encoded signature: invalid format (missing SEQUENCE tag)");let r=1,i=t[1];if(i<=127){if(t.length<2+i)throw Error("failed to convert DER-encoded signature: inconsistent message length header");r+=1}else throw Error("failed to convert DER-encoded signature: unexpectedly large or invalid signature length");if(2!==t[r])throw Error("failed to convert DER-encoded signature: invalid tag for r");let n=t[++r];if(n>33)throw Error("failed to convert DER-encoded signature: unexpected length for r");r++;let o=t.slice(r,r+n);if(2!==t[r+=n])throw Error("failed to convert DER-encoded signature: invalid tag for s");let s=t[++r];if(s>33)throw Error("failed to convert DER-encoded signature: unexpected length for s");r++;let a=t.slice(r,r+s);return new Uint8Array([...ig(o,32),...ig(a,32)])},iX=e=>{let t=iy(e),r=t.slice(0,32),i=t.slice(32,64),n=e=>{if(void 0===e||0===e.length||void 0===e[0])throw Error("Invalid integer: input is undefined or empty.");let t=128&e[0]?new Uint8Array([0,...e]):e;return new Uint8Array([2,t.length,...t])},o=n(r),s=n(i);return id(new Uint8Array([48,o.length+s.length,...o,...s]))};async function i0(e,t,r){let i=tn.getSharedSecret(t,r,!1).slice(1,33),n=new Uint8Array(e.length+r.length+i.length);n.set(e,0),n.set(r,e.length),n.set(i,e.length+r.length);let o=await crypto.subtle.importKey("raw",n,{name:"HMAC",hash:"SHA-512"},!1,["sign"]),s=new Uint8Array(await crypto.subtle.sign("HMAC",o,iO)).slice(0,32);return crypto.subtle.importKey("raw",s,{name:"AES-GCM"},!1,["encrypt"])}e.s(["buildAdditionalAssociatedData",()=>iV,"compressRawPublicKey",()=>i$,"extractPrivateKeyFromPKCS8Bytes",()=>iM,"formatHpkeBuf",()=>iL,"fromDerSignature",()=>iQ,"generateP256KeyPair",()=>iH,"getPublicKey",()=>ij,"hpkeAuthEncrypt",()=>iP,"hpkeDecrypt",()=>i_,"hpkeEncrypt",()=>iR,"quorumKeyEncrypt",()=>iD,"toDerSignature",()=>iX,"uncompressRawPublicKey",()=>iF],356026);let i1=BigInt(0),i2=BigInt(1),i8=BigInt(2),i3=BigInt(8),i6={zip215:!0},i4=(BigInt(0),BigInt(1),BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949")),i5=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),i9=BigInt(0),i7=BigInt(1),ne=BigInt(2),nt=BigInt(3),nr=BigInt(5),ni=BigInt(8);function nn(e,t){var r;let i,n,o,s,a,l,c,u,f,h,p,d,y,g,v=eO(t*t*t,i4),m=(r=e*eO(v*v*t,i4),i=BigInt(10),n=BigInt(20),o=BigInt(40),s=BigInt(80),l=eI(a=r*r%i4*r%i4,ne,i4)*a%i4,c=eI(l,i7,i4)*r%i4,u=eI(c,nr,i4)*c%i4,f=eI(u,i,i4)*u%i4,h=eI(f,n,i4)*f%i4,p=eI(h,o,i4)*h%i4,d=eI(p,s,i4)*p%i4,y=eI(d,s,i4)*p%i4,g=eI(y,i,i4)*u%i4,{pow_p_5_8:eI(g,ne,i4)*r%i4,b2:a}).pow_p_5_8,b=eO(e*v*m,i4),w=eO(t*b*b,i4),A=b,S=eO(b*i5,i4),x=w===e,B=w===eO(-e,i4),E=w===eO(-e*i5,i4);return x&&(b=A),(B||E)&&(b=S),eT(b,i4)&&(b=eO(-b,i4)),{isValid:x||B,value:b}}let no=eL(i4,void 0,!0),ns=function(e){let t,r=(t=eY(e),eb(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})),{Fp:i,n:n,prehash:o,hash:s,randomBytes:a,nByteLength:l,h:c}=r,u=i8<<BigInt(8*l)-i2,f=i.create,h=eL(r.n,r.nBitLength),p=r.uvRatio||((e,t)=>{try{return{isValid:!0,value:i.sqrt(e*i.inv(t))}}catch(e){return{isValid:!1,value:i1}}}),d=r.adjustScalarBytes||(e=>e),y=r.domain||((e,t,r)=>{if(Q("phflag",r),t.length||r)throw Error("Contexts/pre-hash are not supported");return e});function g(e,t,r=!1){ey("coordinate "+e,t,r?i2:i1,u)}function v(e){if(!(e instanceof w))throw Error("ExtendedPoint expected")}let m=ew((e,t)=>{let{ex:r,ey:n,ez:o}=e,s=e.is0();null==t&&(t=s?i3:i.inv(o));let a=f(r*t),l=f(n*t),c=f(o*t);if(s)return{x:i1,y:i2};if(c!==i2)throw Error("invZ was invalid");return{x:a,y:l}}),b=ew(e=>{let{a:t,d:i}=r;if(e.is0())throw Error("bad point: ZERO");let{ex:n,ey:o,ez:s,et:a}=e,l=f(n*n),c=f(o*o),u=f(s*s),h=f(u*u),p=f(l*t);if(f(u*f(p+c))!==f(h+f(i*f(l*c))))throw Error("bad point: equation left != right (1)");if(f(n*o)!==f(s*a))throw Error("bad point: equation left != right (2)");return!0});class w{constructor(e,t,r,i){g("x",e),g("y",t),g("z",r,!0),g("t",i),this.ex=e,this.ey=t,this.ez=r,this.et=i,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw Error("extended point not allowed");let{x:t,y:r}=e||{};return g("x",t),g("y",r),new w(t,r,i2,f(t*r))}static normalizeZ(e){let t=eR(i,e.map(e=>e.ez));return e.map((e,r)=>e.toAffine(t[r])).map(w.fromAffine)}static msm(e,t){return eJ(w,h,e,t)}_setWindowSize(e){x.setWindowSize(this,e)}assertValidity(){b(this)}equals(e){v(e);let{ex:t,ey:r,ez:i}=this,{ex:n,ey:o,ez:s}=e,a=f(t*s),l=f(n*i),c=f(r*s),u=f(o*i);return a===l&&c===u}is0(){return this.equals(w.ZERO)}negate(){return new w(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:e}=r,{ex:t,ey:i,ez:n}=this,o=f(t*t),s=f(i*i),a=f(i8*f(n*n)),l=f(e*o),c=t+i,u=f(f(c*c)-o-s),h=l+s,p=h-a,d=l-s,y=f(u*p),g=f(h*d),v=f(u*d);return new w(y,g,f(p*h),v)}add(e){v(e);let{a:t,d:i}=r,{ex:n,ey:o,ez:s,et:a}=this,{ex:l,ey:c,ez:u,et:h}=e,p=f(n*l),d=f(o*c),y=f(a*i*h),g=f(s*u),m=f((n+o)*(l+c)-p-d),b=g-y,A=g+y,S=f(d-t*p),x=f(m*b),B=f(A*S),E=f(m*S);return new w(x,B,f(b*A),E)}subtract(e){return this.add(e.negate())}wNAF(e){return x.wNAFCached(this,e,w.normalizeZ)}multiply(e){ey("scalar",e,i2,n);let{p:t,f:r}=this.wNAF(e);return w.normalizeZ([t,r])[0]}multiplyUnsafe(e,t=w.ZERO){return(ey("scalar",e,i1,n),e===i1)?S:this.is0()||e===i2?this:x.wNAFCachedUnsafe(this,e,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return x.unsafeLadder(this,n).is0()}toAffine(e){return m(this,e)}clearCofactor(){let{h:e}=r;return e===i2?this:this.multiplyUnsafe(e)}static fromHex(e,t=!1){let{d:n,a:o}=r,s=i.BYTES;e=eu("pointHex",e,s),Q("zip215",t);let a=e.slice(),l=e[s-1];a[s-1]=-129&l;let c=ea(a);ey("pointHex.y",c,i1,t?u:i.ORDER);let h=f(c*c),{isValid:d,value:y}=p(f(h-i2),f(n*h-o));if(!d)throw Error("Point.fromHex: invalid y coordinate");let g=(y&i2)===i2,v=(128&l)!=0;if(!t&&y===i1&&v)throw Error("Point.fromHex: x=0 and x_0=1");return v!==g&&(y=f(-y)),w.fromAffine({x:y,y:c})}static fromPrivateKey(e){let{scalar:t}=B(e);return A.multiply(t)}toRawBytes(){let{x:e,y:t}=this.toAffine(),r=ec(t,i.BYTES);return r[r.length-1]|=e&i2?128:0,r}toHex(){return ei(this.toRawBytes())}}w.BASE=new w(r.Gx,r.Gy,i2,f(r.Gx*r.Gy)),w.ZERO=new w(i1,i2,i2,i1);let{BASE:A,ZERO:S}=w,x=eZ(w,8*l);function B(e){let t=i.BYTES;e=eu("private key",e,t);let r=eu("hashed private key",s(e),2*t),o=d(r.slice(0,t)),a=r.slice(t,2*t),l=eO(ea(o),n);return{head:o,prefix:a,scalar:l}}function E(e){let{head:t,prefix:r,scalar:i}=B(e),n=A.multiply(i),o=n.toRawBytes();return{head:t,prefix:r,scalar:i,point:n,pointBytes:o}}function k(e=Uint8Array.of(),...t){return eO(ea(s(y(ef(...t),eu("context",e),!!o))),n)}return A._setWindowSize(8),{CURVE:r,getPublicKey:function(e){return E(e).pointBytes},sign:function(e,t,r={}){e=eu("message",e),o&&(e=o(e));let{prefix:s,scalar:a,pointBytes:l}=E(t),c=k(r.context,s,e),u=A.multiply(c).toRawBytes(),f=eO(c+k(r.context,u,l,e)*a,n);return ey("signature.s",f,i1,n),eu("result",ef(u,ec(f,i.BYTES)),2*i.BYTES)},verify:function(e,t,r,n=i6){let s,a,l,{context:c,zip215:u}=n,f=i.BYTES;e=eu("signature",e,2*f),t=eu("message",t),r=eu("publicKey",r,f),void 0!==u&&Q("zip215",u),o&&(t=o(t));let h=ea(e.slice(f,2*f));try{s=w.fromHex(r,u),a=w.fromHex(e.slice(0,f),u),l=A.multiplyUnsafe(h)}catch(e){return!1}if(!u&&s.isSmallOrder())return!1;let p=k(c,a.toRawBytes(),s.toRawBytes(),t);return a.add(s.multiplyUnsafe(p)).subtract(l).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:E,randomPrivateKey:()=>a(i.BYTES),precompute:(e=8,t=w.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}({a:no.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:no,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:ni,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:z,randomBytes:h,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:nn}),na=(no.ORDER+nt)/ni,nl=no.pow(ne,na),nc=no.sqrt(no.neg(no.ONE)),nu=function(e,t){if(!e.isOdd)throw Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}(no,no.neg(BigInt(486664)));te(ns.ExtendedPoint,e=>(function(e){let t,r,i,n,o,s,a,l,c,u,f,h,p,d,y,g,v,m,b,w,A,S,x,{xMn:B,xMd:E,yMn:k,yMd:C}=(t=(no.ORDER-nr)/ni,r=BigInt(486662),i=no.sqr(e),i=no.mul(i,ne),n=no.add(i,no.ONE),o=no.neg(r),s=no.sqr(n),a=no.mul(s,n),l=no.mul(i,r),l=no.mul(l,o),l=no.add(l,s),l=no.mul(l,o),c=no.sqr(a),s=no.sqr(c),c=no.mul(c,a),c=no.mul(c,l),s=no.mul(s,c),u=no.pow(s,t),u=no.mul(u,c),f=no.mul(u,nc),s=no.sqr(u),s=no.mul(s,a),h=no.eql(s,l),p=no.cmov(f,u,h),d=no.mul(o,i),y=no.mul(u,e),y=no.mul(y,nl),g=no.mul(y,nc),v=no.mul(l,i),s=no.sqr(y),s=no.mul(s,a),m=no.eql(s,v),b=no.cmov(g,y,m),s=no.sqr(p),s=no.mul(s,a),w=no.eql(s,l),A=no.cmov(d,o,w),S=no.cmov(b,p,w),x=no.isOdd(S),{xMn:A,xMd:n,yMn:S=no.cmov(S,no.neg(S),w!==x),yMd:i7}),O=no.mul(B,C);O=no.mul(O,nu);let I=no.mul(E,k),N=no.sub(B,E),T=no.add(B,E),U=no.mul(I,T),j=no.eql(U,no.ZERO);O=no.cmov(O,no.ZERO,j),I=no.cmov(I,no.ONE,j),N=no.cmov(N,no.ONE,j),T=no.cmov(T,no.ONE,j);let[R,P]=eR(no,[I,T],!0);return{x:no.mul(O,R),y:no.mul(N,P)}})(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:no.ORDER,m:1,k:128,expand:"xmd",hash:z});(tQ=rs||(rs={})).NOTARIZER="notarizer",tQ.SIGNER="signer",tQ.EVM_PARSER="evm-parser",tQ.TLS_FETCHER="tls-fetcher",tQ.UMP="ump";let nf=(e,t)=>{try{let r=im.decode(e);if(r.byteLength<=33)throw Error(`Bundle size ${r.byteLength} is too low. Expecting a compressed public key (33 bytes) and an encrypted credential.`);let i=r.slice(0,33),n=r.slice(33),o=iF(i),s=i_({ciphertextBuf:n,encappedKeyBuf:o,receiverPriv:t});return id(s)}catch(e){throw Error(`"Error decrypting bundle:", ${e}`)}},nh=async({exportBundle:e,embeddedKey:t,organizationId:r,dangerouslyOverrideSignerPublicKey:i,keyFormat:n,returnMnemonic:o})=>{try{let s=JSON.parse(e);if(!await nd(s.enclaveQuorumPublic,s.dataSignature,s.data,i))throw Error(`failed to verify enclave signature: ${s}`);let a=JSON.parse(new TextDecoder().decode(iy(s.data)));if(!a.organizationId||a.organizationId!==r)throw Error(`organization id does not match expected value. Expected: ${r}. Found: ${a.organizationId}.`);if(!a.encappedPublic)throw Error('missing "encappedPublic" in bundle signed data');let l=iy(a.encappedPublic),c=iy(a.ciphertext),u=i_({ciphertextBuf:c,encappedKeyBuf:l,receiverPriv:t});if("SOLANA"===n&&!o){if(32!==u.length)throw Error(`invalid private key length. Expected 32 bytes. Got ${u.length}.`);let e=ns.getPublicKey(u);if(32!==e.length)throw Error(`invalid public key length. Expected 32 bytes. Got ${e.length}.`);let t=new Uint8Array(64);return t.set(u,0),t.set(e,32),iv.encode(t)}let f=id(u);return o?function(e){let t="";for(let r=0;r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}(f):f}catch(e){throw Error(`Error decrypting bundle: ${e}`)}},np=async(e,t,r)=>{let i=ny(iy(e));if(!i)throw Error("failed to load public key");let n=iQ(t),o=F(new TextEncoder().encode(r));return tn.verify(n,o,i.toHex())},nd=async(e,t,r,i)=>{if(e!=(i||iI))throw Error(`expected signer key ${i??iI} does not match signer key from bundle: ${e}`);let n=ny(new Uint8Array(iy(e)));if(!n)throw Error("failed to load quorum key");let o=iQ(t),s=F(iy(r));return tn.verify(o,s,n.toHex())},ny=e=>tn.ProjectivePoint.fromHex(id(e)),ng=async({privateKey:e,keyFormat:t,importBundle:r,userId:i,organizationId:n,dangerouslyOverrideSignerPublicKey:o})=>{let s=JSON.parse(r),a=((e,t)=>{switch(t){case"SOLANA":let r=iv.decode(e);if(64!==r.length)throw Error(`invalid key length. Expected 64 bytes. Got ${r.length}.`);return r.subarray(0,32);case"HEXADECIMAL":if(e.startsWith("0x"))return iy(e.slice(2));return iy(e);default:if(console.warn(`invalid key format: ${t}. Defaulting to HEXADECIMAL.`),e.startsWith("0x"))return iy(e.slice(2));return iy(e)}})(e,t);if(!await nd(s.enclaveQuorumPublic,s.dataSignature,s.data,o))throw Error(`failed to verify enclave signature: ${r}`);let l=JSON.parse(new TextDecoder().decode(iy(s.data)));if(!l.organizationId||l.organizationId!==n)throw Error(`organization id does not match expected value. Expected: ${n}. Found: ${l.organizationId}.`);if(!l.userId||l.userId!==i)throw Error(`user id does not match expected value. Expected: ${i}. Found: ${l.userId}.`);if(!l.targetPublic)throw Error('missing "targetPublic" in bundle signed data');return iL(iR({plainTextBuf:a,targetKeyBuf:iy(l.targetPublic)}))},nv=async({mnemonic:e,importBundle:t,userId:r,organizationId:i,dangerouslyOverrideSignerPublicKey:n})=>{let o=JSON.parse(t),s=new TextEncoder().encode(e);if(!await nd(o.enclaveQuorumPublic,o.dataSignature,o.data,n))throw Error(`failed to verify enclave signature: ${t}`);let a=JSON.parse(new TextDecoder().decode(iy(o.data)));if(!a.organizationId||a.organizationId!==i)throw Error(`organization id does not match expected value. Expected: ${i}. Found: ${a.organizationId}.`);if(!a.userId||a.userId!==r)throw Error(`user id does not match expected value. Expected: ${r}. Found: ${a.userId}.`);if(!a.targetPublic)throw Error('missing "targetPublic" in bundle signed data');return iL(iR({plainTextBuf:s,targetKeyBuf:iy(a.targetPublic)}))},nm=async(e,t)=>{let r,[i,n,o]=e.split(".");if(!o)throw Error("invalid JWT: need 3 parts");let s=`${i}.${n}`,a=F(new TextEncoder().encode(s)),l=F(a),c=Uint8Array.from(atob((r=(r=o).replace(/-/g,"+").replace(/_/g,"/")).padEnd(r.length+(4-r.length%4)%4,"=")).split("").map(e=>e.charCodeAt(0))),u=iy(t??"04d498aa87ac3bf982ac2b5dd9604d0074905cfbda5d62727c5a237b895e6749205e9f7cd566909c4387f6ca25c308445c60884b788560b785f4a96ac33702a469");return tn.verify(c,l,u)},nb=async(e,t)=>await iD(iy(e),new TextEncoder().encode(t)),nw=async(e,t)=>id(await nb(t??"045e899f1fcf7d12b3c8fd997a7a43bb853dd4e8d63419a8f867c70aacc1c4cf9d04848baca41f0c85ffbbd23cbf78967501cd8eca9e4a6369370a9a38f70d13c0",e)),nA=(e,t)=>im.encode(iR({plainTextBuf:new TextEncoder().encode(e),targetKeyBuf:iF(iy(t??"02336ebd7e929ef64b87c776b72540255b4c7b41579a24b1e68fb060daa873f9f6"))}));e.s(["Enclave",()=>rs,"decryptCredentialBundle",()=>nf,"decryptExportBundle",()=>nh,"encryptOauth2ClientSecret",()=>nw,"encryptOnRampSecret",()=>nA,"encryptPrivateKeyToBundle",()=>ng,"encryptToEnclave",()=>nb,"encryptWalletToBundle",()=>nv,"verifySessionJwtSignature",()=>nm,"verifyStampSignature",()=>np],784503);var nS=e.i(649347);e.i(964495);var nx=e.i(630376);function nB(e,t){let r=0;if(1===e.length)return e[0];for(let i=e.length-1;i>=0;i--)r+=e[e.length-1-i]*Math.pow(2,t*i);return r}function nE(e,t,r=-1){let i=e,n=0,o=Math.pow(2,t);for(let s=1;s<8;s++){if(e<o){let e;if(r<0)e=new ArrayBuffer(s),n=s;else{if(r<s)return new ArrayBuffer(0);e=new ArrayBuffer(r),n=r}let o=new Uint8Array(e);for(let e=s-1;e>=0;e--){let r=Math.pow(2,e*t);o[n-e-1]=Math.floor(i/r),i-=o[n-e-1]*r}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function nk(...e){let t=0,r=0;for(let r of e)t+=r.length;let i=new Uint8Array(new ArrayBuffer(t));for(let t of e)i.set(t,r),r+=t.length;return i}function nC(){let e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){let t=255===e[0]&&128&e[1],r=0===e[0]&&(128&e[1])==0;(t||r)&&this.warnings.push("Needlessly long format")}let t=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let e=0;e<this.valueHex.byteLength;e++)t[e]=0;t[0]=128&e[0];let r=nB(t,8),i=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let t=0;t<this.valueHex.byteLength;t++)i[t]=e[t];return i[0]&=127,nB(i,8)-r}function nO(e,t){let r=e.toString(10);if(t<r.length)return"";let i=t-r.length,n=Array(i);for(let e=0;e<i;e++)n[e]="0";return n.join("").concat(r)}function nI(){if("undefined"==typeof BigInt)throw Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function nN(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;let i=new Uint8Array(t);for(let t=0;t<e.length;t++){let n=e[t];i.set(new Uint8Array(n),r),r+=n.byteLength}return i.buffer}function nT(e,t,r,i){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):i<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-i<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class nU{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return nN(this.items)}}let nj=[new Uint8Array([1])],nR="0123456789",nP="name",nD="valueHexView",nL=new ArrayBuffer(0),n_=new Uint8Array(0),nH="EndOfContent",nV="OCTET STRING",nM="BIT STRING";function n$(e){var t;return(t=class extends e{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!=(t=r.isHexOnly)&&t,this.valueHexView=r.valueHex?nx.BufferSourceConverter.toUint8Array(r.valueHex):n_}fromBER(e,t,r){let i=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!nT(this,i,t,r))return -1;let n=t+r;return(this.valueHexView=i.subarray(t,n),this.valueHexView.length)?(this.blockLength=r,n):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",nL)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:nx.Convert.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class nF{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:i=n_}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=nx.BufferSourceConverter.toUint8Array(i)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:nx.Convert.ToHex(this.valueBeforeDecodeView)}}}nF.NAME="baseBlock";class nz extends nF{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}nz.NAME="valueBlock";class nq extends n$(nF){constructor({idBlock:e={}}={}){var t,r,i,n;super(),e?(this.isHexOnly=null!=(t=e.isHexOnly)&&t,this.valueHexView=e.valueHex?nx.BufferSourceConverter.toUint8Array(e.valueHex):n_,this.tagClass=null!=(r=e.tagClass)?r:-1,this.tagNumber=null!=(i=e.tagNumber)?i:-1,this.isConstructed=null!=(n=e.isConstructed)&&n):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",nL}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){let r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){let r=nE(this.tagNumber,7),i=new Uint8Array(r),n=r.byteLength,o=new Uint8Array(n+1);if(o[0]=31|t,!e){for(let e=0;e<n-1;e++)o[e+1]=128|i[e];o[n]=i[n-1]}return o.buffer}let r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){let e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){let i=nx.BufferSourceConverter.toUint8Array(e);if(!nT(this,i,t,r))return -1;let n=i.subarray(t,t+r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(32&n[0])==32,this.isHexOnly=!1;let o=31&n[0];if(31!==o)this.tagNumber=o,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&n[e];){if(t[e-1]=127&n[e],++e>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){let e=new Uint8Array(r+=255);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&n[e];let i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t[r];(t=this.valueHexView=new Uint8Array(e)).set(i),this.blockLength<=9?this.tagNumber=nB(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}nq.NAME="identificationBlock";class nK extends nF{constructor({lenBlock:e={}}={}){var t,r,i;super(),this.isIndefiniteForm=null!=(t=e.isIndefiniteForm)&&t,this.longFormUsed=null!=(r=e.longFormUsed)&&r,this.length=null!=(i=e.length)?i:0}fromBER(e,t,r){let i=nx.BufferSourceConverter.toUint8Array(e);if(!nT(this,i,t,r))return -1;let n=i.subarray(t,t+r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;let o=127&n[0];if(o>8)return this.error="Too big integer",-1;if(o+1>n.length)return this.error="End of input reached before message was fully decoded",-1;let s=t+1,a=i.subarray(s,s+o);return 0===a[o-1]&&this.warnings.push("Needlessly long encoded length"),this.length=nB(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=128),t;if(this.longFormUsed){let i=nE(this.length,8);if(i.byteLength>127)return this.error="Too big length",nL;if(t=new ArrayBuffer(i.byteLength+1),e)return t;let n=new Uint8Array(i);(r=new Uint8Array(t))[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=n[e];return t}return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}nK.NAME="lengthBlock";let nW={};class nG extends nF{constructor({name:e="",optional:t=!1,primitiveSchema:r,...i}={},n){super(i),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new nq(i),this.lenBlock=new nK(i),this.valueBlock=n?new n(i):new nz(i)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}toBER(e,t){let r=t||new nU;t||function e(t){var r;if(t instanceof nW.Constructed)for(let r of t.valueBlock.value)e(r)&&(t.lenBlock.isIndefiniteForm=!0);return!!(null==(r=t.lenBlock)?void 0:r.isIndefiniteForm)}(this);let i=this.idBlock.toBER(e);if(r.write(i),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{let t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;let i=this.lenBlock.toBER(e);r.write(i),r.write(t)}return t?nL:r.final()}toJSON(){let e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():nx.Convert.ToHex(this.toBER())}onAsciiEncoding(){let e=this.constructor.NAME,t=nx.Convert.ToHex(this.valueBlock.valueBeforeDecodeView);return`${e} : ${t}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;let t=this.toBER(),r=e.toBER();if(t.byteLength!==r.byteLength)return!1;let i=new Uint8Array(t),n=new Uint8Array(r);for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1;return!0}}nG.NAME="BaseBlock";class nZ extends nG{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}nZ.NAME="BaseStringBlock";class nJ extends n$(nz){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}nJ.NAME="PrimitiveValueBlock";class nY extends nG{constructor(e={}){super(e,nJ),this.idBlock.isConstructed=!1}}function nQ(e,t=0,r=e.length){let i=t,n=new nG({},nz),o=new nF;if(!nT(o,e,t,r))return n.error=o.error,{offset:-1,result:n};if(!e.subarray(t,t+r).length)return n.error="Zero buffer length",{offset:-1,result:n};let s=n.idBlock.fromBER(e,t,r);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),-1===s)return n.error=n.idBlock.error,{offset:-1,result:n};if(t=s,r-=n.idBlock.blockLength,s=n.lenBlock.fromBER(e,t,r),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),-1===s)return n.error=n.lenBlock.error,{offset:-1,result:n};if(t=s,r-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let a=nG;if(1===n.idBlock.tagClass){if(n.idBlock.tagNumber>=37&&!1===n.idBlock.isHexOnly)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};a=nW.EndOfContent;break;case 1:a=nW.Boolean;break;case 2:a=nW.Integer;break;case 3:a=nW.BitString;break;case 4:a=nW.OctetString;break;case 5:a=nW.Null;break;case 6:a=nW.ObjectIdentifier;break;case 10:a=nW.Enumerated;break;case 12:a=nW.Utf8String;break;case 13:a=nW.RelativeObjectIdentifier;break;case 14:a=nW.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:a=nW.Sequence;break;case 17:a=nW.Set;break;case 18:a=nW.NumericString;break;case 19:a=nW.PrintableString;break;case 20:a=nW.TeletexString;break;case 21:a=nW.VideotexString;break;case 22:a=nW.IA5String;break;case 23:a=nW.UTCTime;break;case 24:a=nW.GeneralizedTime;break;case 25:a=nW.GraphicString;break;case 26:a=nW.VisibleString;break;case 27:a=nW.GeneralString;break;case 28:a=nW.UniversalString;break;case 29:a=nW.CharacterString;break;case 30:a=nW.BmpString;break;case 31:a=nW.DATE;break;case 32:a=nW.TimeOfDay;break;case 33:a=nW.DateTime;break;case 34:a=nW.Duration;break;default:{let e=n.idBlock.isConstructed?new nW.Constructed:new nW.Primitive;e.idBlock=n.idBlock,e.lenBlock=n.lenBlock,e.warnings=n.warnings,n=e}}}else a=n.idBlock.isConstructed?nW.Constructed:nW.Primitive;return s=(n=function(e,t){if(e instanceof t)return e;let r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(n,a)).fromBER(e,t,n.lenBlock.isIndefiniteForm?r:n.lenBlock.length),n.valueBeforeDecodeView=e.subarray(i,i+n.blockLength),{offset:s,result:n}}function nX(e){if(!e.byteLength){let e=new nG({},nz);return e.error="Input buffer has zero length",{offset:-1,result:e}}return nQ(nx.BufferSourceConverter.toUint8Array(e).slice(),0,e.byteLength)}nW.Primitive=nY,nY.NAME="PRIMITIVE";class n0 extends nz{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){var i,n;let o=nx.BufferSourceConverter.toUint8Array(e);if(!nT(this,o,t,r))return -1;if(this.valueBeforeDecodeView=o.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let s=t;for(;i=this.isIndefiniteForm,n=r,(i?1:n)>0;){let e=nQ(o,s,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(s=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===nH)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===nH?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(e,t){let r=t||new nU;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?nL:r.final()}toJSON(){let e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let t of this.value)e.value.push(t.toJSON());return e}}n0.NAME="ConstructedValueBlock";class n1 extends nG{constructor(e={}){super(e,n0),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){let e=[];for(let t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map(e=>`  ${e}`).join("\n"));let t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join("\n")}`:`${t} :`}}nW.Constructed=n1,n1.NAME="CONSTRUCTED";class n2 extends nz{fromBER(e,t,r){return t}toBER(e){return nL}}n2.override="EndOfContentValueBlock";class n8 extends nG{constructor(e={}){super(e,n2),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}nW.EndOfContent=n8,n8.NAME=nH;class n3 extends nG{constructor(e={}){super(e,nz),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return(this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength)?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){let r=new ArrayBuffer(2);if(!e){let e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}nW.Null=n3,n3.NAME="NULL";class n6 extends n$(nz){get value(){for(let e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=255*!!e}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=nx.BufferSourceConverter.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){let i=nx.BufferSourceConverter.toUint8Array(e);return nT(this,i,t,r)?(this.valueHexView=i.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,nC.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}n6.NAME="BooleanValueBlock";class n4 extends nG{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,n6),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}nW.Boolean=n4,n4.NAME="BOOLEAN";class n5 extends n$(n0){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,-1===(i=n0.prototype.fromBER.call(this,e,t,r)))return i;for(let e=0;e<this.value.length;e++){let t=this.value[e].constructor.NAME;if(t===nH)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1;else break;if(t!==nV)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(e,t,r),this.blockLength=r;return i}toBER(e,t){return this.isConstructed?n0.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}n5.NAME="OctetStringValueBlock";class n9 extends nG{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},n5),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){let i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(i.byteLength){let e=nQ(i,0,i.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return n1.prototype.onAsciiEncoding.call(this);let e=this.constructor.NAME,t=nx.Convert.ToHex(this.valueBlock.valueHexView);return`${e} : ${t}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let e=[];for(let t of this.valueBlock.value)t instanceof ra&&e.push(t.valueBlock.valueHexView);return nx.BufferSourceConverter.concat(e)}}nW.OctetString=ra=n9,n9.NAME=nV;class n7 extends n$(n0){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let i=-1;if(this.isConstructed){if(-1===(i=n0.prototype.fromBER.call(this,e,t,r)))return i;for(let e of this.value){let t=e.constructor.NAME;if(t===nH)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1;else break;if(t!==nM)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return i}let n=nx.BufferSourceConverter.toUint8Array(e);if(!nT(this,n,t,r))return -1;let o=n.subarray(t,t+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let e=o.subarray(1);try{if(e.byteLength){let t=nQ(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch{}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+r}toBER(e,t){if(this.isConstructed)return n0.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength){let e=new Uint8Array(1);return e[0]=0,e.buffer}let r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}n7.NAME="BitStringValueBlock";class oe extends nG{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},n7),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return n1.prototype.onAsciiEncoding.call(this);{let e=[];for(let t of this.valueBlock.valueHexView)e.push(t.toString(2).padStart(8,"0"));let t=e.join(""),r=this.constructor.NAME,i=t.substring(0,t.length-this.valueBlock.unusedBits);return`${r} : ${i}`}}}function ot(e){if(e>=nj.length)for(let t=nj.length;t<=e;t++){let e=new Uint8Array([0]),r=nj[t-1].slice(0);for(let t=r.length-1;t>=0;t--){let i=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=i[0]/10,r[t]=i[0]%10}e[0]>0&&(r=nk(e,r)),nj.push(r)}return nj[e]}nW.BitString=oe,oe.NAME=nM;class or extends n$(nz){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=nC.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){let t=e<0?-1*e:e,r=128;for(let i=1;i<8;i++){if(t<=r){if(e<0){let e=nE(r-t,8,i),n=new Uint8Array(e);return n[0]|=128,e}let n=nE(t,8,i),o=new Uint8Array(n);if(128&o[0]){let e=n.slice(0),t=new Uint8Array(e);o=new Uint8Array(n=new ArrayBuffer(n.byteLength+1));for(let r=0;r<e.byteLength;r++)o[r+1]=t[r];o[0]=0}return n}r*=256}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,i=0){let n=this.fromBER(e,t,r);if(-1===n)return n;let o=this.valueHexView;return 0===o[0]&&(128&o[1])!=0?this.valueHexView=o.subarray(1):0!==i&&o.length<i&&(i-o.length>1&&(i=o.length+1),this.valueHexView=o.subarray(i-o.length)),n}toDER(e=!1){let t=this.valueHexView;switch(!0){case(128&t[0])!=0:{let e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&(128&t[1])==0:this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){let i=super.fromBER(e,t,r);return -1===i||this.setValueHex(),i}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let e,t=8*this.valueHexView.length-1,r=new Uint8Array(8*this.valueHexView.length/3),i=0,n=this.valueHexView,o="",s=!1;for(let s=n.byteLength-1;s>=0;s--){e=n[s];for(let n=0;n<8;n++)(1&e)==1&&(i===t?(r=function(e,t){let r,i=0,n=new Uint8Array(e),o=new Uint8Array(t),s=n.slice(0),a=s.length-1,l=o.slice(0),c=l.length-1,u=0;for(let e=c;e>=0;e--,u++)!0==(r=s[a-u]-l[c-u]-i)<0?(i=1,s[a-u]=r+10):(i=0,s[a-u]=r);if(i>0)for(let e=a-c+1;e>=0;e--,u++)if((r=s[a-u]-i)<0)i=1,s[a-u]=r+10;else{i=0,s[a-u]=r;break}return s.slice()}(ot(i),r),o="-"):r=function(e,t){let r=new Uint8Array([0]),i=new Uint8Array(e),n=new Uint8Array(t),o=i.slice(0),s=o.length-1,a=n.slice(0),l=a.length-1,c=0,u=l<s?s:l,f=0;for(let e=u;e>=0;e--,f++)c=!0==f<a.length?o[s-f]+a[l-f]+r[0]:o[s-f]+r[0],r[0]=c/10,!0==f>=o.length?o=nk(new Uint8Array([c%10]),o):o[s-f]=c%10;return r[0]>0&&(o=nk(r,o)),o}(r,ot(i))),i++,e>>=1}for(let e=0;e<r.length;e++)r[e]&&(s=!0),s&&(o+=nR.charAt(r[e]));return!1===s&&(o+=nR.charAt(0)),o}}or.NAME="IntegerValueBlock",Object.defineProperty(or.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class oi extends nG{constructor(e={}){super(e,or),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return nI(),BigInt(this.valueBlock.toString())}static fromBigInt(e){nI();let t=BigInt(e),r=new nU,i=t.toString(16).replace(/^-/,""),n=new Uint8Array(nx.Convert.FromHex(i));if(t<0){let e=new Uint8Array(n.length+(128&n[0]?1:0));e[0]|=128;let i=BigInt(`0x${nx.Convert.ToHex(e)}`)+t,o=nx.BufferSourceConverter.toUint8Array(nx.Convert.FromHex(i.toString(16)));o[0]|=128,r.write(o)}else 128&n[0]&&r.write(new Uint8Array([0])),r.write(n);return new rl({valueHex:r.final()})}convertToDER(){let e=new rl({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new rl({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}nW.Integer=rl=oi,oi.NAME="INTEGER";class on extends oi{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}nW.Enumerated=on,on.NAME="ENUMERATED";class oo extends n$(nz){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;let i=nx.BufferSourceConverter.toUint8Array(e);if(!nT(this,i,t,r))return -1;let n=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&n[e],this.blockLength++,(128&n[e])!=0);e++);let o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return(this.valueHexView=o,(128&n[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=nB(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){nI();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;let r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+128*(e+1<r.length);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=nE(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",nL;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r}toString(){let e="";if(this.isHexOnly)e=nx.Convert.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}oo.NAME="sidBlock";class os extends nz{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new oo;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e){let t=[];for(let r=0;r<this.value.length;r++){let i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,nL;t.push(i)}return nN(t)}fromString(e){this.value=[];let t=0,r=0,i="",n=!1;do if(i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1,n){let e=this.value[0],t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:this.value=[];return}let r=parseInt(i,10);if(isNaN(r))return;e.valueDec=r+t,n=!1}else{let e=new oo;if(i>Number.MAX_SAFE_INTEGER)nI(),e.valueBigInt=BigInt(i);else if(e.valueDec=parseInt(i,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,n=!0),this.value.push(e)}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,this.value[r].isFirstSid?e=`2.{${i} - 80}`:e+=i):e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}os.NAME="ObjectIdentifierValueBlock";class oa extends nG{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,os),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}nW.ObjectIdentifier=oa,oa.NAME="OBJECT IDENTIFIER";class ol extends n$(nF){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;let i=nx.BufferSourceConverter.toUint8Array(e);if(!nT(this,i,t,r))return -1;let n=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&n[e],this.blockLength++,(128&n[e])!=0);e++);let o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return(this.valueHexView=o,(128&n[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=nB(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=nE(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",nL;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r.buffer}toString(){return this.isHexOnly?nx.Convert.ToHex(this.valueHexView):this.valueDec.toString()}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}ol.NAME="relativeSidBlock";class oc extends nz{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new ol;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e,t){let r=[];for(let t=0;t<this.value.length;t++){let i=this.value[t].toBER(e);if(0===i.byteLength)return this.error=this.value[t].error,nL;r.push(i)}return nN(r)}fromString(e){this.value=[];let t=0,r=0,i="";do{i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1;let n=new ol;if(n.valueDec=parseInt(i,10),isNaN(n.valueDec))break;this.value.push(n)}while(-1!==r)return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?e+=i=`{${i}}`:e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}oc.NAME="RelativeObjectIdentifierValueBlock";class ou extends nG{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,oc),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}nW.RelativeObjectIdentifier=ou,ou.NAME="RelativeObjectIdentifier";class of extends n1{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}nW.Sequence=of,of.NAME="SEQUENCE";class oh extends n1{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}nW.Set=oh,oh.NAME="SET";class op extends n$(nz){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}op.NAME="StringValueBlock";class od extends op{}od.NAME="SimpleStringValueBlock";class oy extends nZ{constructor({...e}={}){super(e,od)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,nx.BufferSourceConverter.toUint8Array(e))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);this.valueBlock.value=e}}oy.NAME="SIMPLE STRING";class og extends oy{fromBuffer(e){this.valueBlock.valueHexView=nx.BufferSourceConverter.toUint8Array(e);try{this.valueBlock.value=nx.Convert.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=nx.Convert.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(nx.Convert.FromUtf8String(e)),this.valueBlock.value=e}}og.NAME="Utf8StringValueBlock";class ov extends og{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}nW.Utf8String=ov,ov.NAME="UTF8String";class om extends oy{fromBuffer(e){this.valueBlock.value=nx.Convert.ToUtf16String(e),this.valueBlock.valueHexView=nx.BufferSourceConverter.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(nx.Convert.FromUtf16String(e))}}om.NAME="BmpStringValueBlock";class ob extends om{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}nW.BmpString=ob,ob.NAME="BMPString";class ow extends oy{fromBuffer(e){let t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let i=0;i<t;i++){let t=new Uint8Array(nE(e.charCodeAt(i),8));if(t.length>4)continue;let n=4-t.length;for(let e=t.length-1;e>=0;e--)r[4*i+e+n]=t[e]}this.valueBlock.value=e}}ow.NAME="UniversalStringValueBlock";class oA extends ow{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}nW.UniversalString=oA,oA.NAME="UniversalString";class oS extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}nW.NumericString=oS,oS.NAME="NumericString";class ox extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}nW.PrintableString=ox,ox.NAME="PrintableString";class oB extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}nW.TeletexString=oB,oB.NAME="TeletexString";class oE extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}nW.VideotexString=oE,oE.NAME="VideotexString";class ok extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}nW.IA5String=ok,ok.NAME="IA5String";class oC extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}nW.GraphicString=oC,oC.NAME="GraphicString";class oO extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}nW.VisibleString=oO,oO.NAME="VisibleString";class oI extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}nW.GeneralString=oI,oI.NAME="GeneralString";class oN extends oy{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}nW.CharacterString=oN,oN.NAME="CharacterString";class oT extends oO{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,nx.BufferSourceConverter.toUint8Array(e)))}toBuffer(){let e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){let t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(null===t){this.error="Wrong input string for conversion";return}let r=parseInt(t[1],10);r>=50?this.year=1900+r:this.year=2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){let e=Array(7);return e[0]=nO(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=nO(this.month,2),e[2]=nO(this.day,2),e[3]=nO(this.hour,2),e[4]=nO(this.minute,2),e[5]=nO(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}nW.UTCTime=oT,oT.NAME="UTCTime";class oU extends oT{constructor(e={}){super(e),null!=this.millisecond||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,i="",n="",o=0,s=0,a=0;if("Z"===e[e.length-1])i=e.substring(0,e.length-1),r=!0;else{if(isNaN(new Number(e[e.length-1]).valueOf()))throw Error("Wrong input string for conversion");i=e}if(r){if(-1!==i.indexOf("+")||-1!==i.indexOf("-"))throw Error("Wrong input string for conversion")}else{let e=1,t=i.indexOf("+"),r="";if(-1===t&&(t=i.indexOf("-"),e=-1),-1!==t){if(r=i.substring(t+1),i=i.substring(0,t),2!==r.length&&4!==r.length)throw Error("Wrong input string for conversion");let n=parseInt(r.substring(0,2),10);if(isNaN(n.valueOf()))throw Error("Wrong input string for conversion");if(s=e*n,4===r.length){if(isNaN((n=parseInt(r.substring(2,4),10)).valueOf()))throw Error("Wrong input string for conversion");a=e*n}}}let l=i.indexOf(".");if(-1===l&&(l=i.indexOf(",")),-1!==l){let e=new Number(`0${i.substring(l)}`);if(isNaN(e.valueOf()))throw Error("Wrong input string for conversion");o=e.valueOf(),n=i.substring(0,l)}else n=i;switch(!0){case 8===n.length:if(t=/(\d{4})(\d{2})(\d{2})/ig,-1!==l)throw Error("Wrong input string for conversion");break;case 10===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw Error("Wrong input string for conversion")}let c=t.exec(n);if(null===c)throw Error("Wrong input string for conversion");for(let e=1;e<c.length;e++)switch(e){case 1:this.year=parseInt(c[e],10);break;case 2:this.month=parseInt(c[e],10);break;case 3:this.day=parseInt(c[e],10);break;case 4:this.hour=parseInt(c[e],10)+s;break;case 5:this.minute=parseInt(c[e],10)+a;break;case 6:this.second=parseInt(c[e],10);break;default:throw Error("Wrong input string for conversion")}if(!1===r){let e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){let e=[];return e.push(nO(this.year,4)),e.push(nO(this.month,2)),e.push(nO(this.day,2)),e.push(nO(this.hour,2)),e.push(nO(this.minute,2)),e.push(nO(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(nO(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}nW.GeneralizedTime=oU,oU.NAME="GeneralizedTime";class oj extends ov{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}nW.DATE=oj,oj.NAME="DATE";class oR extends ov{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}nW.TimeOfDay=oR,oR.NAME="TimeOfDay";class oP extends ov{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}nW.DateTime=oP,oP.NAME="DateTime";class oD extends ov{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}nW.Duration=oD,oD.NAME="Duration";class oL extends ov{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}nW.TIME=oL,oL.NAME="TIME";class o_{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class oH extends o_{constructor({value:e=[],...t}={}){super(t),this.value=e}}class oV extends o_{constructor({value:e=new o_,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class oM{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=nx.BufferSourceConverter.toUint8Array(e)}constructor({data:e=n_}={}){this.dataView=nx.BufferSourceConverter.toUint8Array(e)}fromBER(e,t,r){let i=t+r;return this.dataView=nx.BufferSourceConverter.toUint8Array(e).subarray(t,i),i}toBER(e){return this.dataView.slice().buffer}}function o$(e,t,r){if(r instanceof oH){for(let i of r.value)if(o$(e,t,i).verified)return{verified:!0,result:e};{let e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(nP)&&(e.name=r.name),e}}if(r instanceof o_)return r.hasOwnProperty(nP)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1||"idBlock"in r==!1||"fromBER"in r.idBlock==!1||"toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(nD in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.valueHexView,n=t.idBlock.valueHexView;if(i.length!==n.length)return{verified:!1,result:e};for(let t=0;t<i.length;t++)if(i[t]!==n[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(e[r.name]=t)),r instanceof nW.Constructed){let i=0,n={verified:!1,result:{error:"Unknown error"}},o=r.valueBlock.value.length;if(o>0&&r.valueBlock.value[0]instanceof oV&&(o=t.valueBlock.value.length),0===o)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let s=0;s<o;s++)if(s-i>=t.valueBlock.value.length){if(!1===r.valueBlock.value[s].optional){let t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof oV){if(!1===(n=o$(e,t.valueBlock.value[s],r.valueBlock.value[0].value)).verified)if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),n;else i++;if(nP in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let i={};void 0===(i="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e)[r.valueBlock.value[0].name]&&(i[r.valueBlock.value[0].name]=[]),i[r.valueBlock.value[0].name].push(t.valueBlock.value[s])}}else if(!1===(n=o$(e,t.valueBlock.value[s-i],r.valueBlock.value[s])).verified)if(!r.valueBlock.value[s].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),n;else i++;if(!1===n.verified){let t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&nD in t.valueBlock){let i=nQ(t.valueBlock.valueHexView);if(-1===i.offset){let t={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return o$(e,i.result,r.primitiveSchema)}return{verified:!0,result:e}}function oF(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let r=nQ(nx.BufferSourceConverter.toUint8Array(e));return -1===r.offset?{verified:!1,result:r.result}:o$(r.result,r.result,t)}e.s(["Any",()=>o_,"BaseBlock",()=>nG,"BaseStringBlock",()=>nZ,"BitString",()=>oe,"BmpString",()=>ob,"Boolean",()=>n4,"CharacterString",()=>oN,"Choice",()=>oH,"Constructed",()=>n1,"DATE",()=>oj,"DateTime",()=>oP,"Duration",()=>oD,"EndOfContent",()=>n8,"Enumerated",()=>on,"GeneralString",()=>oI,"GeneralizedTime",()=>oU,"GraphicString",()=>oC,"HexBlock",()=>n$,"IA5String",()=>ok,"Integer",()=>oi,"Null",()=>n3,"NumericString",()=>oS,"ObjectIdentifier",()=>oa,"OctetString",()=>n9,"Primitive",()=>nY,"PrintableString",()=>ox,"RawData",()=>oM,"RelativeObjectIdentifier",()=>ou,"Repeated",()=>oV,"Sequence",()=>of,"Set",()=>oh,"TIME",()=>oL,"TeletexString",()=>oB,"TimeOfDay",()=>oR,"UTCTime",()=>oT,"UniversalString",()=>oA,"Utf8String",()=>ov,"ValueBlock",()=>nz,"VideotexString",()=>oE,"ViewWriter",()=>nU,"VisibleString",()=>oO,"compareSchema",()=>o$,"fromBER",()=>nX,"verifySchema",()=>oF],60922),(tX=rc||(rc={}))[tX.Sequence=0]="Sequence",tX[tX.Set=1]="Set",tX[tX.Choice=2]="Choice",(t0=ru||(ru={}))[t0.Any=1]="Any",t0[t0.Boolean=2]="Boolean",t0[t0.OctetString=3]="OctetString",t0[t0.BitString=4]="BitString",t0[t0.Integer=5]="Integer",t0[t0.Enumerated=6]="Enumerated",t0[t0.ObjectIdentifier=7]="ObjectIdentifier",t0[t0.Utf8String=8]="Utf8String",t0[t0.BmpString=9]="BmpString",t0[t0.UniversalString=10]="UniversalString",t0[t0.NumericString=11]="NumericString",t0[t0.PrintableString=12]="PrintableString",t0[t0.TeletexString=13]="TeletexString",t0[t0.VideotexString=14]="VideotexString",t0[t0.IA5String=15]="IA5String",t0[t0.GraphicString=16]="GraphicString",t0[t0.VisibleString=17]="VisibleString",t0[t0.GeneralString=18]="GeneralString",t0[t0.CharacterString=19]="CharacterString",t0[t0.UTCTime=20]="UTCTime",t0[t0.GeneralizedTime=21]="GeneralizedTime",t0[t0.DATE=22]="DATE",t0[t0.TimeOfDay=23]="TimeOfDay",t0[t0.DateTime=24]="DateTime",t0[t0.Duration=25]="Duration",t0[t0.TIME=26]="TIME",t0[t0.Null=27]="Null";class oz{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else if(nx.BufferSourceConverter.isBufferSource(e))this.unusedBits=t,this.value=nx.BufferSourceConverter.toArrayBuffer(e);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(e){if(!(e instanceof oe))throw TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new oe({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new oe({name:e})}toNumber(){let e="";for(let t of new Uint8Array(this.value))e+=t.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2),r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;let i=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let n=0;for(;n<r;)i[n]=parseInt(t.slice(n<<3,(n<<3)+8),2),n++;this.value=i.buffer}}class oq{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):nx.BufferSourceConverter.isBufferSource(e)?this.buffer=nx.BufferSourceConverter.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof n9))throw TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new n9({valueHex:this.buffer})}toSchema(e){return new n9({name:e})}}let oK={fromASN:e=>e instanceof n3?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new n3;let t=nX(e);if(t.result.error)throw Error(t.result.error);return t.result}},oW={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new oi({value:+e})},oG={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new on({value:e})},oZ={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new oi({valueHex:e})},oJ={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new oe({valueHex:e})},oY={fromASN:e=>e.valueBlock.toString(),toASN:e=>new oa({value:e})},oQ={fromASN:e=>e.valueBlock.value,toASN:e=>new n4({value:e})},oX={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new n9({valueHex:e})};function o0(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}let o1=o0(ov),o2=o0(ob),o8=o0(oA),o3=o0(oS),o6=o0(ox),o4=o0(oB),o5=o0(oE),o9=o0(ok),o7=o0(oC),se=o0(oO),st=o0(oI),sr=o0(oN),si={fromASN:e=>e.toDate(),toASN:e=>new oT({valueDate:e})},sn={fromASN:e=>e.toDate(),toASN:e=>new oU({valueDate:e})},so={fromASN:()=>null,toASN:()=>new n3};function ss(e){switch(e){case ru.Any:return oK;case ru.BitString:return oJ;case ru.BmpString:return o2;case ru.Boolean:return oQ;case ru.CharacterString:return sr;case ru.Enumerated:return oG;case ru.GeneralString:return st;case ru.GeneralizedTime:return sn;case ru.GraphicString:return o7;case ru.IA5String:return o9;case ru.Integer:return oW;case ru.Null:return so;case ru.NumericString:return o3;case ru.ObjectIdentifier:return oY;case ru.OctetString:return oX;case ru.PrintableString:return o6;case ru.TeletexString:return o4;case ru.UTCTime:return si;case ru.UniversalString:return o8;case ru.Utf8String:return o1;case ru.VideotexString:return o5;case ru.VisibleString:return se;default:return null}}var sa=e.i(60922);function sl(e){return"function"==typeof e&&e.prototype?!!e.prototype.toASN&&!!e.prototype.fromASN||sl(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}let sc=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){let r=this.items.get(e);if(!r)throw Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){let t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){let t={type:rc.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){let r=this.items.get(e)||this.createDefault(e),i=[];for(let e in r.items){let n,o=r.items[e],s=t?e:"";if("number"==typeof o.type){let e=ru[o.type],t=sa[e];if(!t)throw Error(`Cannot get ASN1 class by name '${e}'`);n=new t({name:s})}else sl(o.type)?n=new o.type().toSchema(s):o.optional?this.get(o.type).type===rc.Choice?n=new sa.Any({name:s}):(n=this.create(o.type,!1)).name=s:n=new sa.Any({name:s});let a=!!o.optional||void 0!==o.defaultValue;if(o.repeated&&(n.name="",n=new("set"===o.repeated?sa.Set:sa.Sequence)({name:"",value:[new sa.Repeated({name:s,value:n})]})),null!==o.context&&void 0!==o.context)if(o.implicit)if("number"==typeof o.type||sl(o.type)){let e=o.repeated?sa.Constructed:sa.Primitive;i.push(new e({name:s,optional:a,idBlock:{tagClass:3,tagNumber:o.context}}))}else{this.cache(o.type);let e=!!o.repeated,t=e?n:this.get(o.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,i.push(new sa.Constructed({name:e?"":s,optional:a,idBlock:{tagClass:3,tagNumber:o.context},value:t}))}else i.push(new sa.Constructed({optional:a,idBlock:{tagClass:3,tagNumber:o.context},value:[n]}));else n.optional=a,i.push(n)}switch(r.type){case rc.Sequence:return new sa.Sequence({value:i,name:""});case rc.Set:return new sa.Set({value:i,name:""});case rc.Choice:return new sa.Choice({value:i,name:""});default:throw Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){let t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}},su=e=>t=>{let r;sc.has(t)?r=sc.get(t):(r=sc.createDefault(t),sc.set(t,r)),Object.assign(r,e)},sf=e=>(t,r)=>{let i;sc.has(t.constructor)?i=sc.get(t.constructor):(i=sc.createDefault(t.constructor),sc.set(t.constructor,i));let n=Object.assign({},e);if("number"==typeof n.type&&!n.converter){let i=ss(e.type);if(!i)throw Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);n.converter=i}n.raw=e.raw,i.items[r]=n};class sh extends Error{constructor(){super(...arguments),this.schemas=[]}}class sp{static parse(e,t){let r=sa.fromBER(e);if(r.result.error)throw Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(e,t){try{if(sl(t))return new t().fromASN(e);let r=sc.get(t);sc.cache(t);let i=r.schema,n=this.handleChoiceTypes(e,r,t,i);if(null==n?void 0:n.result)return n.result;(null==n?void 0:n.targetSchema)&&(i=n.targetSchema);let o=this.handleSequenceTypes(e,r,t,i),s=new t;if(function e(t){var r;if(t){let i=Object.getPrototypeOf(t);return(null==(r=null==i?void 0:i.prototype)?void 0:r.constructor)===Array||e(i)}return!1}(t))return this.handleArrayTypes(e,r,t);return this.processSchemaItems(r,o,s),s}catch(e){throw e instanceof sh&&e.schemas.push(t.name),e}}static handleChoiceTypes(e,t,r,i){if(e.constructor===sa.Constructed&&t.type===rc.Choice&&3===e.idBlock.tagClass)for(let i in t.items){let n=t.items[i];if(n.context===e.idBlock.tagNumber&&n.implicit&&"function"==typeof n.type&&sc.has(n.type)){let t=sc.get(n.type);if(t&&t.type===rc.Sequence){let t=new sa.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock){t.valueBlock.value=e.valueBlock.value;let o=this.fromASN(t,n.type),s=new r;return s[i]=o,{result:s}}}}}else if(e.constructor===sa.Constructed&&t.type!==rc.Choice){let r=new sa.Constructed({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:t.schema.valueBlock.value});for(let r in t.items)delete e[r];return{targetSchema:r}}return null}static handleSequenceTypes(e,t,r,i){if(t.type===rc.Sequence){let t=sa.compareSchema({},e,i);if(!t.verified)throw new sh(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}{let t=sa.compareSchema({},e,i);if(!t.verified)throw new sh(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}}static processRepeatedField(e,t,r){let i=e.slice(t);if(1===i.length&&"Sequence"===i[0].constructor.name){let e=i[0];e.valueBlock&&e.valueBlock.value&&Array.isArray(e.valueBlock.value)&&(i=e.valueBlock.value)}if("number"!=typeof r.type)return i.filter(e=>e&&e.valueBlock).map(e=>{try{return this.fromASN(e,r.type)}catch{return}}).filter(e=>void 0!==e);{let e=ss(r.type);if(!e)throw Error(`No converter for ASN.1 type ${r.type}`);return i.filter(e=>e&&e.valueBlock).map(t=>{try{return e.fromASN(t)}catch{return}}).filter(e=>void 0!==e)}}static processPrimitiveField(e,t){let r=ss(t.type);if(!r)throw Error(`No converter for ASN.1 type ${t.type}`);return r.fromASN(e)}static isOptionalChoiceField(e){return e.optional&&"function"==typeof e.type&&sc.has(e.type)&&sc.get(e.type).type===rc.Choice}static processOptionalChoiceField(e,t){try{let r=this.fromASN(e,t.type);return{processed:!0,value:r}}catch(e){if(e instanceof sh&&/Wrong values for Choice type/.test(e.message))return{processed:!1};throw e}}static handleArrayTypes(e,t,r){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let i=t.itemType;if("number"!=typeof i)return r.from(e.valueBlock.value,e=>this.fromASN(e,i));{let t=ss(i);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(e.valueBlock.value,e=>t.fromASN(e))}}static processSchemaItems(e,t,r){for(let i in e.items){let n,o=t.result[i];if(!o)continue;let s=e.items[i],a=s.type;(n="number"==typeof a||sl(a)?this.processPrimitiveSchemaItem(o,s,a):this.processComplexSchemaItem(o,s,a))&&"object"==typeof n&&"value"in n&&"raw"in n?(r[i]=n.value,r[`${i}Raw`]=n.raw):r[i]=n}}static processPrimitiveSchemaItem(e,t,r){var i;let n=null!=(i=t.converter)?i:sl(r)?new r:null;if(!n)throw Error("Converter is empty");return t.repeated?this.processRepeatedPrimitiveItem(e,t,n):this.processSinglePrimitiveItem(e,t,r,n)}static processRepeatedPrimitiveItem(e,t,r){if(!t.implicit)return Array.from(e,e=>r.fromASN(e));{let i=new("sequence"===t.repeated?sa.Sequence:sa.Set);i.valueBlock=e.valueBlock;let n=sa.fromBER(i.toBER(!1));if(-1===n.offset)throw Error(`Cannot parse the child item. ${n.result.error}`);if(!("value"in n.result.valueBlock&&Array.isArray(n.result.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");return Array.from(n.result.valueBlock.value,e=>r.fromASN(e))}}static processSinglePrimitiveItem(e,t,r,i){let n=e;if(t.implicit){let e;if(sl(r))e=new r().toSchema("");else{let t=ru[r],i=sa[t];if(!i)throw Error(`Cannot get '${t}' class from asn1js module`);e=new i}e.valueBlock=n.valueBlock,n=sa.fromBER(e.toBER(!1)).result}return i.fromASN(n)}static processComplexSchemaItem(e,t,r){if(t.repeated){if(!Array.isArray(e))throw Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(e,e=>this.fromASN(e,r))}{let i=this.handleImplicitTagging(e,t,r);if(this.isOptionalChoiceField(t))try{return this.fromASN(i,r)}catch(e){if(e instanceof sh&&/Wrong values for Choice type/.test(e.message))return;throw e}{let n=this.fromASN(i,r);return t.raw?{value:n,raw:e.valueBeforeDecodeView}:n}}}static handleImplicitTagging(e,t,r){if(t.implicit&&"number"==typeof t.context){let t=sc.get(r);if(t.type===rc.Sequence){let t=new sa.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}else if(t.type===rc.Set){let t=new sa.Set;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}}return e}}class sd{static serialize(e){return e instanceof nG?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){let t;if(e&&"object"==typeof e&&sl(e))return e.toASN();if(!(e&&"object"==typeof e))throw TypeError("Parameter 1 should be type of Object.");let r=e.constructor,i=sc.get(r);sc.cache(r);let n=[];if(i.itemType){if(!Array.isArray(e))throw TypeError("Parameter 1 should be type of Array.");if("number"==typeof i.itemType){let t=ss(i.itemType);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);n=e.map(e=>t.toASN(e))}else n=e.map(e=>this.toAsnItem({type:i.itemType},"[]",r,e))}else for(let t in i.items){let o=i.items[t],s=e[t];if(void 0===s||o.defaultValue===s||"object"==typeof o.defaultValue&&"object"==typeof s&&function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}(this.serialize(o.defaultValue),this.serialize(s)))continue;let a=sd.toAsnItem(o,t,r,s);if("number"==typeof o.context)if(o.implicit)if(!o.repeated&&("number"==typeof o.type||sl(o.type))){let e={};e.valueHex=a instanceof n3?a.valueBeforeDecodeView:a.valueBlock.toBER(),n.push(new nY({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},...e}))}else n.push(new n1({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:a.valueBlock.value}));else n.push(new n1({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:[a]}));else o.repeated?n=n.concat(a):n.push(a)}switch(i.type){case rc.Sequence:t=new of({value:n});break;case rc.Set:t=new oh({value:n});break;case rc.Choice:if(!n[0])throw Error(`Schema '${r.name}' has wrong data. Choice cannot be empty.`);t=n[0]}return t}static toAsnItem(e,t,r,i){let n;if("number"==typeof e.type){let o=e.converter;if(!o)throw Error(`Property '${t}' doesn't have converter for type ${ru[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>o.toASN(e));n=new("sequence"===e.repeated?of:oh)({value:t})}else n=o.toASN(i)}else if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>this.toASN(e));n=new("sequence"===e.repeated?of:oh)({value:t})}else n=this.toASN(i);return n}}class sy extends Array{constructor(e=[]){if("number"==typeof e)super(e);else for(const t of(super(),e))this.push(t)}}class sg{static serialize(e){return sd.serialize(e)}static parse(e,t){return sp.parse(e,t)}static toString(e){let t=nX(nx.BufferSourceConverter.isBufferSource(e)?nx.BufferSourceConverter.toArrayBuffer(e):sg.serialize(e));if(-1===t.offset)throw Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}function sv(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}"function"==typeof SuppressedError&&SuppressedError;class sm{static isIPv4(e){return/^(\d{1,3}\.){3}\d{1,3}$/.test(e)}static parseIPv4(e){let t=e.split(".");if(4!==t.length)throw Error("Invalid IPv4 address");return t.map(e=>{let t=parseInt(e,10);if(isNaN(t)||t<0||t>255)throw Error("Invalid IPv4 address part");return t})}static parseIPv6(e){let t=this.expandIPv6(e).split(":");if(8!==t.length)throw Error("Invalid IPv6 address");return t.reduce((e,t)=>{let r=parseInt(t,16);if(isNaN(r)||r<0||r>65535)throw Error("Invalid IPv6 address part");return e.push(r>>8&255),e.push(255&r),e},[])}static expandIPv6(e){if(!e.includes("::"))return e;let t=e.split("::");if(t.length>2)throw Error("Invalid IPv6 address");let r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[],n=8-(r.length+i.length);if(n<0)throw Error("Invalid IPv6 address");return[...r,...Array(n).fill("0"),...i].join(":")}static formatIPv6(e){let t=[];for(let r=0;r<16;r+=2)t.push((e[r]<<8|e[r+1]).toString(16));return this.compressIPv6(t.join(":"))}static compressIPv6(e){let t=e.split(":"),r=-1,i=0,n=-1,o=0;for(let e=0;e<t.length;e++)"0"===t[e]?(-1===n&&(n=e),o++):(o>i&&(r=n,i=o),n=-1,o=0);if(o>i&&(r=n,i=o),i>1){let e=t.slice(0,r).join(":"),n=t.slice(r+i).join(":");return`${e}::${n}`}return e}static parseCIDR(e){let[t,r]=e.split("/"),i=parseInt(r,10);if(this.isIPv4(t)){if(i<0||i>32)throw Error("Invalid IPv4 prefix length");return[this.parseIPv4(t),i]}if(i<0||i>128)throw Error("Invalid IPv6 prefix length");return[this.parseIPv6(t),i]}static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;let t=parseInt(e.slice(8),16).toString(2).split("").reduce((e,t)=>e+ +t,0),r=e.slice(0,8).replace(/(.{2})/g,e=>`${parseInt(e,16)}.`);return r=r.slice(0,-1),`${r}/${t}`}static toString(e){let t=new Uint8Array(e);if(4===t.length)return Array.from(t).join(".");if(16===t.length)return this.formatIPv6(t);if(8===t.length||32===t.length){let e=t.length/2,r=t.slice(0,e),i=t.slice(e);if(t.every(e=>0===e))return 8===t.length?"0.0.0.0/0":"::/0";let n=i.reduce((e,t)=>e+(t.toString(2).match(/1/g)||[]).length,0);if(8===t.length){let e=Array.from(r).join(".");return`${e}/${n}`}{let e=this.formatIPv6(r);return`${e}/${n}`}}return this.decodeIP(nx.Convert.ToHex(e))}static fromString(e){if(e.includes("/")){let[t,r]=this.parseCIDR(e),i=new Uint8Array(t.length),n=r;for(let e=0;e<i.length;e++)n>=8?(i[e]=255,n-=8):n>0&&(i[e]=255<<8-n,n=0);let o=new Uint8Array(2*t.length);return o.set(t,0),o.set(i,t.length),o.buffer}return new Uint8Array(this.isIPv4(e)?this.parseIPv4(e):this.parseIPv6(e)).buffer}}let sb=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};sv([sf({type:ru.TeletexString})],sb.prototype,"teletexString",void 0),sv([sf({type:ru.PrintableString})],sb.prototype,"printableString",void 0),sv([sf({type:ru.UniversalString})],sb.prototype,"universalString",void 0),sv([sf({type:ru.Utf8String})],sb.prototype,"utf8String",void 0),sv([sf({type:ru.BmpString})],sb.prototype,"bmpString",void 0),sb=sv([su({type:rc.Choice})],sb);let sw=class extends sb{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?nx.Convert.ToHex(this.anyValue):super.toString())}};sv([sf({type:ru.IA5String})],sw.prototype,"ia5String",void 0),sv([sf({type:ru.Any})],sw.prototype,"anyValue",void 0),sw=sv([su({type:rc.Choice})],sw);class sA{constructor(e={}){this.type="",this.value=new sw,Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],sA.prototype,"type",void 0),sv([sf({type:sw})],sA.prototype,"value",void 0);let sS=rf=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rf.prototype)}};sS=rf=sv([su({type:rc.Set,itemType:sA})],sS);let sx=rh=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rh.prototype)}};sx=rh=sv([su({type:rc.Sequence,itemType:sS})],sx);let sB=rp=class extends sx{constructor(e){super(e),Object.setPrototypeOf(this,rp.prototype)}};sB=rp=sv([su({type:rc.Sequence})],sB);class sE{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],sE.prototype,"typeId",void 0),sv([sf({type:ru.Any,context:0})],sE.prototype,"value",void 0);class sk{constructor(e={}){this.partyName=new sb,Object.assign(this,e)}}sv([sf({type:sb,optional:!0,context:0,implicit:!0})],sk.prototype,"nameAssigner",void 0),sv([sf({type:sb,context:1,implicit:!0})],sk.prototype,"partyName",void 0);let sC=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:sE,context:0,implicit:!0})],sC.prototype,"otherName",void 0),sv([sf({type:ru.IA5String,context:1,implicit:!0})],sC.prototype,"rfc822Name",void 0),sv([sf({type:ru.IA5String,context:2,implicit:!0})],sC.prototype,"dNSName",void 0),sv([sf({type:ru.Any,context:3,implicit:!0})],sC.prototype,"x400Address",void 0),sv([sf({type:sB,context:4,implicit:!1})],sC.prototype,"directoryName",void 0),sv([sf({type:sk,context:5})],sC.prototype,"ediPartyName",void 0),sv([sf({type:ru.IA5String,context:6,implicit:!0})],sC.prototype,"uniformResourceIdentifier",void 0),sv([sf({type:ru.OctetString,context:7,implicit:!0,converter:{fromASN:e=>sm.toString(oX.fromASN(e)),toASN:e=>oX.toASN(sm.fromString(e))}})],sC.prototype,"iPAddress",void 0),sv([sf({type:ru.ObjectIdentifier,context:8,implicit:!0})],sC.prototype,"registeredID",void 0),sC=sv([su({type:rc.Choice})],sC);let sO="1.3.6.1.5.5.7",sI=`${sO}.1`,sN=`${sO}.3`,sT=`${sO}.48`,sU=`${sT}.1`,sj=`${sT}.2`,sR=`${sT}.3`,sP=`${sT}.5`,sD="2.5.29",sL=`${sI}.1`;class s_{constructor(e={}){this.accessMethod="",this.accessLocation=new sC,Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],s_.prototype,"accessMethod",void 0),sv([sf({type:sC})],s_.prototype,"accessLocation",void 0);let sH=rd=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rd.prototype)}};sH=rd=sv([su({type:rc.Sequence,itemType:s_})],sH);let sV=`${sD}.35`;class sM extends oq{}class s${constructor(e={}){e&&Object.assign(this,e)}}sv([sf({type:sM,context:0,optional:!0,implicit:!0})],s$.prototype,"keyIdentifier",void 0),sv([sf({type:sC,context:1,optional:!0,implicit:!0,repeated:"sequence"})],s$.prototype,"authorityCertIssuer",void 0),sv([sf({type:ru.Integer,context:2,optional:!0,implicit:!0,converter:oZ})],s$.prototype,"authorityCertSerialNumber",void 0);let sF=`${sD}.19`;class sz{constructor(e={}){this.cA=!1,Object.assign(this,e)}}sv([sf({type:ru.Boolean,defaultValue:!1})],sz.prototype,"cA",void 0),sv([sf({type:ru.Integer,optional:!0})],sz.prototype,"pathLenConstraint",void 0);let sq=ry=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,ry.prototype)}};sq=ry=sv([su({type:rc.Sequence,itemType:sC})],sq);let sK=rg=class extends sq{constructor(e){super(e),Object.setPrototypeOf(this,rg.prototype)}};sK=rg=sv([su({type:rc.Sequence})],sK);let sW=`${sD}.32`,sG=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};sv([sf({type:ru.IA5String})],sG.prototype,"ia5String",void 0),sv([sf({type:ru.VisibleString})],sG.prototype,"visibleString",void 0),sv([sf({type:ru.BmpString})],sG.prototype,"bmpString",void 0),sv([sf({type:ru.Utf8String})],sG.prototype,"utf8String",void 0),sG=sv([su({type:rc.Choice})],sG);class sZ{constructor(e={}){this.organization=new sG,this.noticeNumbers=[],Object.assign(this,e)}}sv([sf({type:sG})],sZ.prototype,"organization",void 0),sv([sf({type:ru.Integer,repeated:"sequence"})],sZ.prototype,"noticeNumbers",void 0);class sJ{constructor(e={}){Object.assign(this,e)}}sv([sf({type:sZ,optional:!0})],sJ.prototype,"noticeRef",void 0),sv([sf({type:sG,optional:!0})],sJ.prototype,"explicitText",void 0);let sY=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:ru.IA5String})],sY.prototype,"cPSuri",void 0),sv([sf({type:sJ})],sY.prototype,"userNotice",void 0),sY=sv([su({type:rc.Choice})],sY);class sQ{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],sQ.prototype,"policyQualifierId",void 0),sv([sf({type:ru.Any})],sQ.prototype,"qualifier",void 0);class sX{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],sX.prototype,"policyIdentifier",void 0),sv([sf({type:sQ,repeated:"sequence",optional:!0})],sX.prototype,"policyQualifiers",void 0);let s0=rv=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rv.prototype)}};s0=rv=sv([su({type:rc.Sequence,itemType:sX})],s0);let s1=class{constructor(e=0){this.value=e}};sv([sf({type:ru.Integer})],s1.prototype,"value",void 0),s1=sv([su({type:rc.Choice})],s1);let s2=class extends s1{};s2=sv([su({type:rc.Choice})],s2);let s8=`${sD}.31`;(t1=rb||(rb={}))[t1.unused=1]="unused",t1[t1.keyCompromise=2]="keyCompromise",t1[t1.cACompromise=4]="cACompromise",t1[t1.affiliationChanged=8]="affiliationChanged",t1[t1.superseded=16]="superseded",t1[t1.cessationOfOperation=32]="cessationOfOperation",t1[t1.certificateHold=64]="certificateHold",t1[t1.privilegeWithdrawn=128]="privilegeWithdrawn",t1[t1.aACompromise=256]="aACompromise";class s3 extends oz{toJSON(){let e=[],t=this.toNumber();return t&rb.aACompromise&&e.push("aACompromise"),t&rb.affiliationChanged&&e.push("affiliationChanged"),t&rb.cACompromise&&e.push("cACompromise"),t&rb.certificateHold&&e.push("certificateHold"),t&rb.cessationOfOperation&&e.push("cessationOfOperation"),t&rb.keyCompromise&&e.push("keyCompromise"),t&rb.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&rb.superseded&&e.push("superseded"),t&rb.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let s6=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:sC,context:0,repeated:"sequence",implicit:!0})],s6.prototype,"fullName",void 0),sv([sf({type:sS,context:1,implicit:!0})],s6.prototype,"nameRelativeToCRLIssuer",void 0),s6=sv([su({type:rc.Choice})],s6);class s4{constructor(e={}){Object.assign(this,e)}}sv([sf({type:s6,context:0,optional:!0})],s4.prototype,"distributionPoint",void 0),sv([sf({type:s3,context:1,optional:!0,implicit:!0})],s4.prototype,"reasons",void 0),sv([sf({type:sC,context:2,optional:!0,repeated:"sequence",implicit:!0})],s4.prototype,"cRLIssuer",void 0);let s5=rm=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rm.prototype)}};s5=rm=sv([su({type:rc.Sequence,itemType:s4})],s5);let s9=rw=class extends s5{constructor(e){super(e),Object.setPrototypeOf(this,rw.prototype)}};s9=rw=sv([su({type:rc.Sequence,itemType:s4})],s9);class s7{constructor(e={}){this.onlyContainsUserCerts=s7.ONLY,this.onlyContainsCACerts=s7.ONLY,this.indirectCRL=s7.ONLY,this.onlyContainsAttributeCerts=s7.ONLY,Object.assign(this,e)}}s7.ONLY=!1,sv([sf({type:s6,context:0,optional:!0})],s7.prototype,"distributionPoint",void 0),sv([sf({type:ru.Boolean,context:1,defaultValue:s7.ONLY,implicit:!0})],s7.prototype,"onlyContainsUserCerts",void 0),sv([sf({type:ru.Boolean,context:2,defaultValue:s7.ONLY,implicit:!0})],s7.prototype,"onlyContainsCACerts",void 0),sv([sf({type:s3,context:3,optional:!0,implicit:!0})],s7.prototype,"onlySomeReasons",void 0),sv([sf({type:ru.Boolean,context:4,defaultValue:s7.ONLY,implicit:!0})],s7.prototype,"indirectCRL",void 0),sv([sf({type:ru.Boolean,context:5,defaultValue:s7.ONLY,implicit:!0})],s7.prototype,"onlyContainsAttributeCerts",void 0),(t2=rA||(rA={}))[t2.unspecified=0]="unspecified",t2[t2.keyCompromise=1]="keyCompromise",t2[t2.cACompromise=2]="cACompromise",t2[t2.affiliationChanged=3]="affiliationChanged",t2[t2.superseded=4]="superseded",t2[t2.cessationOfOperation=5]="cessationOfOperation",t2[t2.certificateHold=6]="certificateHold",t2[t2.removeFromCRL=8]="removeFromCRL",t2[t2.privilegeWithdrawn=9]="privilegeWithdrawn",t2[t2.aACompromise=10]="aACompromise";let ae=class{constructor(e=rA.unspecified){this.reason=rA.unspecified,this.reason=e}toJSON(){return rA[this.reason]}toString(){return this.toJSON()}};sv([sf({type:ru.Enumerated})],ae.prototype,"reason",void 0),ae=sv([su({type:rc.Choice})],ae);let at=`${sD}.37`,ar=rS=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rS.prototype)}};ar=rS=sv([su({type:rc.Sequence,itemType:ru.ObjectIdentifier})],ar);let ai=`${sN}.1`,an=`${sN}.2`,ao=`${sN}.3`,as=`${sN}.4`,aa=`${sN}.8`,al=`${sN}.9`,ac=class{constructor(e=new ArrayBuffer(0)){this.value=e}};sv([sf({type:ru.Integer,converter:oZ})],ac.prototype,"value",void 0),ac=sv([su({type:rc.Choice})],ac);let au=class{constructor(e){this.value=new Date,e&&(this.value=e)}};sv([sf({type:ru.GeneralizedTime})],au.prototype,"value",void 0),au=sv([su({type:rc.Choice})],au);let af=rx=class extends sq{constructor(e){super(e),Object.setPrototypeOf(this,rx.prototype)}};af=rx=sv([su({type:rc.Sequence})],af);let ah=`${sD}.15`;(t8=rB||(rB={}))[t8.digitalSignature=1]="digitalSignature",t8[t8.nonRepudiation=2]="nonRepudiation",t8[t8.keyEncipherment=4]="keyEncipherment",t8[t8.dataEncipherment=8]="dataEncipherment",t8[t8.keyAgreement=16]="keyAgreement",t8[t8.keyCertSign=32]="keyCertSign",t8[t8.cRLSign=64]="cRLSign",t8[t8.encipherOnly=128]="encipherOnly",t8[t8.decipherOnly=256]="decipherOnly";class ap extends oz{toJSON(){let e=this.toNumber(),t=[];return e&rB.cRLSign&&t.push("crlSign"),e&rB.dataEncipherment&&t.push("dataEncipherment"),e&rB.decipherOnly&&t.push("decipherOnly"),e&rB.digitalSignature&&t.push("digitalSignature"),e&rB.encipherOnly&&t.push("encipherOnly"),e&rB.keyAgreement&&t.push("keyAgreement"),e&rB.keyCertSign&&t.push("keyCertSign"),e&rB.keyEncipherment&&t.push("keyEncipherment"),e&rB.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class ad{constructor(e={}){this.base=new sC,this.minimum=0,Object.assign(this,e)}}sv([sf({type:sC})],ad.prototype,"base",void 0),sv([sf({type:ru.Integer,context:0,defaultValue:0,implicit:!0})],ad.prototype,"minimum",void 0),sv([sf({type:ru.Integer,context:1,optional:!0,implicit:!0})],ad.prototype,"maximum",void 0);let ay=rE=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rE.prototype)}};ay=rE=sv([su({type:rc.Sequence,itemType:ad})],ay);class ag{constructor(e={}){Object.assign(this,e)}}sv([sf({type:ay,context:0,optional:!0,implicit:!0})],ag.prototype,"permittedSubtrees",void 0),sv([sf({type:ay,context:1,optional:!0,implicit:!0})],ag.prototype,"excludedSubtrees",void 0);class av{constructor(e={}){Object.assign(this,e)}}sv([sf({type:ru.Integer,context:0,implicit:!0,optional:!0,converter:oZ})],av.prototype,"requireExplicitPolicy",void 0),sv([sf({type:ru.Integer,context:1,implicit:!0,optional:!0,converter:oZ})],av.prototype,"inhibitPolicyMapping",void 0);class am{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],am.prototype,"issuerDomainPolicy",void 0),sv([sf({type:ru.ObjectIdentifier})],am.prototype,"subjectDomainPolicy",void 0);let ab=rk=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rk.prototype)}};ab=rk=sv([su({type:rc.Sequence,itemType:am})],ab);let aw=`${sD}.17`,aA=rC=class extends sq{constructor(e){super(e),Object.setPrototypeOf(this,rC.prototype)}};aA=rC=sv([su({type:rc.Sequence})],aA);class aS{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],aS.prototype,"type",void 0),sv([sf({type:ru.Any,repeated:"set"})],aS.prototype,"values",void 0);let ax=rO=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rO.prototype)}};ax=rO=sv([su({type:rc.Sequence,itemType:aS})],ax);let aB=`${sD}.14`;class aE extends sM{}class ak{constructor(e={}){Object.assign(this,e)}}sv([sf({type:ru.GeneralizedTime,context:0,implicit:!0,optional:!0})],ak.prototype,"notBefore",void 0),sv([sf({type:ru.GeneralizedTime,context:1,implicit:!0,optional:!0})],ak.prototype,"notAfter",void 0),(t3=rI||(rI={}))[t3.keyUpdateAllowed=1]="keyUpdateAllowed",t3[t3.newExtensions=2]="newExtensions",t3[t3.pKIXCertificate=4]="pKIXCertificate";class aC extends oz{toJSON(){let e=[],t=this.toNumber();return t&rI.pKIXCertificate&&e.push("pKIXCertificate"),t&rI.newExtensions&&e.push("newExtensions"),t&rI.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class aO{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new aC,Object.assign(this,e)}}sv([sf({type:ru.GeneralString})],aO.prototype,"entrustVers",void 0),sv([sf({type:aC})],aO.prototype,"entrustInfoFlags",void 0);let aI=rN=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rN.prototype)}};aI=rN=sv([su({type:rc.Sequence,itemType:s_})],aI);class aN{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof aN&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&nx.isEqual(e.parameters,this.parameters)||e.parameters===this.parameters)}}sv([sf({type:ru.ObjectIdentifier})],aN.prototype,"algorithm",void 0),sv([sf({type:ru.Any,optional:!0})],aN.prototype,"parameters",void 0);class aT{constructor(e={}){this.algorithm=new aN,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:aN})],aT.prototype,"algorithm",void 0),sv([sf({type:ru.BitString})],aT.prototype,"subjectPublicKey",void 0);let aU=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){let e=this.utcTime||this.generalTime;if(!e)throw Error("Cannot get time from CHOICE object");return e}};sv([sf({type:ru.UTCTime})],aU.prototype,"utcTime",void 0),sv([sf({type:ru.GeneralizedTime})],aU.prototype,"generalTime",void 0),aU=sv([su({type:rc.Choice})],aU);class aj{constructor(e){this.notBefore=new aU(new Date),this.notAfter=new aU(new Date),e&&(this.notBefore=new aU(e.notBefore),this.notAfter=new aU(e.notAfter))}}sv([sf({type:aU})],aj.prototype,"notBefore",void 0),sv([sf({type:aU})],aj.prototype,"notAfter",void 0);class aR{constructor(e={}){this.extnID="",this.critical=aR.CRITICAL,this.extnValue=new oq,Object.assign(this,e)}}aR.CRITICAL=!1,sv([sf({type:ru.ObjectIdentifier})],aR.prototype,"extnID",void 0),sv([sf({type:ru.Boolean,defaultValue:aR.CRITICAL})],aR.prototype,"critical",void 0),sv([sf({type:oq})],aR.prototype,"extnValue",void 0);let aP=rT=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rT.prototype)}};aP=rT=sv([su({type:rc.Sequence,itemType:aR})],aP),(t6=rU||(rU={}))[t6.v1=0]="v1",t6[t6.v2=1]="v2",t6[t6.v3=2]="v3";class aD{constructor(e={}){this.version=rU.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new aN,this.issuer=new sB,this.validity=new aj,this.subject=new sB,this.subjectPublicKeyInfo=new aT,Object.assign(this,e)}}sv([sf({type:ru.Integer,context:0,defaultValue:rU.v1})],aD.prototype,"version",void 0),sv([sf({type:ru.Integer,converter:oZ})],aD.prototype,"serialNumber",void 0),sv([sf({type:aN})],aD.prototype,"signature",void 0),sv([sf({type:sB})],aD.prototype,"issuer",void 0),sv([sf({type:aj})],aD.prototype,"validity",void 0),sv([sf({type:sB})],aD.prototype,"subject",void 0),sv([sf({type:aT})],aD.prototype,"subjectPublicKeyInfo",void 0),sv([sf({type:ru.BitString,context:1,implicit:!0,optional:!0})],aD.prototype,"issuerUniqueID",void 0),sv([sf({type:ru.BitString,context:2,implicit:!0,optional:!0})],aD.prototype,"subjectUniqueID",void 0),sv([sf({type:aP,context:3,optional:!0})],aD.prototype,"extensions",void 0);class aL{constructor(e={}){this.tbsCertificate=new aD,this.signatureAlgorithm=new aN,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:aD,raw:!0})],aL.prototype,"tbsCertificate",void 0),sv([sf({type:aN})],aL.prototype,"signatureAlgorithm",void 0),sv([sf({type:ru.BitString})],aL.prototype,"signatureValue",void 0);class a_{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new aU,Object.assign(this,e)}}sv([sf({type:ru.Integer,converter:oZ})],a_.prototype,"userCertificate",void 0),sv([sf({type:aU})],a_.prototype,"revocationDate",void 0),sv([sf({type:aR,optional:!0,repeated:"sequence"})],a_.prototype,"crlEntryExtensions",void 0);class aH{constructor(e={}){this.signature=new aN,this.issuer=new sB,this.thisUpdate=new aU,Object.assign(this,e)}}sv([sf({type:ru.Integer,optional:!0})],aH.prototype,"version",void 0),sv([sf({type:aN})],aH.prototype,"signature",void 0),sv([sf({type:sB})],aH.prototype,"issuer",void 0),sv([sf({type:aU})],aH.prototype,"thisUpdate",void 0),sv([sf({type:aU,optional:!0})],aH.prototype,"nextUpdate",void 0),sv([sf({type:a_,repeated:"sequence",optional:!0})],aH.prototype,"revokedCertificates",void 0),sv([sf({type:aR,optional:!0,context:0,repeated:"sequence"})],aH.prototype,"crlExtensions",void 0);class aV{constructor(e={}){this.tbsCertList=new aH,this.signatureAlgorithm=new aN,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:aH,raw:!0})],aV.prototype,"tbsCertList",void 0),sv([sf({type:aN})],aV.prototype,"signatureAlgorithm",void 0),sv([sf({type:ru.BitString})],aV.prototype,"signature",void 0);class aM{constructor(e={}){this.issuer=new sB,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:sB})],aM.prototype,"issuer",void 0),sv([sf({type:ru.Integer,converter:oZ})],aM.prototype,"serialNumber",void 0);let a$=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:aE,context:0,implicit:!0})],a$.prototype,"subjectKeyIdentifier",void 0),sv([sf({type:aM})],a$.prototype,"issuerAndSerialNumber",void 0),a$=sv([su({type:rc.Choice})],a$),(t4=rj||(rj={}))[t4.v0=0]="v0",t4[t4.v1=1]="v1",t4[t4.v2=2]="v2",t4[t4.v3=3]="v3",t4[t4.v4=4]="v4",t4[t4.v5=5]="v5";let aF=class extends aN{};aF=sv([su({type:rc.Sequence})],aF);let az=class extends aN{};az=sv([su({type:rc.Sequence})],az);let aq=class extends aN{};aq=sv([su({type:rc.Sequence})],aq);let aK=class extends aN{};aK=sv([su({type:rc.Sequence})],aK);let aW=class extends aN{};aW=sv([su({type:rc.Sequence})],aW);let aG=class extends aN{};aG=sv([su({type:rc.Sequence})],aG);class aZ{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],aZ.prototype,"attrType",void 0),sv([sf({type:ru.Any,repeated:"set"})],aZ.prototype,"attrValues",void 0);class aJ{constructor(e={}){this.version=rj.v0,this.sid=new a$,this.digestAlgorithm=new aF,this.signatureAlgorithm=new az,this.signature=new oq,Object.assign(this,e)}}sv([sf({type:ru.Integer})],aJ.prototype,"version",void 0),sv([sf({type:a$})],aJ.prototype,"sid",void 0),sv([sf({type:aF})],aJ.prototype,"digestAlgorithm",void 0),sv([sf({type:aZ,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],aJ.prototype,"signedAttrs",void 0),sv([sf({type:az})],aJ.prototype,"signatureAlgorithm",void 0),sv([sf({type:oq})],aJ.prototype,"signature",void 0),sv([sf({type:aZ,repeated:"set",context:1,implicit:!0,optional:!0})],aJ.prototype,"unsignedAttrs",void 0);let aY=rR=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rR.prototype)}};aY=rR=sv([su({type:rc.Set,itemType:aJ})],aY);let aQ=class extends aJ{};aQ=sv([su({type:rc.Sequence})],aQ);let aX=class extends aU{};aX=sv([su({type:rc.Choice})],aX);class a0{constructor(e={}){this.acIssuer=new sC,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}sv([sf({type:sC})],a0.prototype,"acIssuer",void 0),sv([sf({type:ru.Integer})],a0.prototype,"acSerial",void 0),sv([sf({type:aS,repeated:"sequence"})],a0.prototype,"attrs",void 0);let a1=rP=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rP.prototype)}};a1=rP=sv([su({type:rc.Sequence,itemType:ru.ObjectIdentifier})],a1);class a2{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}sv([sf({type:ru.Integer,optional:!0})],a2.prototype,"pathLenConstraint",void 0),sv([sf({type:a1,implicit:!0,context:0,optional:!0})],a2.prototype,"permittedAttrs",void 0),sv([sf({type:a1,implicit:!0,context:1,optional:!0})],a2.prototype,"excludedAttrs",void 0),sv([sf({type:ru.Boolean,defaultValue:!0})],a2.prototype,"permitUnSpecified",void 0);class a8{constructor(e={}){this.issuer=new sq,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:sq})],a8.prototype,"issuer",void 0),sv([sf({type:ru.Integer,converter:oZ})],a8.prototype,"serial",void 0),sv([sf({type:ru.BitString,optional:!0})],a8.prototype,"issuerUID",void 0),(t5=rD||(rD={}))[t5.publicKey=0]="publicKey",t5[t5.publicKeyCert=1]="publicKeyCert",t5[t5.otherObjectTypes=2]="otherObjectTypes";class a3{constructor(e={}){this.digestedObjectType=rD.publicKey,this.digestAlgorithm=new aN,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.Enumerated})],a3.prototype,"digestedObjectType",void 0),sv([sf({type:ru.ObjectIdentifier,optional:!0})],a3.prototype,"otherObjectTypeID",void 0),sv([sf({type:aN})],a3.prototype,"digestAlgorithm",void 0),sv([sf({type:ru.BitString})],a3.prototype,"objectDigest",void 0);class a6{constructor(e={}){Object.assign(this,e)}}sv([sf({type:sq,optional:!0})],a6.prototype,"issuerName",void 0),sv([sf({type:a8,context:0,implicit:!0,optional:!0})],a6.prototype,"baseCertificateID",void 0),sv([sf({type:a3,context:1,implicit:!0,optional:!0})],a6.prototype,"objectDigestInfo",void 0);let a4=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:sC,repeated:"sequence"})],a4.prototype,"v1Form",void 0),sv([sf({type:a6,context:0,implicit:!0})],a4.prototype,"v2Form",void 0),a4=sv([su({type:rc.Choice})],a4);class a5{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}sv([sf({type:ru.GeneralizedTime})],a5.prototype,"notBeforeTime",void 0),sv([sf({type:ru.GeneralizedTime})],a5.prototype,"notAfterTime",void 0);class a9{constructor(e={}){Object.assign(this,e)}}sv([sf({type:a8,implicit:!0,context:0,optional:!0})],a9.prototype,"baseCertificateID",void 0),sv([sf({type:sq,implicit:!0,context:1,optional:!0})],a9.prototype,"entityName",void 0),sv([sf({type:a3,implicit:!0,context:2,optional:!0})],a9.prototype,"objectDigestInfo",void 0),(t9=rL||(rL={}))[t9.v2=1]="v2";class a7{constructor(e={}){this.version=rL.v2,this.holder=new a9,this.issuer=new a4,this.signature=new aN,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new a5,this.attributes=[],Object.assign(this,e)}}sv([sf({type:ru.Integer})],a7.prototype,"version",void 0),sv([sf({type:a9})],a7.prototype,"holder",void 0),sv([sf({type:a4})],a7.prototype,"issuer",void 0),sv([sf({type:aN})],a7.prototype,"signature",void 0),sv([sf({type:ru.Integer,converter:oZ})],a7.prototype,"serialNumber",void 0),sv([sf({type:a5})],a7.prototype,"attrCertValidityPeriod",void 0),sv([sf({type:aS,repeated:"sequence"})],a7.prototype,"attributes",void 0),sv([sf({type:ru.BitString,optional:!0})],a7.prototype,"issuerUniqueID",void 0),sv([sf({type:aP,optional:!0})],a7.prototype,"extensions",void 0);class le{constructor(e={}){this.acinfo=new a7,this.signatureAlgorithm=new aN,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:a7})],le.prototype,"acinfo",void 0),sv([sf({type:aN})],le.prototype,"signatureAlgorithm",void 0),sv([sf({type:ru.BitString})],le.prototype,"signatureValue",void 0),(t7=r_||(r_={}))[t7.unmarked=1]="unmarked",t7[t7.unclassified=2]="unclassified",t7[t7.restricted=4]="restricted",t7[t7.confidential=8]="confidential",t7[t7.secret=16]="secret",t7[t7.topSecret=32]="topSecret";class lt extends oz{}class lr{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier,implicit:!0,context:0})],lr.prototype,"type",void 0),sv([sf({type:ru.Any,implicit:!0,context:1})],lr.prototype,"value",void 0);class li{constructor(e={}){this.policyId="",this.classList=new lt(r_.unclassified),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],li.prototype,"policyId",void 0),sv([sf({type:lt,defaultValue:new lt(r_.unclassified)})],li.prototype,"classList",void 0),sv([sf({type:lr,repeated:"set"})],li.prototype,"securityCategories",void 0);class ln{constructor(e={}){Object.assign(this,e)}}sv([sf({type:oq})],ln.prototype,"cotets",void 0),sv([sf({type:ru.ObjectIdentifier})],ln.prototype,"oid",void 0),sv([sf({type:ru.Utf8String})],ln.prototype,"string",void 0);class lo{constructor(e={}){this.values=[],Object.assign(this,e)}}sv([sf({type:sq,implicit:!0,context:0,optional:!0})],lo.prototype,"policyAuthority",void 0),sv([sf({type:ln,repeated:"sequence"})],lo.prototype,"values",void 0);class ls{constructor(e={}){this.targetCertificate=new a8,Object.assign(this,e)}}sv([sf({type:a8})],ls.prototype,"targetCertificate",void 0),sv([sf({type:sC,optional:!0})],ls.prototype,"targetName",void 0),sv([sf({type:a3,optional:!0})],ls.prototype,"certDigestInfo",void 0);let la=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:sC,context:0,implicit:!0})],la.prototype,"targetName",void 0),sv([sf({type:sC,context:1,implicit:!0})],la.prototype,"targetGroup",void 0),sv([sf({type:ls,context:2,implicit:!0})],la.prototype,"targetCert",void 0),la=sv([su({type:rc.Choice})],la);let ll=rH=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rH.prototype)}};ll=rH=sv([su({type:rc.Sequence,itemType:la})],ll);let lc=rV=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rV.prototype)}};lc=rV=sv([su({type:rc.Sequence,itemType:ll})],lc);class lu{constructor(e={}){Object.assign(this,e)}}sv([sf({type:sq,implicit:!0,context:0,optional:!0})],lu.prototype,"roleAuthority",void 0),sv([sf({type:sC,implicit:!0,context:1})],lu.prototype,"roleName",void 0);class lf{constructor(e={}){this.service=new sC,this.ident=new sC,Object.assign(this,e)}}sv([sf({type:sC})],lf.prototype,"service",void 0),sv([sf({type:sC})],lf.prototype,"ident",void 0),sv([sf({type:oq,optional:!0})],lf.prototype,"authInfo",void 0);class lh{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],lh.prototype,"otherCertFormat",void 0),sv([sf({type:ru.Any})],lh.prototype,"otherCert",void 0);let lp=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:aL})],lp.prototype,"certificate",void 0),sv([sf({type:le,context:2,implicit:!0})],lp.prototype,"v2AttrCert",void 0),sv([sf({type:lh,context:3,implicit:!0})],lp.prototype,"other",void 0),lp=sv([su({type:rc.Choice})],lp);let ld=rM=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rM.prototype)}};ld=rM=sv([su({type:rc.Set,itemType:lp})],ld);class ly{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],ly.prototype,"contentType",void 0),sv([sf({type:ru.Any,context:0})],ly.prototype,"content",void 0);let lg=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:oq})],lg.prototype,"single",void 0),sv([sf({type:ru.Any})],lg.prototype,"any",void 0),lg=sv([su({type:rc.Choice})],lg);class lv{constructor(e={}){this.eContentType="",Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],lv.prototype,"eContentType",void 0),sv([sf({type:lg,context:0,optional:!0})],lv.prototype,"eContent",void 0);let lm=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:oq,context:0,implicit:!0,optional:!0})],lm.prototype,"value",void 0),sv([sf({type:oq,converter:{fromASN:e=>new oq(e.getValue()),toASN:e=>e.toASN()},context:0,implicit:!0,optional:!0,repeated:"sequence"})],lm.prototype,"constructedValue",void 0),lm=sv([su({type:rc.Choice})],lm);class lb{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new aK,Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],lb.prototype,"contentType",void 0),sv([sf({type:aK})],lb.prototype,"contentEncryptionAlgorithm",void 0),sv([sf({type:lm,optional:!0})],lb.prototype,"encryptedContent",void 0);class lw{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],lw.prototype,"keyAttrId",void 0),sv([sf({type:ru.Any,optional:!0})],lw.prototype,"keyAttr",void 0);class lA{constructor(e={}){this.subjectKeyIdentifier=new aE,Object.assign(this,e)}}sv([sf({type:aE})],lA.prototype,"subjectKeyIdentifier",void 0),sv([sf({type:ru.GeneralizedTime,optional:!0})],lA.prototype,"date",void 0),sv([sf({type:lw,optional:!0})],lA.prototype,"other",void 0);let lS=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:lA,context:0,implicit:!0,optional:!0})],lS.prototype,"rKeyId",void 0),sv([sf({type:aM,optional:!0})],lS.prototype,"issuerAndSerialNumber",void 0),lS=sv([su({type:rc.Choice})],lS);class lx{constructor(e={}){this.rid=new lS,this.encryptedKey=new oq,Object.assign(this,e)}}sv([sf({type:lS})],lx.prototype,"rid",void 0),sv([sf({type:oq})],lx.prototype,"encryptedKey",void 0);let lB=r$=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,r$.prototype)}};lB=r$=sv([su({type:rc.Sequence,itemType:lx})],lB);class lE{constructor(e={}){this.algorithm=new aN,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:aN})],lE.prototype,"algorithm",void 0),sv([sf({type:ru.BitString})],lE.prototype,"publicKey",void 0);let lk=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:aE,context:0,implicit:!0,optional:!0})],lk.prototype,"subjectKeyIdentifier",void 0),sv([sf({type:lE,context:1,implicit:!0,optional:!0})],lk.prototype,"originatorKey",void 0),sv([sf({type:aM,optional:!0})],lk.prototype,"issuerAndSerialNumber",void 0),lk=sv([su({type:rc.Choice})],lk);class lC{constructor(e={}){this.version=rj.v3,this.originator=new lk,this.keyEncryptionAlgorithm=new aq,this.recipientEncryptedKeys=new lB,Object.assign(this,e)}}sv([sf({type:ru.Integer})],lC.prototype,"version",void 0),sv([sf({type:lk,context:0})],lC.prototype,"originator",void 0),sv([sf({type:oq,context:1,optional:!0})],lC.prototype,"ukm",void 0),sv([sf({type:aq})],lC.prototype,"keyEncryptionAlgorithm",void 0),sv([sf({type:lB})],lC.prototype,"recipientEncryptedKeys",void 0);let lO=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:aE,context:0,implicit:!0})],lO.prototype,"subjectKeyIdentifier",void 0),sv([sf({type:aM})],lO.prototype,"issuerAndSerialNumber",void 0),lO=sv([su({type:rc.Choice})],lO);class lI{constructor(e={}){this.version=rj.v0,this.rid=new lO,this.keyEncryptionAlgorithm=new aq,this.encryptedKey=new oq,Object.assign(this,e)}}sv([sf({type:ru.Integer})],lI.prototype,"version",void 0),sv([sf({type:lO})],lI.prototype,"rid",void 0),sv([sf({type:aq})],lI.prototype,"keyEncryptionAlgorithm",void 0),sv([sf({type:oq})],lI.prototype,"encryptedKey",void 0);class lN{constructor(e={}){this.keyIdentifier=new oq,Object.assign(this,e)}}sv([sf({type:oq})],lN.prototype,"keyIdentifier",void 0),sv([sf({type:ru.GeneralizedTime,optional:!0})],lN.prototype,"date",void 0),sv([sf({type:lw,optional:!0})],lN.prototype,"other",void 0);class lT{constructor(e={}){this.version=rj.v4,this.kekid=new lN,this.keyEncryptionAlgorithm=new aq,this.encryptedKey=new oq,Object.assign(this,e)}}sv([sf({type:ru.Integer})],lT.prototype,"version",void 0),sv([sf({type:lN})],lT.prototype,"kekid",void 0),sv([sf({type:aq})],lT.prototype,"keyEncryptionAlgorithm",void 0),sv([sf({type:oq})],lT.prototype,"encryptedKey",void 0);class lU{constructor(e={}){this.version=rj.v0,this.keyEncryptionAlgorithm=new aq,this.encryptedKey=new oq,Object.assign(this,e)}}sv([sf({type:ru.Integer})],lU.prototype,"version",void 0),sv([sf({type:aG,context:0,optional:!0})],lU.prototype,"keyDerivationAlgorithm",void 0),sv([sf({type:aq})],lU.prototype,"keyEncryptionAlgorithm",void 0),sv([sf({type:oq})],lU.prototype,"encryptedKey",void 0);class lj{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],lj.prototype,"oriType",void 0),sv([sf({type:ru.Any})],lj.prototype,"oriValue",void 0);let lR=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:lI,optional:!0})],lR.prototype,"ktri",void 0),sv([sf({type:lC,context:1,implicit:!0,optional:!0})],lR.prototype,"kari",void 0),sv([sf({type:lT,context:2,implicit:!0,optional:!0})],lR.prototype,"kekri",void 0),sv([sf({type:lU,context:3,implicit:!0,optional:!0})],lR.prototype,"pwri",void 0),sv([sf({type:lj,context:4,implicit:!0,optional:!0})],lR.prototype,"ori",void 0),lR=sv([su({type:rc.Choice})],lR);let lP=rF=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rF.prototype)}};lP=rF=sv([su({type:rc.Set,itemType:lR})],lP);class lD{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],lD.prototype,"otherRevInfoFormat",void 0),sv([sf({type:ru.Any})],lD.prototype,"otherRevInfo",void 0);let lL=class{constructor(e={}){this.other=new lD,Object.assign(this,e)}};sv([sf({type:lD,context:1,implicit:!0})],lL.prototype,"other",void 0),lL=sv([su({type:rc.Choice})],lL);let l_=rz=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rz.prototype)}};l_=rz=sv([su({type:rc.Set,itemType:lL})],l_);class lH{constructor(e={}){Object.assign(this,e)}}sv([sf({type:ld,context:0,implicit:!0,optional:!0})],lH.prototype,"certs",void 0),sv([sf({type:l_,context:1,implicit:!0,optional:!0})],lH.prototype,"crls",void 0);let lV=rq=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rq.prototype)}};lV=rq=sv([su({type:rc.Set,itemType:aZ})],lV);class lM{constructor(e={}){this.version=rj.v0,this.recipientInfos=new lP,this.encryptedContentInfo=new lb,Object.assign(this,e)}}sv([sf({type:ru.Integer})],lM.prototype,"version",void 0),sv([sf({type:lH,context:0,implicit:!0,optional:!0})],lM.prototype,"originatorInfo",void 0),sv([sf({type:lP})],lM.prototype,"recipientInfos",void 0),sv([sf({type:lb})],lM.prototype,"encryptedContentInfo",void 0),sv([sf({type:lV,context:1,implicit:!0,optional:!0})],lM.prototype,"unprotectedAttrs",void 0);let l$="1.2.840.113549.1.7.2",lF=rK=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rK.prototype)}};lF=rK=sv([su({type:rc.Set,itemType:aF})],lF);class lz{constructor(e={}){this.version=rj.v0,this.digestAlgorithms=new lF,this.encapContentInfo=new lv,this.signerInfos=new aY,Object.assign(this,e)}}sv([sf({type:ru.Integer})],lz.prototype,"version",void 0),sv([sf({type:lF})],lz.prototype,"digestAlgorithms",void 0),sv([sf({type:lv})],lz.prototype,"encapContentInfo",void 0),sv([sf({type:ld,context:0,implicit:!0,optional:!0})],lz.prototype,"certificates",void 0),sv([sf({type:l_,context:1,implicit:!0,optional:!0})],lz.prototype,"crls",void 0),sv([sf({type:aY})],lz.prototype,"signerInfos",void 0);let lq="1.2.840.10045.2.1",lK="1.2.840.10045.4.1",lW="1.2.840.10045.4.3.1",lG="1.2.840.10045.4.3.2",lZ="1.2.840.10045.4.3.3",lJ="1.2.840.10045.4.3.4",lY="1.2.840.10045.3.1.7",lQ="1.3.132.0.34",lX="1.3.132.0.35";function l0(e){return new aN({algorithm:e})}let l1=l0(lK);l0(lW);let l2=l0(lG),l8=l0(lZ),l3=l0(lJ),l6=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:ru.ObjectIdentifier})],l6.prototype,"fieldType",void 0),sv([sf({type:ru.Any})],l6.prototype,"parameters",void 0),l6=sv([su({type:rc.Sequence})],l6);let l4=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:ru.OctetString})],l4.prototype,"a",void 0),sv([sf({type:ru.OctetString})],l4.prototype,"b",void 0),sv([sf({type:ru.BitString,optional:!0})],l4.prototype,"seed",void 0),l4=sv([su({type:rc.Sequence})],l4),(re=rW||(rW={}))[re.ecpVer1=1]="ecpVer1";let l5=class{constructor(e={}){this.version=rW.ecpVer1,Object.assign(this,e)}};sv([sf({type:ru.Integer})],l5.prototype,"version",void 0),sv([sf({type:l6})],l5.prototype,"fieldID",void 0),sv([sf({type:l4})],l5.prototype,"curve",void 0),sv([sf({type:class extends oq{}})],l5.prototype,"base",void 0),sv([sf({type:ru.Integer,converter:oZ})],l5.prototype,"order",void 0),sv([sf({type:ru.Integer,optional:!0})],l5.prototype,"cofactor",void 0),l5=sv([su({type:rc.Sequence})],l5);let l9=class{constructor(e={}){Object.assign(this,e)}};sv([sf({type:ru.ObjectIdentifier})],l9.prototype,"namedCurve",void 0),sv([sf({type:ru.Null})],l9.prototype,"implicitCurve",void 0),sv([sf({type:l5})],l9.prototype,"specifiedCurve",void 0),l9=sv([su({type:rc.Choice})],l9);class l7{constructor(e={}){this.version=1,this.privateKey=new oq,Object.assign(this,e)}}sv([sf({type:ru.Integer})],l7.prototype,"version",void 0),sv([sf({type:oq})],l7.prototype,"privateKey",void 0),sv([sf({type:l9,context:0,optional:!0})],l7.prototype,"parameters",void 0),sv([sf({type:ru.BitString,context:1,optional:!0})],l7.prototype,"publicKey",void 0);class ce{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.Integer,converter:oZ})],ce.prototype,"r",void 0),sv([sf({type:ru.Integer,converter:oZ})],ce.prototype,"s",void 0);let ct="1.2.840.113549.1.1",cr=`${ct}.1`,ci=`${ct}.7`,cn=`${ct}.9`,co=`${ct}.10`,cs=`${ct}.2`,ca=`${ct}.4`,cl=`${ct}.5`,cc=`${ct}.14`,cu=`${ct}.11`,cf=`${ct}.12`,ch=`${ct}.13`,cp=`${ct}.15`,cd=`${ct}.16`,cy="1.3.14.3.2.26",cg="2.16.840.1.101.3.4.2.4",cv="2.16.840.1.101.3.4.2.1",cm="2.16.840.1.101.3.4.2.2",cb="2.16.840.1.101.3.4.2.3",cw=`${ct}.8`;function cA(e){return new aN({algorithm:e,parameters:null})}cA("1.2.840.113549.2.2"),cA("1.2.840.113549.2.5");let cS=cA(cy);cA(cg),cA(cv),cA(cm),cA(cb),cA("2.16.840.1.101.3.4.2.5"),cA("2.16.840.1.101.3.4.2.6");let cx=new aN({algorithm:cw,parameters:sg.serialize(cS)}),cB=new aN({algorithm:cn,parameters:sg.serialize(oX.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});cA(cr),cA(cs),cA(ca),cA(cl),cA(cp),cA(cd),cA(cf),cA(ch),cA(cp),cA(cd);class cE{constructor(e={}){this.hashAlgorithm=new aN(cS),this.maskGenAlgorithm=new aN({algorithm:cw,parameters:sg.serialize(cS)}),this.pSourceAlgorithm=new aN(cB),Object.assign(this,e)}}sv([sf({type:aN,context:0,defaultValue:cS})],cE.prototype,"hashAlgorithm",void 0),sv([sf({type:aN,context:1,defaultValue:cx})],cE.prototype,"maskGenAlgorithm",void 0),sv([sf({type:aN,context:2,defaultValue:cB})],cE.prototype,"pSourceAlgorithm",void 0),new aN({algorithm:ci,parameters:sg.serialize(new cE)});class ck{constructor(e={}){this.hashAlgorithm=new aN(cS),this.maskGenAlgorithm=new aN({algorithm:cw,parameters:sg.serialize(cS)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}sv([sf({type:aN,context:0,defaultValue:cS})],ck.prototype,"hashAlgorithm",void 0),sv([sf({type:aN,context:1,defaultValue:cx})],ck.prototype,"maskGenAlgorithm",void 0),sv([sf({type:ru.Integer,context:2,defaultValue:20})],ck.prototype,"saltLength",void 0),sv([sf({type:ru.Integer,context:3,defaultValue:1})],ck.prototype,"trailerField",void 0),new aN({algorithm:co,parameters:sg.serialize(new ck)});class cC{constructor(e={}){this.digestAlgorithm=new aN,this.digest=new oq,Object.assign(this,e)}}sv([sf({type:aN})],cC.prototype,"digestAlgorithm",void 0),sv([sf({type:oq})],cC.prototype,"digest",void 0);class cO{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.Integer,converter:oZ})],cO.prototype,"prime",void 0),sv([sf({type:ru.Integer,converter:oZ})],cO.prototype,"exponent",void 0),sv([sf({type:ru.Integer,converter:oZ})],cO.prototype,"coefficient",void 0);let cI=rG=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rG.prototype)}};cI=rG=sv([su({type:rc.Sequence,itemType:cO})],cI);class cN{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.Integer})],cN.prototype,"version",void 0),sv([sf({type:ru.Integer,converter:oZ})],cN.prototype,"modulus",void 0),sv([sf({type:ru.Integer,converter:oZ})],cN.prototype,"publicExponent",void 0),sv([sf({type:ru.Integer,converter:oZ})],cN.prototype,"privateExponent",void 0),sv([sf({type:ru.Integer,converter:oZ})],cN.prototype,"prime1",void 0),sv([sf({type:ru.Integer,converter:oZ})],cN.prototype,"prime2",void 0),sv([sf({type:ru.Integer,converter:oZ})],cN.prototype,"exponent1",void 0),sv([sf({type:ru.Integer,converter:oZ})],cN.prototype,"exponent2",void 0),sv([sf({type:ru.Integer,converter:oZ})],cN.prototype,"coefficient",void 0),sv([sf({type:cI,optional:!0})],cN.prototype,"otherPrimeInfos",void 0);class cT{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.Integer,converter:oZ})],cT.prototype,"modulus",void 0),sv([sf({type:ru.Integer,converter:oZ})],cT.prototype,"publicExponent",void 0),(rt=rZ||(rZ={}))[rt.Transient=0]="Transient",rt[rt.Singleton=1]="Singleton",rt[rt.ResolutionScoped=2]="ResolutionScoped",rt[rt.ContainerScoped=3]="ContainerScoped";let cU=rZ;var cj=function(e,t){return(cj=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function cR(e,t){function r(){this.constructor=e}cj(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function cP(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function cD(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}function cL(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(cD(arguments[t]));return e}function c_(e){return!!e.useClass}function cH(e){return!!e.useFactory}var cV=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,i=!1;return new Proxy({},this.createHandler(function(){return i||(t=e(r.wrap()),i=!0),t}))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach(function(r){t[r]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t[0]=e(),Reflect[r].apply(void 0,cL(t))}}),t},e}();function cM(e){return"string"==typeof e||"symbol"==typeof e}function c$(e){return"object"==typeof e&&"token"in e&&"transform"in e}function cF(e){return!!e.useToken}function cz(e){return void 0!=e.useValue}var cq=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),cK=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cR(t,e),t}(cq);let cW=function(){this.scopedResolutions=new Map};var cG=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cR(t,e),t}(cq),cZ=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cR(t,e),t}(cq);let cJ=function(){this.preResolution=new cG,this.postResolution=new cZ};var cY=new Map,cQ=new(function(){function e(e){this.parent=e,this._registry=new cK,this.interceptors=new cJ,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,r){if(void 0===r&&(r={lifecycle:cU.Transient}),this.ensureNotDisposed(),i=c_(t)||cz(t)||cF(t)||cH(t)?t:{useClass:t},cF(i))for(var i,n=[e],o=i;null!=o;){var s=o.useToken;if(n.includes(s))throw Error("Token registration cycle detected! "+cL(n,[s]).join(" -> "));n.push(s);var a=this._registry.get(s);o=a&&cF(a.provider)?a.provider:null}if((r.lifecycle===cU.Singleton||r.lifecycle==cU.ContainerScoped||r.lifecycle==cU.ResolutionScoped)&&(cz(i)||cH(i)))throw Error('Cannot use lifecycle "'+cU[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:i,options:r}),this},e.prototype.registerType=function(e,t){return(this.ensureNotDisposed(),cM(t))?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),cM(e)){if(cM(t))return this.register(e,{useToken:t},{lifecycle:cU.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:cU.Singleton});throw Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!cM(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:cU.Singleton})},e.prototype.resolve=function(e,t,r){void 0===t&&(t=new cW),void 0===r&&(r=!1),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&cM(e)){if(r)return;throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"Single"),i){var n=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if("function"==typeof e||e instanceof cV){var n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,i;if(this.interceptors.preResolution.has(e)){var n=[];try{for(var o=cP(this.interceptors.preResolution.getAll(e)),s=o.next();!s.done;s=o.next()){var a=s.value;"Once"!=a.options.frequency&&n.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,n)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var i,n;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var s=cP(this.interceptors.postResolution.getAll(e)),a=s.next();!a.done;a=s.next()){var l=a.value;"Once"!=l.options.frequency&&o.push(l),l.callback(e,t,r)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===cU.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,i=e.options.lifecycle===cU.Singleton,n=e.options.lifecycle===cU.ContainerScoped,o=i||n;return r=cz(e.provider)?e.provider.useValue:cF(e.provider)?o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):c_(e.provider)?o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):cH(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===cU.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t,r){var i=this;void 0===t&&(t=new cW),void 0===r&&(r=!1),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&cM(e)){if(r)return[];throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"All"),n){var o=n.map(function(e){return i.resolveRegistration(e,t)});return this.executePostResolutionInterceptor(e,o,"All"),o}var s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var r=cP(this._registry.entries()),i=r.next();!i.done;i=r.next()){var n=cD(i.value,2),o=n[0],s=n[1];this._registry.setAll(o,s.filter(function(e){return!cz(e.provider)}).map(function(e){return e.instance=void 0,e}))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){this.ensureNotDisposed();var t,r,i=new e(this);try{for(var n=cP(this._registry.entries()),o=n.next();!o.done;o=n.next()){var s=cD(o.value,2),a=s[0],l=s[1];l.some(function(e){return e.options.lifecycle===cU.ContainerScoped})&&i._registry.setAll(a,l.map(function(e){return e.options.lifecycle===cU.ContainerScoped?{provider:e.provider,options:e.options}:e}))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return i},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.dispose=function(){var e,t,r,i;return e=this,t=void 0,r=void 0,i=function(){var e;return function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){var l=[o,a];if(r)throw TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&l[0]?i.return:l[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,l[1])).done)return n;switch(i=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,i=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===l[0]||2===l[0])){s=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){s.label=l[1];break}if(6===l[0]&&s.label<n[1]){s.label=n[1],n=l;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(l);break}n[2]&&s.ops.pop(),s.trys.pop();continue}l=t.call(e,s)}catch(e){l=[6,e],i=0}finally{r=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(t){var r=t.dispose();r&&e.push(r)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})},new(r||(r=Promise))(function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof cV)return e.createProxy(function(e){return r.resolve(e,t)});var i=function(){var i=cY.get(e);if(!i||0===i.length)if(0===e.length)return new e;else throw Error('TypeInfo not known for "'+e.name+'"');var n=i.map(r.resolveParams(t,e));return new(e.bind.apply(e,cL([void 0],n)))}();return"function"!=typeof i.dispose||i.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var r=this;return function(i,n){var o,s,a,l,c,u,f;try{if("object"==typeof i&&"token"in i&&"multiple"in i)if(c$(i))return i.multiple?(o=r.resolve(i.transform)).transform.apply(o,cL([r.resolveAll(i.token,new cW,i.isOptional)],i.transformArgs)):(s=r.resolve(i.transform)).transform.apply(s,cL([r.resolve(i.token,e,i.isOptional)],i.transformArgs));else return i.multiple?r.resolveAll(i.token,new cW,i.isOptional):r.resolve(i.token,e,i.isOptional);if(c$(i))return(a=r.resolve(i.transform,e)).transform.apply(a,cL([r.resolve(i.token,e)],i.transformArgs));return r.resolve(i,e)}catch(e){throw Error((u="Cannot inject the dependency "+(c=void 0===(l=cD(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1])?null:l,null===c?"at position #"+n:'"'+c.split(",")[n].trim()+'" at position #'+n)+' of "'+t.name+'" constructor. Reason:',void 0===f&&(f="    "),cL([u],e.message.split("\n").map(function(e){return f+e})).join("\n")))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error("This container has been disposed, you cannot interact with a disposed container")},e}());let cX=function(e){return function(t){var r,i;cY.set(t,(r=Reflect.getMetadata("design:paramtypes",t)||[],Object.keys(i=Reflect.getOwnMetadata("injectionTokens",t)||{}).forEach(function(e){r[+e]=i[e]}),r)),e&&e.token&&(Array.isArray(e.token)?e.token.forEach(function(e){cQ.register(e,t)}):cQ.register(e.token,t))}};if(e.s([],568370),"undefined"==typeof Reflect||!Reflect.getMetadata)throw Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");e.i(568370);class c0{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}sv([sf({type:ru.ObjectIdentifier})],c0.prototype,"attrId",void 0),sv([sf({type:ru.Any,repeated:"set"})],c0.prototype,"attrValues",void 0);let c1=rJ=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rJ.prototype)}};c1=rJ=sv([su({type:rc.Sequence,itemType:c0})],c1);let c2=rY=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rY.prototype)}};c2=rY=sv([su({type:rc.Sequence,itemType:ly})],c2);class c8{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],c8.prototype,"certId",void 0),sv([sf({type:ru.Any,context:0})],c8.prototype,"certValue",void 0);class c3{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],c3.prototype,"crlId",void 0),sv([sf({type:ru.Any,context:0})],c3.prototype,"crltValue",void 0);class c6 extends oq{}class c4{constructor(e={}){this.encryptionAlgorithm=new aN,this.encryptedData=new c6,Object.assign(this,e)}}sv([sf({type:aN})],c4.prototype,"encryptionAlgorithm",void 0),sv([sf({type:c6})],c4.prototype,"encryptedData",void 0),(rr=rX||(rX={}))[rr.v1=0]="v1";class c5 extends oq{}let c9=rQ=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,rQ.prototype)}};c9=rQ=sv([su({type:rc.Sequence,itemType:aS})],c9);class c7{constructor(e={}){this.version=rX.v1,this.privateKeyAlgorithm=new aN,this.privateKey=new c5,Object.assign(this,e)}}sv([sf({type:ru.Integer})],c7.prototype,"version",void 0),sv([sf({type:aN})],c7.prototype,"privateKeyAlgorithm",void 0),sv([sf({type:c5})],c7.prototype,"privateKey",void 0),sv([sf({type:c9,implicit:!0,context:0,optional:!0})],c7.prototype,"attributes",void 0);let ue=class extends c7{};ue=sv([su({type:rc.Sequence})],ue);let ut=class extends c4{};ut=sv([su({type:rc.Sequence})],ut);class ur{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],ur.prototype,"secretTypeId",void 0),sv([sf({type:ru.Any,context:0})],ur.prototype,"secretValue",void 0);class ui{constructor(e={}){this.mac=new cC,this.macSalt=new oq,this.iterations=1,Object.assign(this,e)}}sv([sf({type:cC})],ui.prototype,"mac",void 0),sv([sf({type:oq})],ui.prototype,"macSalt",void 0),sv([sf({type:ru.Integer,defaultValue:1})],ui.prototype,"iterations",void 0);class un{constructor(e={}){this.version=3,this.authSafe=new ly,this.macData=new ui,Object.assign(this,e)}}sv([sf({type:ru.Integer})],un.prototype,"version",void 0),sv([sf({type:ly})],un.prototype,"authSafe",void 0),sv([sf({type:ui,optional:!0})],un.prototype,"macData",void 0);class uo{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:ru.ObjectIdentifier})],uo.prototype,"bagId",void 0),sv([sf({type:ru.Any,context:0})],uo.prototype,"bagValue",void 0),sv([sf({type:c0,repeated:"set",optional:!0})],uo.prototype,"bagAttributes",void 0);let us=r0=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,r0.prototype)}};us=r0=sv([su({type:rc.Sequence,itemType:uo})],us);let ua="1.2.840.113549.1.9",ul=`${ua}.7`,uc=`${ua}.14`,uu=class extends sb{constructor(e={}){super(e)}toString(){return({}).toString(),this.ia5String||super.toString()}};sv([sf({type:ru.IA5String})],uu.prototype,"ia5String",void 0),uu=sv([su({type:rc.Choice})],uu);let uf=class extends ly{};uf=sv([su({type:rc.Sequence})],uf);let uh=class extends un{};uh=sv([su({type:rc.Sequence})],uh);let up=class extends c4{};up=sv([su({type:rc.Sequence})],up);let ud=class{constructor(e=""){this.value=e}toString(){return this.value}};sv([sf({type:ru.IA5String})],ud.prototype,"value",void 0),ud=sv([su({type:rc.Choice})],ud);let uy=class extends uu{};uy=sv([su({type:rc.Choice})],uy);let ug=class extends sb{};ug=sv([su({type:rc.Choice})],ug);let uv=class{constructor(e=new Date){this.value=e}};sv([sf({type:ru.GeneralizedTime})],uv.prototype,"value",void 0),uv=sv([su({type:rc.Choice})],uv);let um=class extends sb{};um=sv([su({type:rc.Choice})],um);let ub=class{constructor(e="M"){this.value=e}toString(){return this.value}};sv([sf({type:ru.PrintableString})],ub.prototype,"value",void 0),ub=sv([su({type:rc.Choice})],ub);let uw=class{constructor(e=""){this.value=e}toString(){return this.value}};sv([sf({type:ru.PrintableString})],uw.prototype,"value",void 0),uw=sv([su({type:rc.Choice})],uw);let uA=class extends uw{};uA=sv([su({type:rc.Choice})],uA);let uS=class extends sb{};uS=sv([su({type:rc.Choice})],uS);let ux=class{constructor(e=""){this.value=e}toString(){return this.value}};sv([sf({type:ru.ObjectIdentifier})],ux.prototype,"value",void 0),ux=sv([su({type:rc.Choice})],ux);let uB=class extends aU{};uB=sv([su({type:rc.Choice})],uB);let uE=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};sv([sf({type:ru.Integer})],uE.prototype,"value",void 0),uE=sv([su({type:rc.Choice})],uE);let uk=class extends aJ{};uk=sv([su({type:rc.Sequence})],uk);let uC=class extends sb{};uC=sv([su({type:rc.Choice})],uC);let uO=r1=class extends aP{constructor(e){super(e),Object.setPrototypeOf(this,r1.prototype)}};uO=r1=sv([su({type:rc.Sequence})],uO);let uI=r2=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,r2.prototype)}};uI=r2=sv([su({type:rc.Set,itemType:aZ})],uI);let uN=class{constructor(e=""){this.value=e}toString(){return this.value}};sv([sf({type:ru.BmpString})],uN.prototype,"value",void 0),uN=sv([su({type:rc.Choice})],uN);let uT=class extends aN{};uT=sv([su({type:rc.Sequence})],uT);let uU=r8=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,r8.prototype)}};uU=r8=sv([su({type:rc.Sequence,itemType:uT})],uU);let uj=r3=class extends sy{constructor(e){super(e),Object.setPrototypeOf(this,r3.prototype)}};uj=r3=sv([su({type:rc.Sequence,itemType:aS})],uj);class uR{constructor(e={}){this.version=0,this.subject=new sB,this.subjectPKInfo=new aT,this.attributes=new uj,Object.assign(this,e)}}sv([sf({type:ru.Integer})],uR.prototype,"version",void 0),sv([sf({type:sB})],uR.prototype,"subject",void 0),sv([sf({type:aT})],uR.prototype,"subjectPKInfo",void 0),sv([sf({type:uj,implicit:!0,context:0,optional:!0})],uR.prototype,"attributes",void 0);class uP{constructor(e={}){this.certificationRequestInfo=new uR,this.signatureAlgorithm=new aN,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}sv([sf({type:uR,raw:!0})],uP.prototype,"certificationRequestInfo",void 0),sv([sf({type:aN})],uP.prototype,"signatureAlgorithm",void 0),sv([sf({type:ru.BitString})],uP.prototype,"signature",void 0);let uD="crypto.algorithm",uL="crypto.algorithmProvider";cQ.registerSingleton(uL,class{getAlgorithms(){return cQ.resolveAll(uD)}toAsnAlgorithm(e){for(let t of({...e},this.getAlgorithms())){let r=t.toAsnAlgorithm(e);if(r)return r}if(/^[0-9.]+$/.test(e.name)){let t=new aN({algorithm:e.name});return"parameters"in e&&(t.parameters=e.parameters),t}throw Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(let t of this.getAlgorithms()){let r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});let u_="1.3.36.3.3.2.8.1.1",uH=`${u_}.1`,uV=`${u_}.2`,uM=`${u_}.3`,u$=`${u_}.4`,uF=`${u_}.5`,uz=`${u_}.6`,uq=`${u_}.7`,uK=`${u_}.8`,uW=`${u_}.9`,uG=`${u_}.10`,uZ=`${u_}.11`,uJ=`${u_}.12`,uY=`${u_}.13`,uQ=`${u_}.14`,uX="brainpoolP160r1",u0="brainpoolP160t1",u1="brainpoolP192r1",u2="brainpoolP192t1",u8="brainpoolP224r1",u3="brainpoolP224t1",u6="brainpoolP256r1",u4="brainpoolP256t1",u5="brainpoolP320r1",u9="brainpoolP320t1",u7="brainpoolP384r1",fe="brainpoolP384t1",ft="brainpoolP512r1",fr="brainpoolP512t1",fi="ECDSA",fn=r6=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===fi.toLowerCase()){if("hash"in e)switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return l1;case"sha-256":return l2;case"sha-384":return l8;case"sha-512":return l3}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=lY;break;case"K-256":t=r6.SECP256K1;break;case"P-384":t=lQ;break;case"P-521":t=lX;break;case uX:t=uH;break;case u0:t=uV;break;case u1:t=uM;break;case u2:t=u$;break;case u8:t=uF;break;case u3:t=uz;break;case u6:t=uq;break;case u4:t=uK;break;case u5:t=uW;break;case u9:t=uG;break;case u7:t=uZ;break;case fe:t=uJ;break;case ft:t=uY;break;case fr:t=uQ}if(t)return new aN({algorithm:lq,parameters:sg.serialize(new l9({namedCurve:t}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case lK:return{name:fi,hash:{name:"SHA-1"}};case lG:return{name:fi,hash:{name:"SHA-256"}};case lZ:return{name:fi,hash:{name:"SHA-384"}};case lJ:return{name:fi,hash:{name:"SHA-512"}};case lq:if(!e.parameters)throw TypeError("Cannot get required parameters from EC algorithm");switch(sg.parse(e.parameters,l9).namedCurve){case lY:return{name:fi,namedCurve:"P-256"};case r6.SECP256K1:return{name:fi,namedCurve:"K-256"};case lQ:return{name:fi,namedCurve:"P-384"};case lX:return{name:fi,namedCurve:"P-521"};case uH:return{name:fi,namedCurve:uX};case uV:return{name:fi,namedCurve:u0};case uM:return{name:fi,namedCurve:u1};case u$:return{name:fi,namedCurve:u2};case uF:return{name:fi,namedCurve:u8};case uz:return{name:fi,namedCurve:u3};case uq:return{name:fi,namedCurve:u6};case uK:return{name:fi,namedCurve:u4};case uW:return{name:fi,namedCurve:u5};case uG:return{name:fi,namedCurve:u9};case uZ:return{name:fi,namedCurve:u7};case uJ:return{name:fi,namedCurve:fe};case uY:return{name:fi,namedCurve:ft};case uQ:return{name:fi,namedCurve:fr}}}return null}};fn.SECP256K1="1.3.132.0.10",fn=r6=sv([cX()],fn),cQ.registerSingleton(uD,fn);let fo=Symbol("name"),fs=Symbol("value");class fa{constructor(e,t={},r=""){for(const i in this[fo]=e,this[fs]=r,t)this[i]=t[i]}}fa.NAME=fo,fa.VALUE=fs;class fl{static toString(e){let t=this.items[e];return t||e}}fl.items={[cy]:"sha1",[cg]:"sha224",[cv]:"sha256",[cm]:"sha384",[cb]:"sha512",[cr]:"rsaEncryption",[cl]:"sha1WithRSAEncryption",[cc]:"sha224WithRSAEncryption",[cu]:"sha256WithRSAEncryption",[cf]:"sha384WithRSAEncryption",[ch]:"sha512WithRSAEncryption",[lq]:"ecPublicKey",[lK]:"ecdsaWithSHA1",[lW]:"ecdsaWithSHA224",[lG]:"ecdsaWithSHA256",[lZ]:"ecdsaWithSHA384",[lJ]:"ecdsaWithSHA512",[ai]:"TLS WWW server authentication",[an]:"TLS WWW client authentication",[ao]:"Code Signing",[as]:"E-mail Protection",[aa]:"Time Stamping",[al]:"OCSP Signing",[l$]:"Signed Data"};class fc{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){let r=[],i=this.pad(t++),n="",o=e[fa.VALUE];for(let s in o&&(n=` ${o}`),r.push(`${i}${e[fa.NAME]}:${n}`),i=this.pad(t),e){if("symbol"==typeof s)continue;let n=e[s],o=s?`${s}: `:"";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)r.push(`${i}${o}${n}`);else if(n instanceof Date)r.push(`${i}${o}${n.toUTCString()}`);else if(Array.isArray(n))for(let e of n)e[fa.NAME]=s,r.push(...this.serializeObj(e,t));else if(n instanceof fa)n[fa.NAME]=s,r.push(...this.serializeObj(n,t));else if(nx.BufferSourceConverter.isBufferSource(n))s?(r.push(`${i}${o}`),r.push(...this.serializeBufferSource(n,t+1))):r.push(...this.serializeBufferSource(n,t));else if("toTextObject"in n){let e=n.toTextObject();e[fa.NAME]=s,r.push(...this.serializeObj(e,t))}else throw TypeError("Cannot serialize data in text format. Unsupported type.")}return r}static serializeBufferSource(e,t=0){let r=this.pad(t),i=nx.BufferSourceConverter.toUint8Array(e),n=[];for(let e=0;e<i.length;){let t=[];for(let r=0;r<16&&e<i.length;r++){8===r&&t.push("");let n=i[e++].toString(16).padStart(2,"0");t.push(n)}n.push(`${r}${t.join(" ")}`)}return n}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}fc.oidSerializer=fl,fc.algorithmSerializer=class{static toTextObject(e){let t=new fa("Algorithm Identifier",{},fl.toString(e.algorithm));if(e.parameters)if(e.algorithm===lq){let r=new fn().toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters}else t.Parameters=e.parameters;return t}};class fu{constructor(...e){if(1===e.length){const t=e[0];this.rawData=sg.serialize(t),this.onInit(t)}else{const t=sg.parse(e[0],e[1]);this.rawData=nx.BufferSourceConverter.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof fu&&(0,nx.isEqual)(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return sg.toString(this.rawData);case"text":return fc.serialize(this.toTextObject());case"hex":return nx.Convert.ToHex(this.rawData);case"base64":return nx.Convert.ToBase64(this.rawData);case"base64url":return nx.Convert.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){let e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new fa(this.getTextName(),{},e)}}fu.NAME="ASN";class ff extends fu{constructor(...e){super(nx.BufferSourceConverter.isBufferSource(e[0])?nx.BufferSourceConverter.toArrayBuffer(e[0]):sg.serialize(new aR({extnID:e[0],critical:e[1],extnValue:new oq(nx.BufferSourceConverter.toArrayBuffer(e[2]))})),aR)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[fa.NAME]===ff.NAME&&(e[fa.NAME]=fl.toString(this.type)),e}}class fh{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}constructor(){this.items=new Map,this[r4]="CryptoProvider","undefined"!=typeof self&&"undefined"!=typeof crypto?this.set(fh.DEFAULT,crypto):e.g.crypto&&e.g.crypto.subtle&&this.set(fh.DEFAULT,e.g.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=fh.DEFAULT){let t=this.items.get(e.toLowerCase());if(!t)throw Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(fh.DEFAULT,e);return this}}r4=Symbol.toStringTag,fh.DEFAULT="default";let fp=new fh,fd=/^[0-2](?:\.[1-9][0-9]*)+$/;class fy{constructor(e={}){for(const t in this.items={},e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return new RegExp(fd).test(e)?e:this.get(e)}register(e,t){this.items[e]=t,this.items[t]=e}}let fg=new fy;function fv(e,t){return`\\${nx.Convert.ToHex(nx.Convert.FromUtf8String(t)).toUpperCase()}`}fg.register("CN","2.5.4.3"),fg.register("L","2.5.4.7"),fg.register("ST","2.5.4.8"),fg.register("O","2.5.4.10"),fg.register("OU","2.5.4.11"),fg.register("C","2.5.4.6"),fg.register("DC","0.9.2342.19200300.100.1.25"),fg.register("E","1.2.840.113549.1.9.1"),fg.register("G","2.5.4.42"),fg.register("I","2.5.4.43"),fg.register("SN","2.5.4.4"),fg.register("T","2.5.4.12");class fm{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,t={}){for(const e in this.extraNames=new fy,this.asn=new sB,t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof sB?this.asn=e:nx.BufferSourceConverter.isBufferSource(e)?this.asn=sg.parse(e,sB):this.asn=this.fromJSON(e)}getField(e){let t=this.extraNames.findId(e)||fg.findId(e),r=[];for(let e of this.asn)for(let i of e)i.type===t&&r.push(i.value.toString());return r}getName(e){return this.extraNames.get(e)||fg.get(e)}toString(){return this.asn.map(e=>e.map(e=>{let t=this.getName(e.type)||e.type,r=e.value.anyValue?`#${nx.Convert.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,fv);return`${t}=${r}`}).join("+")).join(", ")}toJSON(){let e=[];for(let t of this.asn){let r={};for(let e of t){let t=this.getName(e.type)||e.type;null!=r[t]||(r[t]=[]),r[t].push(e.value.anyValue?`#${nx.Convert.ToHex(e.value.anyValue)}`:e.value.toString())}e.push(r)}return e}fromString(e){let t=new sB,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g,i=null,n=",";for(;i=r.exec(`${e},`);){let[,e,r]=i,o=r[r.length-1];(","===o||"+"===o)&&(r=r.slice(0,r.length-1),i[3]=o);let s=i[3];e=this.getTypeOid(e);let a=this.createAttribute(e,r);"+"===n?t[t.length-1].push(a):t.push(new sS([a])),n=s}return t}fromJSON(e){let t=new sB;for(let r of e){let e=new sS;for(let t in r){let i=this.getTypeOid(t);for(let n of r[t]){let t=this.createAttribute(i,n);e.push(t)}}t.push(e)}return t}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,t){let r=new sA({type:e});if("object"==typeof t)for(let e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else if("#"===t[0])r.value.anyValue=nx.Convert.FromHex(t.slice(1));else{let i=this.processStringValue(t);e===this.getName("E")||e===this.getName("DC")?r.value.ia5String=i:fm.isPrintableString(i)?r.value.printableString=i:r.value.utf8String=i}return r}processStringValue(e){let t=/"(.*?[^\\])?"/.exec(e);return t&&(e=t[1]),e.replace(/\\0a/ig,"\n").replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return sg.serialize(this.asn)}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||fp.get():(i=e[0]||i,r=e[1]||fp.get()),await r.subtle.digest(i,this.toArrayBuffer())}}let fb="Cannot initialize GeneralName from ASN.1 data.",fw=`${fb} Unsupported string format in use.`,fA=`${fb} Value doesn't match to GUID regular expression.`,fS=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,fx="1.3.6.1.4.1.311.25.1",fB="1.3.6.1.4.1.311.20.2.3",fE="email",fk="guid";class fC extends fu{constructor(...e){let t;if(2===e.length)switch(e[0]){case"dn":{const r=new fm(e[1]).toArrayBuffer(),i=sg.parse(r,sB);t=new sC({directoryName:i});break}case"dns":t=new sC({dNSName:e[1]});break;case fE:t=new sC({rfc822Name:e[1]});break;case fk:{const r=RegExp(fS,"i").exec(e[1]);if(!r)throw Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=r.slice(1).map((e,t)=>t<3?nx.Convert.ToHex(new Uint8Array(nx.Convert.FromHex(e)).reverse()):e).join("");t=new sC({otherName:new sE({typeId:fx,value:sg.serialize(new oq(nx.Convert.FromHex(i)))})});break}case"ip":t=new sC({iPAddress:e[1]});break;case"id":t=new sC({registeredID:e[1]});break;case"upn":t=new sC({otherName:new sE({typeId:fB,value:sg.serialize(o1.toASN(e[1]))})});break;case"url":t=new sC({uniformResourceIdentifier:e[1]});break;default:throw Error("Cannot create GeneralName. Unsupported type of the name")}else t=nx.BufferSourceConverter.isBufferSource(e[0])?sg.parse(e[0],sC):e[0];super(t)}onInit(e){if(void 0!=e.dNSName)this.type="dns",this.value=e.dNSName;else if(void 0!=e.rfc822Name)this.type=fE,this.value=e.rfc822Name;else if(void 0!=e.iPAddress)this.type="ip",this.value=e.iPAddress;else if(void 0!=e.uniformResourceIdentifier)this.type="url",this.value=e.uniformResourceIdentifier;else if(void 0!=e.registeredID)this.type="id",this.value=e.registeredID;else if(void 0!=e.directoryName)this.type="dn",this.value=new fm(e.directoryName).toString();else if(void 0!=e.otherName)if(e.otherName.typeId===fx){this.type=fk;let t=sg.parse(e.otherName.value,oq),r=RegExp(fS,"i").exec(nx.Convert.ToHex(t));if(!r)throw Error(fA);this.value=r.slice(1).map((e,t)=>t<3?nx.Convert.ToHex(new Uint8Array(nx.Convert.FromHex(e)).reverse()):e).join("-")}else if(e.otherName.typeId===fB)this.type="upn",this.value=sg.parse(e.otherName.value,sb).toString();else throw Error(fw);else throw Error(fw)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case"dn":case"dns":case fk:case"ip":case"id":case"upn":case"url":e=this.type.toUpperCase();break;case fE:e="Email";break;default:throw Error("Unsupported GeneralName type")}let t=this.value;return"id"===this.type&&(t=fl.toString(t)),new fa(e,void 0,t)}}class fO extends fu{constructor(e){let t;if(e instanceof sq)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof sC)r.push(t);else{const e=sg.parse(new fC(t.type,t.value).rawData,sC);r.push(e)}t=new sq(r)}else if(nx.BufferSourceConverter.isBufferSource(e))t=sg.parse(e,sq);else throw Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(t)}onInit(e){let t=[];for(let r of e){let e=null;try{e=new fC(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map(e=>e.toJSON())}toTextObject(){let e=super.toTextObjectEmpty();for(let t of this.items){let r=t.toTextObject(),i=e[r[fa.NAME]];Array.isArray(i)||(i=[],e[r[fa.NAME]]=i),i.push(r)}return e}}fO.NAME="GeneralNames";let fI="-{5}",fN=`[^\\n]+`,fT=`${fI}BEGIN (${fN}(?=${fI}))${fI}`,fU=`${fI}END \\1${fI}`,fj=`[^:\\n]+`,fR=`(?:[^\\n]+\\n(?: +[^\\n]+\\n)*)`,fP=`(?:[a-zA-Z0-9=+/]+\\n)+`,fD=`${fT}\\n(?:((?:${fj}: ${fR})+))?\\n?(${fP})${fU}`;class fL{static isPem(e){return"string"==typeof e&&RegExp(fD,"g").test(e)}static decodeWithHeaders(e){e=e.replace(/\r/g,"");let t=RegExp(fD,"g"),r=[],i=null;for(;i=t.exec(e);){let e=i[3].replace(RegExp(`[\\n]+`,"g"),""),t={type:i[1],headers:[],rawData:nx.Convert.FromBase64(e)},n=i[2];if(n){let e=n.split(RegExp("\\n","g")),r=null;for(let i of e){let[e,n]=i.split(/:(.*)/);if(void 0===n){if(!r)throw Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:n.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map(e=>e.rawData)}static decodeFirst(e){let t=this.decode(e);if(!t.length)throw RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){let r=[];return t?e.forEach(e=>{if(!nx.BufferSourceConverter.isBufferSource(e))throw TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:nx.BufferSourceConverter.toArrayBuffer(e)}))}):e.forEach(e=>{if(!("type"in e))throw TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))}),r.join("\n")}if(!t)throw Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:nx.BufferSourceConverter.toArrayBuffer(e)})}static encodeStruct(e){var t;let r,i=e.type.toLocaleUpperCase(),n=[];if(n.push(`-----BEGIN ${i}-----`),null==(t=e.headers)?void 0:t.length){for(let t of e.headers)n.push(`${t.key}: ${t.value}`);n.push("")}let o=nx.Convert.ToBase64(e.rawData),s=0,a=[];for(;s<o.length;)if(o.length-s<64?r=o.substring(s):(r=o.substring(s,s+64),s+=64),0!==r.length){if(a.push(r),r.length<64)break}else break;return n.push(...a),n.push(`-----END ${i}-----`),n.join("\n")}}fL.CertificateTag="CERTIFICATE",fL.CrlTag="CRL",fL.CertificateRequestTag="CERTIFICATE REQUEST",fL.PublicKeyTag="PUBLIC KEY",fL.PrivateKeyTag="PRIVATE KEY";class f_ extends fu{static isAsnEncoded(e){return nx.BufferSourceConverter.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e)if(fL.isPem(e))return fL.decode(e)[0];else if(nx.Convert.isHex(e))return nx.Convert.FromHex(e);else if(nx.Convert.isBase64(e))return nx.Convert.FromBase64(e);else if(nx.Convert.isBase64Url(e))return nx.Convert.FromBase64Url(e);else throw TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url");{let t=nx.Convert.ToBinary(e);if(fL.isPem(t))return fL.decode(t)[0];if(nx.Convert.isHex(t))return nx.Convert.FromHex(t);if(nx.Convert.isBase64(t))return nx.Convert.FromBase64(t);else if(nx.Convert.isBase64Url(t))return nx.Convert.FromBase64Url(t);return nx.BufferSourceConverter.toArrayBuffer(e)}}constructor(...e){f_.isAsnEncoded(e[0])?super(f_.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?fL.encode(this.rawData,this.tag):super.toString(e)}}class fH extends f_{static async create(e,t=fp.get()){if(e instanceof fH)return e;if(fh.isCryptoKey(e)){if("public"!==e.type)throw TypeError("Public key is required");return new fH(await t.subtle.exportKey("spki",e))}if(e.publicKey)return e.publicKey;if(nx.BufferSourceConverter.isBufferSource(e))return new fH(e);throw TypeError("Unsupported PublicKeyType")}constructor(e){f_.isAsnEncoded(e)?super(e,aT):super(e),this.tag=fL.PublicKeyTag}async export(...e){var t;let r,i=["verify"],n={hash:"SHA-256",...this.algorithm};e.length>1?(n=e[0]||n,i=e[1]||i,r=e[2]||fp.get()):r=e[0]||fp.get();let o=this.rawData,s=sg.parse(this.rawData,aT);return s.algorithm.algorithm===co&&(t=s,t.algorithm=new aN({algorithm:cr,parameters:null}),o=sg.serialize(t)),r.subtle.importKey("spki",o,n,!0,i)}onInit(e){let t=cQ.resolve(uL),r=this.algorithm=t.toWebAlgorithm(e.algorithm);if(e.algorithm.algorithm===cr){let t=sg.parse(e.subjectPublicKey,cT),i=nx.BufferSourceConverter.toUint8Array(t.modulus);r.publicExponent=nx.BufferSourceConverter.toUint8Array(t.publicExponent),r.modulusLength=(!i[0]?i.slice(1):i).byteLength<<3}}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||fp.get():(i=e[0]||i,r=e[1]||fp.get()),await r.subtle.digest(i,this.rawData)}async getKeyIdentifier(...e){let t,r="SHA-1";1===e.length?"string"==typeof e[0]?(r=e[0],t=fp.get()):t=e[0]:2===e.length?(r=e[0],t=e[1]):t=fp.get();let i=sg.parse(this.rawData,aT);return await t.subtle.digest(r,i.subjectPublicKey)}toTextObject(){let e=this.toTextObjectEmpty(),t=sg.parse(this.rawData,aT);return e.Algorithm=fc.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===lq?e["EC Point"]=t.subjectPublicKey:e["Raw Data"]=t.subjectPublicKey,e}}class fV extends ff{static async create(e,t=!1,r=fp.get()){if("name"in e&&"serialNumber"in e)return new fV(e,t);let i=await fH.create(e,r),n=await i.getKeyIdentifier(r);return new fV(nx.Convert.ToHex(n),t)}constructor(...e){if(nx.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0])super(sV,e[1],sg.serialize(new s$({keyIdentifier:new sM(nx.Convert.FromHex(e[0]))})));else{const t=e[0];super(sV,e[1],sg.serialize(new s$({authorityCertIssuer:t.name instanceof fO?sg.parse(t.name.rawData,sq):t.name,authorityCertSerialNumber:nx.Convert.FromHex(t.serialNumber)})))}}onInit(e){super.onInit(e);let t=sg.parse(e.extnValue,s$);t.keyIdentifier&&(this.keyId=nx.Convert.ToHex(t.keyIdentifier)),(t.authorityCertIssuer||t.authorityCertSerialNumber)&&(this.certId={name:t.authorityCertIssuer||[],serialNumber:t.authorityCertSerialNumber?nx.Convert.ToHex(t.authorityCertSerialNumber):""})}toTextObject(){let e=this.toTextObjectWithoutValue(),t=sg.parse(this.value,s$);return t.authorityCertIssuer&&(e["Authority Issuer"]=new fO(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}fV.NAME="Authority Key Identifier";class fM extends ff{constructor(...e){if(nx.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sg.parse(this.value,sz);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else super(sF,e[2],sg.serialize(new sz({cA:e[0],pathLenConstraint:e[1]}))),this.ca=e[0],this.pathLength=e[1]}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}fM.NAME="Basic Constraints",(ri=r5||(r5={})).serverAuth="1.3.6.1.5.5.7.3.1",ri.clientAuth="1.3.6.1.5.5.7.3.2",ri.codeSigning="1.3.6.1.5.5.7.3.3",ri.emailProtection="1.3.6.1.5.5.7.3.4",ri.timeStamping="1.3.6.1.5.5.7.3.8",ri.ocspSigning="1.3.6.1.5.5.7.3.9";class f$ extends ff{constructor(...e){if(nx.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sg.parse(this.value,ar);this.usages=t.map(e=>e)}else super(at,e[1],sg.serialize(new ar(e[0]))),this.usages=e[0]}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.usages.map(e=>fl.toString(e)).join(", "),e}}f$.NAME="Extended Key Usages",(rn=r9||(r9={}))[rn.digitalSignature=1]="digitalSignature",rn[rn.nonRepudiation=2]="nonRepudiation",rn[rn.keyEncipherment=4]="keyEncipherment",rn[rn.dataEncipherment=8]="dataEncipherment",rn[rn.keyAgreement=16]="keyAgreement",rn[rn.keyCertSign=32]="keyCertSign",rn[rn.cRLSign=64]="cRLSign",rn[rn.encipherOnly=128]="encipherOnly",rn[rn.decipherOnly=256]="decipherOnly";class fF extends ff{constructor(...e){if(nx.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sg.parse(this.value,ap);this.usages=t.toNumber()}else super(ah,e[1],sg.serialize(new ap(e[0]))),this.usages=e[0]}toTextObject(){let e=this.toTextObjectWithoutValue(),t=sg.parse(this.value,ap);return e[""]=t.toJSON().join(", "),e}}fF.NAME="Key Usages";class fz extends ff{static async create(e,t=!1,r=fp.get()){let i=await fH.create(e,r),n=await i.getKeyIdentifier(r);return new fz(nx.Convert.ToHex(n),t)}constructor(...e){if(nx.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sg.parse(this.value,aE);this.keyId=nx.Convert.ToHex(t)}else{const t="string"==typeof e[0]?nx.Convert.FromHex(e[0]):e[0];super(aB,e[1],sg.serialize(new aE(t))),this.keyId=nx.Convert.ToHex(t)}}toTextObject(){let e=this.toTextObjectWithoutValue(),t=sg.parse(this.value,aE);return e[""]=t,e}}fz.NAME="Subject Key Identifier";class fq extends ff{constructor(...e){nx.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(aw,e[1],new fO(e[0]||[]).rawData)}onInit(e){super.onInit(e);let t=sg.parse(e.extnValue,aA);this.names=new fO(t)}toTextObject(){let e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(let r in t)e[r]=t[r];return e}}fq.NAME="Subject Alternative Name";class fK{static register(e,t){this.items.set(e,t)}static create(e){let t=new ff(e),r=this.items.get(t.type);return r?new r(e):t}}fK.items=new Map;class fW extends ff{constructor(...e){var t;if(nx.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sg.parse(this.value,s0);this.policies=t.map(e=>e.policyIdentifier)}else{const r=e[0];super(sW,null!=(t=e[1])&&t,sg.serialize(new s0(r.map(e=>new sX({policyIdentifier:e}))))),this.policies=r}}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map(e=>new fa("",{},fl.toString(e))),e}}fW.NAME="Certificate Policies",fK.register(sW,fW);class fG extends ff{constructor(...e){nx.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):Array.isArray(e[0])&&"string"==typeof e[0][0]?super(s8,e[1],sg.serialize(new s5(e[0].map(e=>new s4({distributionPoint:new s6({fullName:[new sC({uniformResourceIdentifier:e})]})}))))):super(s8,e[1],sg.serialize(new s5(e[0]))),null!=this.distributionPoints||(this.distributionPoints=[])}onInit(e){super.onInit(e);let t=sg.parse(e.extnValue,s5);this.distributionPoints=t}toTextObject(){let e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map(e=>{var t;let r={};return e.distributionPoint&&(r[""]=null==(t=e.distributionPoint.fullName)?void 0:t.map(e=>new fC(e).toString()).join(", ")),e.reasons&&(r.Reasons=e.reasons.toString()),e.cRLIssuer&&(r["CRL Issuer"]=e.cRLIssuer.map(e=>e.toString()).join(", ")),r}),e}}fG.NAME="CRL Distribution Points";class fZ extends ff{constructor(...e){if(nx.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof sH)super(sL,e[1],sg.serialize(new sH(e[0])));else{const t=e[0],r=new sH;fY(r,t,sU,"ocsp"),fY(r,t,sj,"caIssuers"),fY(r,t,sR,"timeStamping"),fY(r,t,sP,"caRepository"),super(sL,e[1],sg.serialize(r))}null!=this.ocsp||(this.ocsp=[]),null!=this.caIssuers||(this.caIssuers=[]),null!=this.timeStamping||(this.timeStamping=[]),null!=this.caRepository||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],sg.parse(e.extnValue,sH).forEach(e=>{switch(e.accessMethod){case sU:this.ocsp.push(new fC(e.accessLocation));break;case sj:this.caIssuers.push(new fC(e.accessLocation));break;case sR:this.timeStamping.push(new fC(e.accessLocation));break;case sP:this.caRepository.push(new fC(e.accessLocation))}})}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ocsp.length&&fJ(e,"OCSP",this.ocsp),this.caIssuers.length&&fJ(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&fJ(e,"Time Stamping",this.timeStamping),this.caRepository.length&&fJ(e,"CA Repository",this.caRepository),e}}function fJ(e,t,r){if(1===r.length)e[t]=r[0].toTextObject();else{let i=new fa("");r.forEach((e,t)=>{let r=e.toTextObject(),n=`${r[fa.NAME]} ${t+1}`,o=i[n];Array.isArray(o)||(o=[],i[n]=o),o.push(r)}),e[t]=i}}function fY(e,t,r,i){let n=t[i];n&&(Array.isArray(n)?n:[n]).forEach(t=>{"string"==typeof t&&(t=new fC("url",t)),e.push(new s_({accessMethod:r,accessLocation:sg.parse(t.rawData,sC)}))})}fZ.NAME="Authority Info Access";class fQ extends fu{constructor(...e){let t;if(nx.BufferSourceConverter.isBufferSource(e[0]))t=nx.BufferSourceConverter.toArrayBuffer(e[0]);else{const r=e[0],i=Array.isArray(e[1])?e[1].map(e=>nx.BufferSourceConverter.toArrayBuffer(e)):[];t=sg.serialize(new aS({type:r,values:i}))}super(t,aS)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Value=this.values.map(e=>new fa("",{"":e})),e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty();return e[fa.NAME]===fQ.NAME&&(e[fa.NAME]=fl.toString(this.type)),e}}fQ.NAME="Attribute";class fX extends fQ{constructor(...e){nx.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(ul,[sg.serialize(new uC({printableString:e[0]}))]),null!=this.password||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){let e=sg.parse(this.values[0],uC);this.password=e.toString()}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[fa.VALUE]=this.password,e}}fX.NAME="Challenge Password";class f0 extends fQ{constructor(...e){if(nx.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new aP;for(const e of t)r.push(sg.parse(e.rawData,aR));super(uc,[sg.serialize(r)])}null!=this.items||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){let e=sg.parse(this.values[0],aP);this.items=e.map(e=>fK.create(sg.serialize(e)))}}toTextObject(){let e=this.toTextObjectWithoutValue();for(let t of this.items.map(e=>e.toTextObject()))e[t[fa.NAME]]=t;return e}}f0.NAME="Extensions";class f1{static register(e,t){this.items.set(e,t)}static create(e){let t=new fQ(e),r=this.items.get(t.type);return r?new r(e):t}}f1.items=new Map;let f2="crypto.signatureFormatter",f8=r7=class{static createPssParams(e,t){let r=r7.getHashAlgorithm(e);return r?new ck({hashAlgorithm:r,maskGenAlgorithm:new aN({algorithm:cw,parameters:sg.serialize(r)}),saltLength:t}):null}static getHashAlgorithm(e){let t=cQ.resolve(uL);return"string"==typeof e?t.toAsnAlgorithm({name:e}):"object"==typeof e&&e&&"name"in e?t.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(!("hash"in e))return new aN({algorithm:cr,parameters:null});{let t;if("string"==typeof e.hash)t=e.hash;else if(e.hash&&"object"==typeof e.hash&&"name"in e.hash&&"string"==typeof e.hash.name)t=e.hash.name.toUpperCase();else throw Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new aN({algorithm:cl,parameters:null});case"sha-256":return new aN({algorithm:cu,parameters:null});case"sha-384":return new aN({algorithm:cf,parameters:null});case"sha-512":return new aN({algorithm:ch,parameters:null})}}break;case"rsa-pss":if(!("hash"in e))return new aN({algorithm:co,parameters:null});{if(!("saltLength"in e&&"number"==typeof e.saltLength))throw Error("Cannot get 'saltLength' from 'alg' argument");let t=r7.createPssParams(e.hash,e.saltLength);if(!t)throw Error("Cannot create PSS parameters");return new aN({algorithm:co,parameters:sg.serialize(t)})}}return null}toWebAlgorithm(e){switch(e.algorithm){case cr:return{name:"RSASSA-PKCS1-v1_5"};case cl:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case cu:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case cf:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case ch:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case co:if(!e.parameters)return{name:"RSA-PSS"};{let t=sg.parse(e.parameters,ck);return{name:"RSA-PSS",hash:cQ.resolve(uL).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}}return null}};f8=r7=sv([cX()],f8),cQ.registerSingleton(uD,f8);let f3=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new aN({algorithm:cy});case"sha-256":return new aN({algorithm:cv});case"sha-384":return new aN({algorithm:cm});case"sha-512":return new aN({algorithm:cb})}return null}toWebAlgorithm(e){switch(e.algorithm){case cy:return{name:"SHA-1"};case cv:return{name:"SHA-256"};case cm:return{name:"SHA-384"};case cb:return{name:"SHA-512"}}return null}};f3=sv([cX()],f3),cQ.registerSingleton(uD,f3);class f6{addPadding(e,t){let r=nx.BufferSourceConverter.toUint8Array(t),i=new Uint8Array(e);return i.set(r,e-r.length),i}removePadding(e,t=!1){let r=nx.BufferSourceConverter.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){let e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){let r=e.namedCurve,i=f6.namedCurveSize.get(r)||f6.defaultNamedCurveSize,n=new ce,o=nx.BufferSourceConverter.toUint8Array(t);return n.r=this.removePadding(o.slice(0,i),!0),n.s=this.removePadding(o.slice(i,i+i),!0),sg.serialize(n)}return null}toWebSignature(e,t){if("ECDSA"===e.name){let r=sg.parse(t,ce),i=e.namedCurve,n=f6.namedCurveSize.get(i)||f6.defaultNamedCurveSize,o=this.addPadding(n,this.removePadding(r.r)),s=this.addPadding(n,this.removePadding(r.s));return(0,nx.combine)(o,s)}return null}}f6.namedCurveSize=new Map,f6.defaultNamedCurveSize=32;let f4="1.3.101.110",f5="1.3.101.111",f9="1.3.101.112",f7="1.3.101.113",he=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"ed25519":t=f9;break;case"x25519":t=f4;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=f9;break;case"ed448":t=f7}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=f4;break;case"x448":t=f5}}return t?new aN({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case f9:return{name:"Ed25519"};case f7:return{name:"EdDSA",namedCurve:"Ed448"};case f4:return{name:"X25519"};case f5:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};he=sv([cX()],he),cQ.registerSingleton(uD,he);class ht extends f_{constructor(e){f_.isAsnEncoded(e)?super(e,aL):super(e),this.tag=fL.CertificateTag}onInit(e){let t=e.tbsCertificate;this.tbs=sg.serialize(t),this.serialNumber=nx.Convert.ToHex(t.serialNumber),this.subjectName=new fm(t.subject),this.subject=new fm(t.subject).toString(),this.issuerName=new fm(t.issuer),this.issuer=this.issuerName.toString();let r=cQ.resolve(uL);this.signatureAlgorithm=r.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;let i=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!i)throw Error("Cannot get 'notBefore' value");this.notBefore=i;let n=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!n)throw Error("Cannot get 'notAfter' value");this.notAfter=n,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map(e=>fK.create(sg.serialize(e)))),this.publicKey=new fH(t.subjectPublicKeyInfo)}getExtension(e){for(let t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter(t=>"string"==typeof e?t.type===e:t instanceof e)}async verify(e={},t=fp.get()){let r,i,n=e.publicKey;try{if(n)if("publicKey"in n)r={...n.publicKey.algorithm,...this.signatureAlgorithm},i=await n.publicKey.export(r,["verify"],t);else if(n instanceof fH)r={...n.algorithm,...this.signatureAlgorithm},i=await n.export(r,["verify"],t);else if(nx.BufferSourceConverter.isBufferSource(n)){let e=new fH(n);r={...e.algorithm,...this.signatureAlgorithm},i=await e.export(r,["verify"],t)}else r={...n.algorithm,...this.signatureAlgorithm},i=n;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(r,["verify"],t)}catch(e){return!1}let o=cQ.resolveAll(f2).reverse(),s=null;for(let e of o)if(s=e.toWebSignature(r,this.signature))break;if(!s)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");let a=await t.subtle.verify(this.signatureAlgorithm,i,s,this.tbs);if(e.signatureOnly)return a;{let t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=fp.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=fp.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){let e=this.toTextObjectEmpty(),t=sg.parse(this.rawData,aL),r=t.tbsCertificate,i=new fa("",{Version:`${rU[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":fc.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new fa("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(i["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(i["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){let e=new fa("");for(let t of this.extensions){let r=t.toTextObject();e[r[fa.NAME]]=r}i.Extensions=e}return e.Data=i,e.Signature=new fa("",{Algorithm:fc.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}ht.NAME="Certificate";class hr extends Array{constructor(e){if(super(),f_.isAsnEncoded(e))this.import(e);else if(e instanceof ht)this.push(e);else if(Array.isArray(e))for(const t of e)this.push(t)}export(e){let t=new lz;t.version=1,t.encapContentInfo.eContentType="1.2.840.113549.1.7.1",t.encapContentInfo.eContent=new lg({single:new oq}),t.certificates=new ld(this.map(e=>new lp({certificate:sg.parse(e.rawData,aL)})));let r=new ly({contentType:l$,content:sg.serialize(t)}),i=sg.serialize(r);return"raw"===e?i:this.toString(e)}import(e){let t=f_.toArrayBuffer(e),r=sg.parse(t,ly);if(r.contentType!==l$)throw TypeError("Cannot parse CMS package. Incoming data is not a SignedData object.");let i=sg.parse(r.content,lz);for(let e of(this.clear(),i.certificates||[]))e.certificate&&this.push(new ht(e.certificate))}clear(){for(;this.pop(););}toString(e="pem"){let t=this.export("raw");switch(e){case"pem":return fL.encode(t,"CMS");case"pem-chain":return this.map(e=>e.toString("pem")).join("\n");case"asn":return sg.toString(t);case"hex":return nx.Convert.ToHex(t);case"base64":return nx.Convert.ToBase64(t);case"base64url":return nx.Convert.ToBase64Url(t);case"text":return fc.serialize(this.toTextObject());default:throw TypeError("Argument 'format' is unsupported value")}}toTextObject(){let e=sg.parse(this.export("raw"),ly),t=sg.parse(e.content,lz);return new fa("X509Certificates",{"Content Type":fl.toString(e.contentType),Content:new fa("",{Version:`${rj[t.version]} (${t.version})`,Certificates:new fa("",{Certificate:this.map(e=>e.toTextObject())})})})}}class hi{constructor(e={}){this.certificates=[],e.certificates&&(this.certificates=e.certificates)}async build(e,t=fp.get()){let r=new hr(e),i=e;for(;i=await this.findIssuer(i,t);){let e=await i.getThumbprint(t);for(let i of r){let r=await i.getThumbprint(t);if((0,nx.isEqual)(e,r))throw Error("Cannot build a certificate chain. Circular dependency.")}r.push(i)}return r}async findIssuer(e,t=fp.get()){if(!await e.isSelfSigned(t)){let r=e.getExtension(sV);for(let i of this.certificates)if(i.subject===e.issuer){if(r){if(r.keyId){let e=i.getExtension(aB);if(e&&e.keyId!==r.keyId)continue}else if(r.certId){let e=i.getExtension(aw);if(e&&!(r.certId.serialNumber===i.serialNumber&&(0,nx.isEqual)(sg.serialize(r.certId.name),sg.serialize(e))))continue}}try{let r={...i.publicKey.algorithm,...e.signatureAlgorithm},n=await i.publicKey.export(r,["verify"],t);if(!await e.verify({publicKey:n,signatureOnly:!0},t))continue}catch(e){continue}return i}}return null}}(ro=ie||(ie={}))[ro.unspecified=0]="unspecified",ro[ro.keyCompromise=1]="keyCompromise",ro[ro.cACompromise=2]="cACompromise",ro[ro.affiliationChanged=3]="affiliationChanged",ro[ro.superseded=4]="superseded",ro[ro.cessationOfOperation=5]="cessationOfOperation",ro[ro.certificateHold=6]="certificateHold",ro[ro.removeFromCRL=8]="removeFromCRL",ro[ro.privilegeWithdrawn=9]="privilegeWithdrawn",ro[ro.aACompromise=10]="aACompromise",fK.register(sF,fM),fK.register(at,f$),fK.register(ah,fF),fK.register(aB,fz),fK.register(sV,fV),fK.register(aw,fq),fK.register(s8,fG),fK.register(sL,fZ),f1.register(ul,fX),f1.register(uc,f0),cQ.registerSingleton(f2,class{toAsnSignature(e,t){return nx.BufferSourceConverter.toArrayBuffer(t)}toWebSignature(e,t){return nx.BufferSourceConverter.toArrayBuffer(t)}}),cQ.registerSingleton(f2,f6),f6.namedCurveSize.set("P-256",32),f6.namedCurveSize.set("K-256",32),f6.namedCurveSize.set("P-384",48),f6.namedCurveSize.set("P-521",66);let hn=async()=>{let e;if("undefined"!=typeof globalThis&&globalThis.crypto?.subtle)return e=globalThis.crypto,fp.set(e),e;throw Error("Web Crypto API is not available in this environment. You may need to polyfill it.")};async function ho(e){let t=await hn();return id(new Uint8Array(await t.subtle.digest("SHA-256",e))).toUpperCase()}async function hs(e){return(await hn()).subtle.importKey("spki",e,{name:"ECDSA",namedCurve:"P-384"},!1,["verify"])}async function ha(e,t){hl(e);let r=Uint8Array.from(atob(t.awsAttestationDocB64).split("").map(e=>e.charCodeAt(0))),i=nS.decode(r.buffer),[,,n]=i,o=nS.decode(new Uint8Array(n).buffer);await hu(i,o.certificate);let s=parseInt(JSON.parse(e.proofPayload).timestampMs);await hc(o.cabundle,iN,o.certificate,s);let a=F(Uint8Array.from(atob(t.qosManifestB64).split("").map(e=>e.charCodeAt(0))));if(!function(e,t){let r=new Uint8Array(e),i=new Uint8Array(t);if(r.length!==i.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}(a,o.user_data))throw Error(`attestationDoc's user_data doesn't match the hash of the manifest. attestationDoc.user_data: ${o.user_data} , manifest digest: ${a}`);let l=id(new Uint8Array(o.public_key));if(e.publicKey!==l||l!==t.ephemeralPublicKeyHex)throw Error(`Ephemeral pub keys from app proof: ${e.publicKey}, boot proof structure ${t.ephemeralPublicKeyHex}, and attestation doc ${l} should all match`)}function hl(e){let t,r;if("SIGNATURE_SCHEME_EPHEMERAL_KEY_P256"!==e.scheme)throw Error("Unsupported signature scheme");try{t=iy(e.publicKey)}catch{throw Error("Failed to decode public key")}if(130!==t.length)throw Error(`Expected 130 bytes (encryption + signing pub keys), got ${t.length} bytes`);let i=t.slice(65);if(65!==i.length||4!==i[0])throw Error("Invalid signing key format: expected 65-byte uncompressed P-256 point (0x04||X||Y)");try{tn.ProjectivePoint.fromHex(i)}catch(e){throw Error(`Invalid P-256 public key: ${e}`)}try{r=iy(e.signature)}catch{throw Error("Failed to decode signature")}if(64!==r.length)throw Error(`Expected 64 bytes signature (r||s), got ${r.length} bytes`);let n=F(new TextEncoder().encode(e.proofPayload));if(!tn.verify(r,n,i))throw Error("Signature verification failed")}async function hc(e,t,r,i){try{let n=new ht(t),o=new Uint8Array(n.rawData),s=await ho(o);if(s!==iT)throw Error(`Pinned AWS root fingerprint mismatch: expected=${iT} actual=${s}`);let a=e.slice(1).map(e=>{if(!e)throw Error("Invalid certificate data in cabundle");return new ht(e)}),l=new ht(r),c=new hi({certificates:[n,...a]}),u=await c.build(l);if(u.length!==a.length+2)throw Error(`Incorrect number of certs in X509 Chain. Expected ${a.length+2}, got ${u.length}`);let f=new Date(i);for(let e=0;e<u.length;e++){let t=u[e];if(!t)throw Error("Invalid certificate in chain");if(e===u.length-1){if(!await t.verify({publicKey:t.publicKey,date:f}))throw Error("Pinned root failed self-signature verification")}else{let r=u[e+1];if(!r)throw Error("Issuer can't be null");if(!await t.verify({publicKey:r.publicKey,signatureOnly:!0,date:f}))throw Error(`Signature check failed: ${t.subject} not signed by ${r?.subject}`)}}}catch(e){throw Error(`Certificate chain verification failed: ${e instanceof Error?e.message:String(e)}`)}}async function hu(e,t){let[r,,i,n]=e,o=new Uint8Array(nS.encode(["Signature1",new Uint8Array(r),new Uint8Array(0),new Uint8Array(i)])),s=new ht(t),a=await hs(s.publicKey.rawData),l=await hn();if(!await l.subtle.verify({name:"ECDSA",hash:{name:"SHA-384"}},a,new Uint8Array(n),o))throw Error("COSE_Sign1 ES384 verification failed")}e.s(["getCryptoInstance",()=>hn,"verify",()=>ha,"verifyAppProofSignature",()=>hl,"verifyCertificateChain",()=>hc,"verifyCoseSign1Sig",()=>hu],64043),e.s([],284795)}]);

//# debugId=e5ea1398-f7fb-3bdc-0663-8d4eaf0f8d8f
//# sourceMappingURL=616c1a4408affb6b.js.map